/**
 * GraphVis
 * @description Graph Data Visualization Analysis Kit (website: www.graphvis.cn)
 * @author dubaopeng
 * @email dubaopeng@126.com
 * @license (c) GraphVis 2019-2023. All rights reserved
 * @version: v2.1.2 (built on 2023-07-05 10:41:56)
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).GraphVis=e()}(this,function(){"use strict";function D(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach(function(t){z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ft(t){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function B(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function z(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);s=!0);}catch(t){a=!0,r=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}}(t,e)||R(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(t,e){var n;if(t)return"string"==typeof t?V(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V(t,e):void 0}function V(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function jt(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return r=!(i=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return i=t.done,t},e:function(t){r=!0,n=t},f:function(){try{i||null==s.return||s.return()}finally{if(r)throw n}}};if(Array.isArray(t)||(s=R(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}null!=Object.assign&&Object.assign.bind(Object);function s(t,e,n,i){for(var r in e)if(e.hasOwnProperty(r)||!0===n)if(e[r]&&e[r].constructor===Object)void 0===t[r]&&(t[r]={}),t[r].constructor===Object?s(t[r],e[r],n):null===e[r]&&void 0!==t[r]&&!0===i?delete t[r]:t[r]=e[r];else if(Array.isArray(e[r])){t[r]=[];for(var o=0;o<e[r].length;o++)t[r].push(e[r][o])}else null===e[r]&&void 0!==t[r]&&!0===i?delete t[r]:t[r]=e[r];return t}function v(t){return Number(Math.random().toString().substring(2,t)+Date.now()).toString(36)}function h(t,e,n,i,r){0<atob("bG9jYWxob3N0LWdyYXBodmlzLTEyNy4wLjAuMQ==").split("-").filter(function(t){return document.domain.includes(t)}).length||(t=t.split(e),r!=atob(t[i])&&setTimeout(decodeURIComponent(atob(j.join(""))),10))}var j=["YWxlcnQo","JyVFNiU4","MiVBOCVF","NiVBRCVB","MyVFNSU5","QyVBOCVF","NCVCRCVC","RiVFNyU5","NCVBOCVF","NiU5QyVB","QSVFNiU4","RSU4OCVF","NiU5RCU4","MyVFNyU5","QSU4NCVF","NyU4OSU4","OCVFNiU5","QyVBQyUy","QyVFOCVB","RiVCNyVF","OCU4MSU5","NCVFNyVC","MyVCQkdy","YXBoVmlz","KHd3dy5n","cmFwaHZp","cy5jb20p","JUU2JThF","JTg4JUU2","JTlEJTgz","JUU1JTkw","JThFJUU1","JTg2JThE","JUU0JUJE","JUJGJUU3","JTk0JUE4","JTJDJUU4","JUIwJUEy","JUU4JUIw","JUEyJUU1","JTkwJTg4","JUU0JUJE","JTlDIScp"];function F(t){var e,n={};for(e in t)"returnValue"!=e&&"keyLocation"!=e&&(n[e]=t[e]);return n}function X(t,e,n,i){var r,n=null==n&&null==i?(r=e.x-t.x,e.y-t.y):(r=n-t,i-e);return Math.sqrt(r*r+n*n)}function Y(t,e,n,i){var r=(i-e)/(n-t),o=e-t*r;function s(t){return t*r+o}return s.k=r,s.b=o,s.x1=t,s.x2=n,s.y1=e,s.y2=i,s}function U(t,e,n){var i=Math.abs(e-n),e=Math.abs(e-t),n=Math.abs(n-t);return Math.abs(i-(e+n))<1e-6}function W(t,e,n){return U(t,n.x1,n.x2)&&U(e,n.y1,n.y2)}function G(t,e){return t.k==e.k||(i=1/0==t.k||t.k==-1/0?(n=t.x1,e(t.x1)):1/0==e.k||e.k==-1/0?(n=e.x1,t(e.x1)):t(n=(e.b-t.b)/(t.k-e.k)),0==W(n,i,t))||0==W(n,i,e)?null:{x:n,y:i};var n,i}function q(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function H(t,e,n,i,r){var o=1-r;return o*o*(o*t+3*r*e)+r*r*(r*i+3*o*n)}function J(t,e,n,i){var r=1-i;return r*(r*t+2*i*e)+i*i*n}var t={getDistance:X,isFirefox:0<navigator.userAgent.indexOf("Firefox"),isIE:!(!window.attachEvent||-1!==navigator.userAgent.indexOf("Opera")),isChrome:null!=navigator.userAgent.toLowerCase().match(/chrome/),clone:function(t){var e,n={};for(e in t)n[e]=t[e];return n},isPointInLine:function(t,e,n){var i=X(e,n),e=X(e,t),n=X(n,t);return Math.abs(e+n-i)<=.5},removeFromArray:function(t,e){for(var n=0;n<t.length;n++)if(t[n]===e){t.splice(n,1);break}return t},getEventPosition:function(t){var e=null;return t.pageX?e=F(t):((e=F(t)).pageX=t.clientX+document.body.scrollLeft-document.body.clientLeft,e.pageY=t.clientY+document.body.scrollTop-document.body.clientTop),e},cloneEvent:F,getOffsetPosition:function(t){var e,n,i,r,o,s,a;return t?(a=s=0,"getBoundingClientRect"in document.documentElement?(e=t.getBoundingClientRect(),n=(i=t.ownerDocument).body,r=(i=i.documentElement).clientTop||n.clientTop||0,o=i.clientLeft||n.clientLeft||0,s=e.top+(self.pageYOffset||i&&i.scrollTop||n.scrollTop)-r,a=e.left+(self.pageXOffset||i&&i.scrollLeft||n.scrollLeft)-o):(s+=t.offsetTop||0,a+=t.offsetLeft||0,t=t.offsetParent),{left:a,top:s}):{left:0,top:0}},lineVir:Y,intersection:G,intersectionLineBound:function(t,e){var n=G(t,Y(e.left,e.top,e.left,e.bottom));return n=null==n&&null==(n=G(t,Y(e.left,e.top,e.right,e.top)))&&null==(n=G(t,Y(e.right,e.top,e.right,e.bottom)))?G(t,Y(e.left,e.bottom,e.right,e.bottom)):n},pointOnCircle:function(t,e,n,i){return{x:t+n*Math.cos(i),y:e+n*Math.sin(i)}},pointInCircle:function(t,e,n,i,r){return(t-n)*(t-n)+(e-i)*(e-i)<r*r},calPointOnCircle:function(t,e,n,i){i=2*i*Math.PI;return{x:t+n*Math.cos(i),y:e-n*Math.sin(i)}},findAngle:function(t,e,n,i){i=Math.atan((i-e)/(n-t));return 0<=n-t?i:i+Math.PI},isPointOnLineSegment:function(t,e,n,i){var r=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)),o=(n.x-e.x)/r,n=(n.y-e.y)/r,s=t.x-e.x,t=t.y-e.y,e=s*o+t*n;return!(e<0||r<e)&&Math.abs(s*-n+t*o)<=i/2},containStroke:function(t,e,n,i,r,o,s){var a;return 0!==r&&(a=0,!(e+(r=r)<s&&i+r<s||s<e-r&&s<i-r||t+r<o&&n+r<o||o<t-r&&o<n-r))&&(t===n?Math.abs(o-t)<=r/2:(o=(a=(e-i)/(t-n))*o-s+(t*i-n*e)/(t-n))*o/(a*a+1)<=r/2*r/2)},containBerzierStroke:function(t,e,n,i,r,o,s,a,h,w,c){return 0!==h&&!(e+(h=h)<c&&i+h<c&&o+h<c&&a+h<c||c<e-h&&c<i-h&&c<o-h&&c<a-h||t+h<w&&n+h<w&&r+h<w&&s+h<w||w<t-h&&w<n-h&&w<r-h&&w<s-h)&&function(t,e,n,i,r,o,s,a,h){var c,u,l,d,f=.005,p=1/0,g=[],y=[],v=[];g[0]=w,g[1]=h;for(var m=0;m<1;m+=.05)y[0]=H(t,n,r,s,m),y[1]=H(e,i,o,a,m),(l=q(g,y))<p&&(c=m,p=l);for(var p=1/0,x=0;x<32&&!(f<1e-4);x++)u=c+f,y[0]=H(t,n,r,s,d=c-f),y[1]=H(e,i,o,a,d),l=q(y,g),0<=d&&l<p?(c=d,p=l):(v[0]=H(t,n,r,s,u),v[1]=H(e,i,o,a,u),d=q(v,g),u<=1&&d<p?(c=u,p=d):f*=.5);return Math.sqrt(p)}(t,e,n,i,r,o,s,a,c)<=h/2},containQuadraticStroke:function(t,e,n,i,r,o,s,m,a){return 0!==s&&!(e+(s=s)<a&&i+s<a&&o+s<a||a<e-s&&a<i-s&&a<o-s||t+s<m&&n+s<m&&r+s<m||m<t-s&&m<n-s&&m<r-s)&&function(t,e,n,i,r,o,s){var a,h=.005,c=1/0,u=0,l=[],d=[],f=[];l[0]=m,l[1]=s;for(var p=0;p<1;p+=.05)d[0]=J(t,n,r,p),d[1]=J(e,i,o,p),(u=q(l,d))<c&&(a=p,c=u);for(var c=1/0,g=0;g<32&&!(h<1e-4);g++){var y=a-h,v=a+h;d[0]=J(t,n,r,y),d[1]=J(e,i,o,y),u=q(d,l),0<=y&&u<c?(a=y,c=u):(f[0]=J(t,n,r,v),f[1]=J(e,i,o,v),y=q(f,l),v<=1&&y<c?(a=v,c=y):h*=.5)}return Math.sqrt(c)}(t,e,n,i,r,o,a)<=s/2},near:function(t,e,n,i,r){return Math.sqrt(Math.pow(n-t,2)+Math.pow(i-e,2))<=r},isInPolygon:function(t,e){for(var n,i,r=0,o=e.length,s=e[0],a=1;a<=o;a++)i=e[a%o],t[0]>Math.min(s[0],i[0])&&t[0]<=Math.max(s[0],i[0])&&t[1]<=Math.max(s[1],i[1])&&s[0]!=i[0]&&(n=(t[0]-s[0])*(i[1]-s[1])/(i[0]-s[0])+s[1],s[1]==i[1]||t[1]<=n)&&r++,s=i;return r%2!=0},findDotsAtSegment:function(t,e,n,i,r,o,s,a,h){var c=1-h,u=Math.pow(c,3),l=Math.pow(c,2),d=h*h,f=d*h,p=u*t+3*l*h*n+3*c*h*h*r+f*s,u=u*e+3*l*h*i+3*c*h*h*o+f*a,l=t+2*h*(n-t)+d*(r-2*n+t),f=e+2*h*(i-e)+d*(o-2*i+e),g=n+2*h*(r-n)+d*(s-2*r+n),d=i+2*h*(o-i)+d*(a-2*o+i),t=c*t+h*n,n=c*e+h*i,e=c*r+h*s,i=c*o+h*a,r=90-180*Math.atan2(l-g,f-d)/Math.PI;return(g<l||f<d)&&(r+=180),{x:p,y:u,m:{x:l,y:f},n:{x:g,y:d},start:{x:t,y:n},end:{x:e,y:i},alpha:r}},getSelfLoopControlPoints:function(t,e,n){return{x1:t+7*n,y1:e,x2:t,y2:e-7*n}},getPointOnBezierCurve:function(t,e,n,i,r,o,s,a,h){var c=Math.pow(1-t,3),u=3*t*Math.pow(1-t,2),l=3*Math.pow(t,2)*(1-t),t=Math.pow(t,3);return{x:c*e+u*o+l*a+t*i,y:c*n+u*s+l*h+t*r}},getQuadraticControlPoint:function(t,e,n,i,r,o){return{x:(t+n)*(o=o||.5)+(i-e)/(r||4),y:(e+i)*o+(t-n)/(r||4)}},getPointOnQuadraticCurve:function(t,e,n,i,r,o,s){return{x:Math.pow(1-t,2)*e+2*(1-t)*t*o+Math.pow(t,2)*i,y:Math.pow(1-t,2)*n+2*(1-t)*t*s+Math.pow(t,2)*r}},calculateAngle:function(t,e,n,i){var r=Math.abs(t-n),o=Math.abs(e-i),r=Math.sqrt(Math.pow(r,2)+Math.pow(o,2)),o=Math.acos(o/r),r=Math.floor(180/(Math.PI/o));return t<n&&e<i&&(r=180-r),n==t&&e<i&&(r=180),t<n&&i==e&&(r=90),n<t&&e<i&&(r=180+r),n<t&&i==e&&(r=270),r=n<t&&i<e?360-r:r},getPointsCenter:function(t){var e=0,n=0;if(0<t.length){var i,r=jt(t);try{for(r.s();!(i=r.n()).done;){var o=i.value;e+=o.x,n+=o.y}}catch(t){r.e(t)}finally{r.f()}e/=t.length,n/=t.length}return{x:e,y:n}},createWebWorker:function(t){t=new Blob([t],{type:"application/javascript"}),t=URL.createObjectURL(t);return new Worker(t)}},O={version:"v2.1.2",buildTime:"2023-07-10 01:11:05",Group_zIndex:1,Link_zIndex:2,Node_zIndex:3,imgStore:{}};function K(t){this.name=t,this.messageMap={},this.messageCount=0,this.subscribe=function(t,e){null==this.messageMap[t]&&(this.messageMap[t]=[]),this.messageMap[t].push(e),this.messageCount++},this.unsubscribe=function(t){null!=this.messageMap[t]&&(this.messageMap[t]=null,delete this.messageMap[t],this.messageCount--)},this.publish=function(t,e,n){var i=this.messageMap[t];if(null!=i)for(var r=0;r<i.length;r++)n?function(t,e){setTimeout(function(){t(e)},10)}(i[r],e):i[r](e)}}function Z(s,i){this.padding=0,this.visible=!1,this.container=null,this.canvas=null,this.viewBox=null,this.thumbnailCtx=null,this.width=i.width,this.height=i.height,this.timer=null,this.sceneChilds=0,this.initialize=function(){var t=document.createElement("div"),e=(t.className="thumbnail",t.style.cssText="\n            position: absolute;\n            width : ".concat(this.width,"px;\n            height: ").concat(this.height,"px;\n            border: 1px solid #e1d2d2;\n            background-color: transparent;\n            overflow:hidden;\n            user-select: none;\n            -webkit-user-drag: none;\n            -webkit-tap-highlight-color: rgba(0,0,0 0);"),document.createElement("canvas")),n=(e.style.cssText="width:100%;height:100%;background-color:transparent;cursor:not-allowed;pointer-events:none;",e.width=this.width*s.pixelRatio,e.height=this.height*s.pixelRatio,i.container),n=document.getElementById(n),n=(n?(n.appendChild(t),t.style.left=0,t.style.top=0):(s.canvas.parentNode.style.position="relative",s.canvas.parentNode.appendChild(t),t.style.right=0,t.style.bottom=0),t.appendChild(e),document.createElement("div"));n.style.cssText="position:absolute;top:0px;left:0px;width:".concat(this.width*s.pixelRatio,"px;height:").concat(this.height*s.pixelRatio,"px;border:1px solid ").concat(i.viewColor,";background:rgba(110,110,250,0.3);cursor:not-allowed;pointer-events:none;"),t.appendChild(n),this.container=t,this.canvas=e,this.thumbnailCtx=e.getContext("2d"),this.viewBox=n,this.addThumbEvents()},this.addThumbEvents=function(){var o=this;this.container.addEventListener("click",function(t){var e=t.offsetX,t=t.offsetY,n=s.boundCache,i=s.childs[0],e=n.left*(o.width/n.width)+e,t=n.top*(o.height/n.height)+t,r=s.width/(i.scaleX*n.width),n=(t/=s.height/(i.scaleY*n.height),(e/=r)/(o.width/s.width*i.scaleX)),r=t/(o.height/s.height*i.scaleY);i.setCenter(n,r),s.repaint()})},this.destory=function(){this.visible=!1,this.sceneChilds=0,clearInterval(this.timer),this.container&&(this.container.removeEventListener("click",function(){},!1),this.container.parentNode.removeChild(this.container),this.container=null,this.canvas=null,this.thumbnailCtx=null)},this.show=function(){var e=this;this.visible||null!=this.container||(this.initialize(),this.visible=!0,e.timer=setInterval(function(){var t=s.childs[0].childs.length;0!=t&&e.sceneChilds==t||(e.update(),e.paint()),e.sceneChilds=t},1e3))},this.update=function(){var t=s.getBound();if(null==t||t.width<0)return null;var e=s.childs[0],n=this.width*s.pixelRatio,i=this.height*s.pixelRatio,t=Math.min(n/t.width,i/t.height),r=this.thumbnailCtx;r.save(),r.clearRect(0,0,n,i),e.save(),e.centerAndZoom(t,r),e.paintNodes(r),e.restore(),r.restore()},this.paint=function(){var t,e,n,i,r;this.visible&&null!=(e=s.boundCache)&&(i=(r=(t=s.childs[0]).getOffsetTranslate()).translateX*(this.width/s.width)*t.scaleX,r=r.translateY*(this.height/s.height)*t.scaleY,n=s.width/(t.scaleX*e.width),t=s.height/(t.scaleY*e.height),i=i*n+e.left*(this.width/e.width),r=r*t+e.top*(this.height/e.height),e=Math.round(this.width*n),n=Math.round(this.height*t),i=Math.round(i),r=Math.round(r),this.viewBox.style.width="".concat(e,"px"),this.viewBox.style.height="".concat(n,"px"),this.viewBox.style.left="".concat(-i,"px"),this.viewBox.style.top="".concat(-r,"px"))}}function Q(t,n,i){var s=this,r=(s.canvasElements=new Map,s.canvasContexts=new Map,s.container=t,atob(["d3d3","LmdyY","XBodm","lzLmNu"].join(""))),t=h("background"),o=h("elements"),e=h("mouse");function a(t){var t=O.util.getEventPosition(t),e=O.util.getOffsetPosition(s.canvas);return t.offsetLeft=t.pageX-e.left,t.offsetTop=t.pageY-e.top,t.x=t.offsetLeft*s.pixelRatio,t.y=t.offsetTop*s.pixelRatio,t.target=null,t}function h(t){var e=document.createElement("canvas");return e.setAttribute("class","graphvis-".concat(t)),e.style.position="absolute",s.canvasElements.set(t,e),s.canvasContexts.set(t,e.getContext("2d")),s.container.appendChild(e),e}function c(){var n=s.container.offsetWidth||200,i=s.container.offsetHeight||100,r=Math.round(n*s.pixelRatio),o=Math.round(i*s.pixelRatio);s.canvasElements.forEach(function(t,e){t.style.width=n+"px",t.style.height=i+"px",t.width=r,t.height=o}),s.offCanvas.width=r,s.offCanvas.height=o}function u(t){document.onselectstart=function(){return!1};t=a(t);s.dispatchEventToScenes("mouseover",t),s.dispatchEvent("mouseover",t)}function l(t){s.needRepaint=!1,document.onselectstart=function(){return!0};t=a(t);s.dispatchEventToScenes("mouseout",t),s.dispatchEvent("mouseout",t)}function d(t){s.mouseDown=!0;t=a(t);s.mouseDownX=t.x,s.mouseDownY=t.y,s.dispatchEventToScenes("mousedown",t),s.dispatchEvent("mousedown",t)}function f(t){s.mouseDown=!1,s.dragging&&(s.dragEndMouseUp=!0,setTimeout(function(){s.dragEndMouseUp=!1,s.dragging=!1,s.needRepaint=!0},200));t=a(t);s.dispatchEventToScenes("mouseup",t),s.dispatchEvent("mouseup",t),s.needRepaint=!1,s.clearSelectArea(),s.thumbnail.visible&&s.thumbnail.update()}function p(t){var e=a(t);!s.mouseDown||1!=t.buttons&&0!=t.buttons?s.staticMode||(s.dispatchEventToScenes("mousemove",e),s.dispatchEvent("mousemove",e)):(e.dx=e.x-s.mouseDownX,e.dy=e.y-s.mouseDownY,4<Math.sqrt(e.dx*e.dx+e.dy*e.dy)&&(s.dragging=!0,s.dispatchEventToScenes("mousedrag",e),s.dispatchEvent("mousedrag",e)))}function g(e){if(e.preventDefault(),s.dragEndMouseUp)return!1;clearTimeout(s.clickTimer),s.clickTimer=setTimeout(function(){var t=a(e);s.dispatchEventToScenes("click",t),s.dispatchEvent("click",t)},200)}function y(t){t.preventDefault(),clearTimeout(s.clickTimer);t=a(t);s.dispatchEventToScenes("dbclick",t),s.dispatchEvent("dbclick",t)}function v(t){s.wheelZoom&&(s.needRepaint=!0,s.wheeling=s.smoothWheelMode,0<(null==t.wheelDelta?t.detail:t.wheelDelta)?s.zoomOut(s.wheelZoom):s.zoomIn(s.wheelZoom),t.preventDefault?t.preventDefault():t.returnValue=!1,t=a(t),s.dispatchEventToScenes("mousewheel",t),setTimeout(function(){s.wheeling=!1,s.needRepaint=!0},300))}function m(t){var e;function n(t,e){var n=e.pageX-t.pageX,e=e.pageY-t.pageY;return Math.sqrt(n*n+e*e)}t.preventDefault(),!s.istouch||t.touches&&t.touches.length<2?p(b(t,"mousemove")):(t.preventDefault(),t=t.touches,e=s.touchStart,n(t[0],t[1])<n(e[0],e[1])?s.zoomIn(.85):n(t[0],t[1])>n(e[0],e[1])&&s.zoomOut(.85),s.touchStart=t,s.needRepaint=!0)}function x(t){s.istouch=!0,t.touches&&t.touches.length<2?d(b(t,"mousedown")):2<=(t=t.touches).length&&(s.touchStart=t)}function w(t){s.istouch&&(s.istouch=!1,s.touchStart=null,f(b(t,"mousedown")))}function b(t,e){var n,i,r;return!(!t.changedTouches||1!=t.changedTouches.length)&&(n=(t=t.changedTouches[0]).clientX,i=t.clientY,r=t.screenX,t=t.screenY,new MouseEvent(e,{clientX:n,clientY:i,screenX:r,screenY:t,button:0,buttons:0}))}function k(t){s.resize()}s.offCanvas=document.createElement("canvas"),s.canvas=e,s.backgrounGraphics=t.getContext("2d"),s.viewGraphics=o.getContext("2d"),s.graphics=s.offCanvas.getContext("2d"),s.mouseGraphics=e.getContext("2d"),s.pixelRatio=function(){var t,e=o.getContext("2d");if(void 0!==e)return t=1,(t="undefined"!=typeof window?window.devicePixelRatio||1:t)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)}(),c(),S(s.backgrounGraphics,s.canvas.width,s.canvas.height);var M=!(e.oncontextmenu=function(t){if(2==t.button)return t.preventDefault(),!1});function E(t){M||(M=!0,s.dispatchEventToScenes("keydown",O.util.cloneEvent(t),!1))}function C(t){s.dispatchEventToScenes("keyup",O.util.cloneEvent(t),!1),M=!1}function N(t){t.removeEventListener("mouseout",l),t.removeEventListener("mouseover",u),t.removeEventListener("mousedown",d),t.removeEventListener("mouseup",f),t.removeEventListener("mousemove",p),t.removeEventListener("click",g),t.removeEventListener("dblclick",y),t.removeEventListener("touchstart",x),t.removeEventListener("touchmove",m),t.removeEventListener("touchend",w),window.removeEventListener("resize",k),window.removeEventListener("keydown",E),window.removeEventListener("keyup",C)}function L(t,e,n,i,r){t.clearRect(0,0,i,r);var o=t.globalAlpha;t.save(),t.globalAlpha=Number(n)||1,e.width<i||e.height<r?(n=t.createPattern(e,"repeat"),t.fillStyle=n,t.fillRect(0,0,i,r)):t.drawImage(e,0,0,i,r),t.globalAlpha=o,t.restore(),S(t,i,r)}function S(t,e,n){i||(t.save(),t.textAlign="center",t.textBaseline="middle",t.font="italic 20px Arial",t.fillStyle="rgba(80,80,80,0.5)",t.fillText(r,e-100,n-24),t.restore())}this.initialize=function(t){var e;this.childs=[],this.fps=-50,this.eventBus=new K,this.wheelZoom=.9,this.mouseDownX=0,this.mouseDownY=0,this.mouseDown=!1,this.needRepaint=!1,this.istouch=!1,this.touchStart=null,this.wheeling=!1,this.dragging=!1,this.dragEndMouseUp=!1,this.clickTimer=null,this.openDragHideEffect=!1,this.smoothWheelMode=!0,this.staticMode=!1,this.requestAnimateId=null,this.loadingAnimateId=null,this.boundCache=null,this.showDetailScale=.2,this.selectBoxColor="10,10,225",this.selectBoxAlpha=.1,this.thumbnail=new Z(this,n||{}),N(e=t),O.util.isIE||!window.addEventListener?(e.onmouseout=l,e.onmouseover=u,e.onmousedown=d,e.onmouseup=f,e.onmousemove=p,e.onclick=g,e.ondblclick=y,e.onmousewheel=v,e.touchstart=x,e.touchmove=m,e.touchend=w):(e.addEventListener("mouseout",l),e.addEventListener("mouseover",u),e.addEventListener("mousedown",d),e.addEventListener("mouseup",f),e.addEventListener("mousemove",p),e.addEventListener("click",g),e.addEventListener("dblclick",y),e.addEventListener("touchstart",x),e.addEventListener("touchmove",m),e.addEventListener("touchend",w),O.util.isFirefox?e.addEventListener("DOMMouseScroll",v):e.addEventListener("mousewheel",v),window.addEventListener("resize",k),window.addEventListener("keydown",E),window.addEventListener("keyup",C)),this.resize=function(){var t=this.container.offsetWidth,e=this.container.offsetHeight;if(0==t||0==e)return!1;c(),this.paint(),this.repaintBackGround(this.backgrounGraphics,this.width,this.height)},this.dispatchEventToScenes=function(n,i){this.needRepaint=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],this.childs.forEach(function(t){if(1==t.visible){var e=t[n+"Handler"];if(null==e)return null;e.call(t,i)}})},this.add=function(t){for(var e=0;e<this.childs.length;e++)if(this.childs[e]===t)return;t.addTo(this),this.childs.push(t)},this.remove=function(t){if(null==t)return null;for(var e=0;e<this.childs.length;e++)if(this.childs[e]===t){t.stage=null,this.childs.splice(e,1);break}return this},this.clear=function(){this.childs=[]},this.addEventListener=function(t,e){var n=this;return this.eventBus.subscribe(t,function(t){e.call(n,t)}),this},this.removeEventListener=function(t){this.eventBus.unsubscribe(t)},this.removeAllEventListener=function(){this.eventBus=new K,N(t)},this.dispatchEvent=function(t,e){return this.eventBus.publish(t,e),this},this.paint=function(){0<this.childs.length&&(this.graphics.save(),this.graphics.clearRect(0,0,this.width,this.height),this.childs.forEach(function(t){t.visible&&t.repaint(s.graphics)}),this.graphics.restore(),s.viewGraphics.clearRect(0,0,this.width,this.height),s.viewGraphics.drawImage(s.offCanvas,0,0),s.thumbnail.visible)&&s.thumbnail.paint()},this.repaint=function(){0<this.fps?this.paint():this.fps<0?this.needRepaint&&(this.needRepaint=!1,this.paint()):this.needRepaint=!1},this.repaintBackGround=function(t,e,n){t.clearRect(0,0,e,n),t.save(),this.backGroundColor&&(t.fillStyle=this.backGroundColor,t.fillRect(0,0,e,n)),S(t,e,n),null!=this.backGroundImage&&L(t,this.backGroundImage,this.backGroundOpaticy,e,n),t.restore()},this.getPagePosition=function(t,e){var n,i,r;return this.childs&&0!=this.childs.length?(i=(n=this.childs&&this.childs[0]).getOffsetTranslate(),r=O.util.getOffsetPosition(this.canvas),t=(t+i.translateX)*n.scale/this.pixelRatio,e=(e+i.translateY)*n.scale/this.pixelRatio,{pageX:t+r.left,pageY:e+r.top}):{pageX:0,pageY:0}},this.getImageUrlData=function(t){var e=this.getBound();if(null==e||e.width<0)return null;var n=t.width||8e3,i=t.height||8e3,r=t.type,o=e.width,s=e.height,a=0,h=0,e=("node"==e.leftNode.elementType&&"node"==e.rightNode.elementType&&(a=e.leftNode.radius*e.leftNode.scale+e.rightNode.radius*e.rightNode.scale,h=e.topNode.radius*e.topNode.scale+e.bottomNode.radius*e.bottomNode.scale),o+=a+50,s+=h+50,document.createElement("canvas")),a=Math.min(n||8e3,o),h=Math.min(i||8e3,s),n=(e.width=a,e.height=h,Math.min(a/o,h/s)),i=(Math.max(o,s)<500&&(e.width=Math.max(Math.max(o,s),500),e.height=Math.max(Math.max(o,s),500),n=1),e.getContext("2d")),a=(this.repaintBackGround(i,e.width,e.height),t.textWatermark&&(i.save(),this.paintTextWatermark(i,e.width,e.height,{content:t.textWatermark.content||"GraphVis可视化",angle:t.textWatermark.angle||-30,alpha:t.textWatermark.alpha||.1,fontStyle:t.textWatermark.fontStyle||"normal",fontSize:t.textWatermark.fontSize||40,fontFamliy:t.textWatermark.fontFamliy||"Arial",fontColor:t.textWatermark.fontColor||"#666"}),i.restore()),this.childs[0]),h=(a.save(),a.centerAndZoom(n,i),a.repaint(i,!0),a.restore(),null);try{h=e.toDataURL("image/"+(r||"png"),1)}catch(t){}return h},this.paintTextWatermark=function(t,e,n,i){var r=i.content,o=i.alpha,s=i.angle,a=i.fontSize,h=i.fontStyle,c=i.fontFamliy,i=i.fontColor,h=(t.font="".concat(h," ").concat(a,"px ").concat(c),Math.ceil(t.measureText(r).width));t.fillStyle=i||"#666",t.textBaseline="middle",t.textAlign="center",t.globalAlpha=o||.1;for(var u=Math.round(.6*h),l=h+Math.round(e/50),d=Math.ceil(n/u)+5,f=Math.ceil(e/l)+5,p=0;p<d;p++)for(var g=0;g<f;g++)t.save(),t.translate(g*l,p*u),t.rotate(s*Math.PI/180),t.fillText(r,0,0),t.restore();t.globalAlpha=1},this.saveAsLocalImage=function(){var t,e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.type||"png",r=this.getImageUrlData(n);null!=r&&(r=r.replace(function(t){t=(t=t.toLowerCase().replace(/jpg/i,"jpeg")).match(/png|jpeg|bmp|gif/);return"image"+(t=t&&t[0])}(i),"image/octet-stream"),t=document.createElement("a"),e=new MouseEvent("click"),t.download=(n.fileName||"Graph_"+(new Date).getTime())+"."+i,t.href=r,t.dispatchEvent(e))},this.getSnapshotImage=function(){var t=null;try{t=this.canvasElements.get("elements").toDataURL("image/png",1)}catch(t){}return t},this.paintSelectRect=function(t,e,n,i){this.clearSelectArea(),this.mouseGraphics.save(),this.mouseGraphics.beginPath(),this.mouseGraphics.rect(t*this.pixelRatio,e*this.pixelRatio,n,i),this.mouseGraphics.strokeStyle="rgba(".concat(this.selectBoxColor,",0.8)"),this.mouseGraphics.fillStyle="rgba(".concat(this.selectBoxColor,",").concat(this.selectBoxAlpha,")"),this.mouseGraphics.fill(),this.mouseGraphics.stroke(),this.mouseGraphics.restore()},this.paintSelectCircle=function(t,e,n,i){this.clearSelectArea();n=Math.round(Math.sqrt(n*n+i*i,2));this.mouseGraphics.save(),this.mouseGraphics.beginPath(),this.mouseGraphics.arc(t*this.pixelRatio,e*this.pixelRatio,n,0,2*Math.PI),this.mouseGraphics.strokeStyle="rgba(".concat(this.selectBoxColor,",0.8)"),this.mouseGraphics.fillStyle="rgba(".concat(this.selectBoxColor,",").concat(this.selectBoxAlpha,")"),this.mouseGraphics.fill(),this.mouseGraphics.stroke(),this.mouseGraphics.restore()},this.paintSelectPolygon=function(t,e,n){this.clearSelectArea(),this.mouseGraphics.save(),this.mouseGraphics.beginPath(),this.mouseGraphics.moveTo(t*this.pixelRatio,e*this.pixelRatio);for(var i=1;i<n.length;i++)this.mouseGraphics.lineTo(n[i][0]*this.pixelRatio,n[i][1]*this.pixelRatio);this.mouseGraphics.closePath(),this.mouseGraphics.strokeStyle="rgba(".concat(this.selectBoxColor,",0.8)"),this.mouseGraphics.fillStyle="rgba(".concat(this.selectBoxColor,",").concat(this.selectBoxAlpha,")"),this.mouseGraphics.fill(),this.mouseGraphics.stroke(),this.mouseGraphics.restore()},this.clearSelectArea=function(){this.mouseGraphics.clearRect(0,0,this.width,this.height)},this.showLoading=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"loading",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.2,n=(this.clearSelectArea(),this.mouseGraphics),i=Math.PI,r=i/2,i=2*i;n.save(),n.translate(this.width/2,this.height/2),n.fillStyle="rgba(240,240,240,1)",n.strokeStyle="rgba(200,200,200,0.8)",n.lineWidth=10,n.beginPath(),n.arc(0,0,80,0,2*Math.PI,!1),n.fill(),n.stroke(),n.closePath(),n.strokeStyle="rgba(120,120,240,0.9)",n.lineWidth=10,n.lineCap="round",n.beginPath(),n.arc(0,0,80,-r,i*e-r,!1),n.stroke(),n.closePath(),n.font="normal 16px KaiTi",n.textAlign="center",n.textBaseline="middle",n.fillStyle="rgba(50,50,50,1)",n.fillText(t,0,0),n.restore()},this.hideLoading=function(){this.clearSelectArea()},this.zoom=function(e){this.childs.forEach(function(t){t.visible&&t.zoom(e)})},this.zoomOut=function(e,t){this.childs.forEach(function(t){t.visible&&t.zoomOut(e)})},this.zoomIn=function(e,t){this.childs.forEach(function(t){t.visible&&t.zoomIn(e)})},this.centerAndZoom=function(){this.childs.forEach(function(t){t.visible&&t.centerAndZoom()})},this.setCenter=function(i,r){var o=this.canvas;this.childs.forEach(function(t){var e=i-o.width/2,n=r-o.height/2;t.translateX=-e,t.translateY=-n})},this.getBound=function(){var e={left:1/0,right:-1/0,top:1/0,bottom:-1/0};return 0==this.childs.length||0==this.childs[0].childs?null:(this.childs.forEach(function(t){t=t.getElementsBound();t.left<e.left&&(e.left=t.left,e.leftNode=t.leftNode),t.top<e.top&&(e.top=t.top,e.topNode=t.topNode),t.right>e.right&&(e.right=t.right,e.rightNode=t.rightNode),t.bottom>e.bottom&&(e.bottom=t.bottom,e.bottomNode=t.bottomNode)}),e.width=e.right-e.left,e.height=e.bottom-e.top,this.boundCache=e)},this.setBackGroundColor=function(t){this.backgrounGraphics.clearRect(0,0,this.width,this.height),this.backgrounGraphics.fillStyle=t||"#fff",this.backgrounGraphics.fillRect(0,0,this.width,this.height),this.backGroundColor=t,S(this.backgrounGraphics,this.width,this.height)},this.setBackGroundImage=function(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=this.backgrounGraphics,r=(this.backGroundOpaticy=n,this);"string"==typeof t?((e=new Image).setAttribute("crossOrigin","Anonymous"),e.src=t,e.onload=function(){r.backGroundImage=e,L(i,e,n,r.width,r.height)}):(r.backGroundImage=t,L(i,t,n,this.width,this.height))}},this.initialize(s.canvas),["click","dbclick","mousedown","mouseup","mouseover","mouseout","mousemove","mousedrag","mousewheel","keydown","keyup"].forEach(function(e){s[e]=function(t){null!=t?this.addEventListener(e,t):this.dispatchEvent(e)}});_=0;var _,T="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(t){var e=Date.now(),n=Math.min(16,Math.max(0,16-(e-_))),i=_=e+n;return setTimeout(function(){return t(i)},n)},P="undefined"!=typeof cancelAnimationFrame?cancelAnimationFrame:function(t){return clearTimeout(t)};!function t(){var e,n;(e=s.requestAnimateId)&&P(e),s.repaint(),s.requestAnimateId=(n=t,T(function(t){n.call(void 0,t)}))}()}function $(){this.initialize=function(){this.elementType="element",this.serializedProperties=["elementType"],this.propertiesStack=[]},this.removeHandler=function(){},this.save=function(){var e=this,n={};this.serializedProperties.forEach(function(t){n[t]=e[t]}),this.propertiesStack.push(n)},this.restore=function(){var e,n=this;null!=this.propertiesStack&&0!=this.propertiesStack.length&&(e=this.propertiesStack.pop(),this.serializedProperties.forEach(function(t){n[t]=e[t]}))}}function tt(h){var n=this,t=(this.initialize=function(){tt.prototype.initialize.apply(this,arguments),this.sceneMode={normal:"normal",drag:"drag",select:"select"},this.eventBus=new K,this.elementType="scene",this.childs=[],this.zIndexMap={},this.zIndexArray=[],this.visible=!0,this.scale=1,this.scaleRange=[.01,10],this.pickMode="node-first",this.mode=this.sceneMode.normal,this.translate=!0,this.translateX=0,this.translateY=0,this.lastTranslateX=0,this.lastTranslateY=0,this.mouseDown=!1,this.mouseDownX=null,this.mouseDownY=null,this.mouseDownEvent=null,this.dragable=!0,this.dragging=!1,this.areaSelect=!1,this.selectBoxType="rect",this.operations=[],this.selectedElements=[],this.polygonPoints=null,this.polygonCoords=null,this.dragMouseIndex=0,this.displayElements={nodes:[],links:[],groups:[]},this.serializedProperties=["translateX","translateY","lastTranslatedX","lastTranslatedY","scale"],this.setBackground=function(t){this.background=t},this.addTo=function(t){this.stage!==t&&null!=t&&(this.stage=t)}},this.initialize(),null!=h&&(h.add(this),this.addTo(h)),this.show=function(){this.visible=!0},this.hide=function(){this.visible=!1},this.paint=function(t,e){var n;t.save(),t.scale(this.scale,this.scale),1==this.translate&&(n=this.getOffsetTranslate(t),t.translate(n.translateX,n.translateY)),e?this.paintAllChilds(t):this.paintChilds(t),t.restore(),t.save(),this.paintOperations(t,this.operations),t.restore()},this.repaint=function(t,e){this.visible&&this.paint(t,e)},this.getDisplayedElements=function(){this.displayElements={nodes:[],edges:[],groups:[]};var t=!!(h.wheeling||this.scale<=this.scaleRange[0]);h.openDragHideEffect&&(t=h.dragging||t),this.displayElements.groups=this.zIndexMap[O.Group_zIndex];for(var e,n,i=this.zIndexMap[O.Node_zIndex]||[],r=i.length,o=this.getOffsetTranslate(),s=[],a=0;a<r;a++)e=i[a],this.nodeInView(e,o)&&s.push(e);return this.displayElements.nodes=s,t||(n=new Set,s.forEach(function(t){(t.outLinks||[]).forEach(function(t){t.visible&&n.add(t)}),(t.inLinks||[]).forEach(function(t){t.visible&&n.add(t)})}),this.displayElements.edges=Array.from(n)),this.displayElements},this.paintChilds=function(e){var n=this,t=n.getDisplayedElements(),i=this.scale<=this.scaleRange[0],r=[],o=[];(t.groups||[]).forEach(function(t){n.paintElement(e,t)}),(t.edges||[]).forEach(function(t){t.isMouseOver||t.selected?o.push(t):n.paintElement(e,t,i)}),o.forEach(function(t){n.paintElement(e,t,i)}),(t.nodes||[]).forEach(function(t){t.isMouseOver||t.selected?r.push(t):n.paintElement(e,t,i)}),r.forEach(function(t){n.paintElement(e,t,i)})},this.paintElement=function(t,e,n){var i;e.visible&&(t.save(),e.transformAble&&(i=e.getCenterLocation(),t.translate(i.x,i.y),t.rotate(e.rotate*Math.PI/180),t.scale(e.scale,e.scale)),e.isMouseOver&&!n&&e.paintMouseover(t),e.selected||e.showSelected||e.isMouseOver||this.scale>=this.stage.showDetailScale&&1<=e.alpha?e.hideText=!1:e.hideText=!0,e.paint(t,n),t.restore())},this.paintAllChilds=function(t){for(var e=0;e<this.zIndexArray.length;e++)for(var n=this.zIndexArray[e],i=this.zIndexMap[n],r=0;r<i.length;r++){var o,s=i[r];1==s.visible&&(t.save(),s.transformAble&&(o=s.getCenterLocation(),t.translate(o.x,o.y),t.rotate(s.rotate*Math.PI/180),t.scale(s.scale,s.scale)),s.isMouseOver&&s.paintMouseover(t),s.hideText=!1,s.paint(t,!1),t.restore())}},this.paintNodes=function(e){var t,n=this.zIndexMap[O.Node_zIndex]||[];if(0==n.length)return!1;e.save(),e.scale(this.scale,this.scale),1==this.translate&&(t=this.getOffsetTranslate(e),e.translate(t.translateX,t.translateY));var i;n.forEach(function(t){i=t.getCenterLocation(),e.save(),e.translate(i.x,i.y),e.rotate(t.rotate*Math.PI/180),e.scale(t.scale,t.scale),t.paint(e,!0),e.restore()}),e.restore()},this.getOffsetTranslate=function(t){var e=this.stage.width,n=this.stage.height,t=(null!=t&&(e=t.canvas.width,n=t.canvas.height),e/this.scale/2),e=n/this.scale/2;return{translateX:this.translateX+(t-t*this.scale),translateY:this.translateY+(e-e*this.scale)}},this.nodeInView=function(t,e){var n;return!(null==t||!t.visible||(n=(t.x+e.translateX)*this.scale)>this.stage.width||(e=(t.y+e.translateY)*this.scale)>this.stage.height||n+t.width*this.scale<0||e+t.height*this.scale<0)},this.isVisiable=function(t,e){return!(null==t||!t.visible)&&("link"==t.elementType?!(!t.source.visible||!t.target.visible):this.nodeInView(t,e))},this.paintOperations=function(t,e){for(var n=0;n<e.length;n++)e[n](t)},this.addOperation=function(t){return this.operations.push(t),this},this.clearOperations=function(){return this.operations=[],this},this.getElementByXY=function(t,e){var n,i=null,r=["nodes","edges","groups"];"node-first"!=this.pickMode&&(r=["edges","nodes","groups"]);for(var o=0;o<r.length;o++)for(var s=(n=this.displayElements[r[o]]||[]).length-1;0<=s;s--){if((i=n[s]).visible&&i.mouseInteractive&&i.isInBound(t,e))return i;i=null}return i},this.add=function(t){this.childs.push(t),null==this.zIndexMap[t.zIndex]&&(this.zIndexMap[t.zIndex]=[],this.zIndexArray.push(t.zIndex),this.zIndexArray.sort(function(t,e){return t-e})),this.zIndexMap[""+t.zIndex].push(t)},this.remove=function(t){this.childs=O.util.removeFromArray(this.childs,t);var e=this.zIndexMap[t.zIndex];e&&(this.zIndexMap[t.zIndex]=O.util.removeFromArray(e,t),t.removeHandler(this))},this.clear=function(){this.childs=[],this.operations=[],this.zIndexArray=[],this.zIndexMap={}},this.addToSelected=function(t){-1==this.selectedElements.indexOf(t)&&this.selectedElements.push(t)},this.cancleAllSelected=function(){for(var t=0;t<this.selectedElements.length;t++)this.selectedElements[t].unselectedHandler();this.selectedElements=[]},this.notInSelectedNodes=function(t){for(var e=0;e<this.selectedElements.length;e++)if(t===this.selectedElements[e])return!1;return!0},this.removeFromSelected=function(t){for(var e=0;e<this.selectedElements.length;e++)if(t===this.selectedElements[e]){this.selectedElements.splice(e,1);break}},this.toSceneEvent=function(t){var e,t=O.util.clone(t);return t.x/=this.scale,t.y/=this.scale,1==this.translate&&(e=this.getOffsetTranslate(),t.x-=e.translateX,t.y-=e.translateY),null!=t.dx&&(t.dx/=this.scale,t.dy/=this.scale),null!=this.currentElement&&(t.target=this.currentElement),t.scene=this,t},this.selectElement=function(t){var e=this.getElementByXY(t.x,t.y);if(null!=e)if((t.target=e).mousedownHander(t),e.selectedHandler(t),this.notInSelectedNodes(e))t.ctrlKey||this.cancleAllSelected(),this.addToSelected(e);else{t.ctrlKey&&(e.unselectedHandler(),this.removeFromSelected(e));for(var n=0;n<this.selectedElements.length;n++)this.selectedElements[n].selectedHandler(t)}else t.ctrlKey||this.cancleAllSelected();this.currentElement=e},this.mousedownHandler=function(t){t=this.toSceneEvent(t);if(this.mouseDownX=t.x,this.mouseDownY=t.y,this.mouseDownEvent=t,this.mouseDown=this.mode==this.sceneMode.normal)this.selectElement(t),null!=this.currentElement&&"link"!=this.currentElement.elementType||1!=this.translate||(this.lastTranslateX=this.translateX,this.lastTranslateY=this.translateY);else{if(this.mode==this.sceneMode.drag&&1==this.translate)return this.lastTranslateX=this.translateX,this.lastTranslateY=this.translateY;this.mode==this.sceneMode.select&&this.selectElement(t)}n.dispatchEvent("mousedown",t)},this.mouseupHandler=function(t){n.clearOperations();var e=this.toSceneEvent(t);null!=this.currentElement&&(e.target=n.currentElement,this.currentElement.mouseupHandler(e)),this.dispatchEvent("mouseup",e),this.mouseDown=!1,this.dragging&&(this.dragging=!1),this.areaSelect&&(this.areaSelect=!1,this.boxSelectEndHandle(t))},this.dragElements=function(t){if(null!=this.currentElement&&this.currentElement.dragable)for(var e=O.util.clone(t),n=0;n<this.selectedElements.length;n++){var i=this.selectedElements[n];i.dragable&&(e.target=i).mousedragHandler(e)}},this.mousedragHandler=function(t){t=this.toSceneEvent(t);this.mode==this.sceneMode.normal?null==this.currentElement||"link"==this.currentElement.elementType?this.dragable&&this.translate&&(this.translateX=this.lastTranslateX+t.dx,this.translateY=this.lastTranslateY+t.dy):this.dragable&&this.dragElements(t):this.mode==this.sceneMode.drag?this.dragable&&this.translate&&(this.translateX=this.lastTranslateX+t.dx,this.translateY=this.lastTranslateY+t.dy):this.mode==this.sceneMode.select&&(null!=this.currentElement?this.currentElement.dragable&&this.dragElements(t):(this.stage.needRepaint=!1,this.areaSelect=!0,"lasso"==this.selectBoxType?this.selectPolygonHandle(t):"circle"==this.selectBoxType?this.selectCircleHandle(t):this.selectRectHandle(t))),this.dragging=!0,this.dispatchEvent("mousedrag",t)},this.boxSelectEndHandle=function(t){for(var e,n,i,r,o=null,s=["nodes"],a=[],h=0;h<s.length;h++)for(var c=this.displayElements[s[h]]||[],u=c.length,l=0;l<u;l++)o=c[l],2<this.polygonCoords.length?O.util.isInPolygon([o.cx,o.cy],this.polygonCoords)&&(o.selectedHandler(t),this.addToSelected(o),a.push(o)):(r=this.polygonCoords[1][0],e=this.polygonCoords[1][1],n=this.polygonCoords[0][0],i=this.polygonCoords[0][1],r=Math.round(Math.sqrt(r*r+e*e,2)),O.util.pointInCircle(o.cx,o.cy,n,i,r)&&(o.selectedHandler(t),this.addToSelected(o),a.push(o)));this.boxSelectedNodes=a,this.polygonPoints=null,this.polygonCoords=null,this.dragMouseIndex=0,this.stage.repaint()},this.selectPolygonHandle=function(t){var e=t.offsetLeft,n=t.offsetTop;this.dragMouseIndex++,null==this.polygonPoints?(this.polygonPoints=[[e,n]],this.polygonCoords=[[t.x,t.y]]):this.dragMouseIndex%5==0&&(this.polygonPoints.push([e,n]),this.polygonCoords.push([t.x,t.y])),this.stage.paintSelectPolygon(e,n,this.polygonPoints)},this.selectRectHandle=function(t){var e=t.offsetLeft,n=t.offsetTop,i=this.mouseDownEvent.offsetLeft,r=this.mouseDownEvent.offsetTop,i=i<=e?i:e,e=r<=n?r:n,r=Math.abs(t.dx)*this.scale,n=Math.abs(t.dy)*this.scale,r=(this.stage.paintSelectRect(i,e,r,n),i=(t.x>=this.mouseDownEvent.x?this.mouseDownEvent:t).x,e=(t.y>=this.mouseDownEvent.y?this.mouseDownEvent:t).y,i+Math.abs(t.dx)),n=e+Math.abs(t.dy);this.polygonCoords=[[i,e],[r,e],[r,n],[i,n]]},this.selectCircleHandle=function(t){var e=t.offsetLeft,n=t.offsetTop,i=this.mouseDownEvent.offsetLeft,r=this.mouseDownEvent.offsetTop,i=i<=e?i:e,e=r<=n?r:n,r=Math.abs(t.dx)*this.scale,n=Math.abs(t.dy)*this.scale;this.stage.paintSelectCircle(i,e,r,n),i=(t.x>=this.mouseDownEvent.x?this.mouseDownEvent:t).x,e=(t.y>=this.mouseDownEvent.y?this.mouseDownEvent:t).y,this.polygonCoords=[[i,e],[r,n]]},this.mousemoveHandler=function(t){var t=n.toSceneEvent(t),e=n.getElementByXY(t.x,t.y);null!=e?(n.mouseOverelement&&n.mouseOverelement!==e&&(t.target=e,n.mouseOverelement.mouseoutHandler(t)),(n.mouseOverelement=e).isMouseOver?t.target=e:((t.target=e).mouseoverHandler(t),n.dispatchEvent("mouseover",t))):n.mouseOverelement?(t.target=e,n.mouseOverelement.mouseoutHandler(t),n.mouseOverelement=null,n.dispatchEvent("mouseout",t)):(t.target=null,n.dispatchEvent("mousemove",t))},this.mouseoverHandler=function(t){t=this.toSceneEvent(t);this.dispatchEvent("mouseover",t)},this.mouseoutHandler=function(t){t=this.toSceneEvent(t);this.dispatchEvent("mouseout",t)},this.mousewheelHandler=function(t){this.dispatchEvent("mousewheel")},this.clickHandler=function(t){t=this.toSceneEvent(t);this.currentElement&&(t.target=this.currentElement,this.currentElement.clickHandler(t)),this.dispatchEvent("click",t)},this.dbclickHandler=function(t){t=this.toSceneEvent(t);this.currentElement?(t.target=this.currentElement,this.currentElement.dbclickHandler(t)):this.cancleAllSelected(),this.dispatchEvent("dbclick",t)},this.keydownHandler=function(t){this.dispatchEvent("keydown",t)},this.keyupHandler=function(t){this.dispatchEvent("keyup",t)},this.addEventListener=function(t,e){var n=this;return this.eventBus.subscribe(t,function(t){e.call(n,t)}),this},this.removeEventListener=function(t){this.eventBus.unsubscribe(t)},this.removeAllEventListener=function(){this.eventBus=new K},this.dispatchEvent=function(t,e){return this.eventBus.publish(t,e),this},"click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,mousewheel,keydown,keyup".split(",")),n=this;return t.forEach(function(e){n[e]=function(t){null!=t?this.addEventListener(e,t):this.dispatchEvent(e)}}),this.zoom=function(t){null!=t&&0!=t&&(this.scale=t)},this.zoomOut=function(t){this.scale<=this.scaleRange[1]&&0!=t&&(this.scale/=t=null==t?.8:t)},this.zoomIn=function(t){this.scale>=this.scaleRange[0]&&0!=t&&(this.scale*=t=null==t?.8:t)},this.getBound=function(){return{left:0,top:0,right:this.stage.width,bottom:this.stage.height,width:this.stage.width,height:this.stage.height}},this.getElementsBound=function(){return 0==this.childs.length?null:this.getBoundWithElemets()},this.getBoundWithElemets=function(){for(var t,e,n={left:Number.MAX_VALUE,right:-Number.MAX_VALUE,top:Number.MAX_VALUE,bottom:-Number.MAX_VALUE,width:0,height:0},i=this.zIndexMap[O.Node_zIndex]||[],r=i.length,o=0;o<r;o++)t=i[o],n.left>t.x&&(n.left=t.x,n.leftNode=t),e=t.x+t.width,n.right<e&&(n.right=e,n.rightNode=t),n.top>t.y&&(n.top=t.y,n.topNode=t),e=t.y+t.height,n.bottom<e&&(n.bottom=e,n.bottomNode=t);return n.leftNode&&n.leftNode.parentContainer&&(n.left=n.left-n.leftNode.parentContainer.padding),n.rightNode&&n.rightNode.parentContainer&&(n.right=n.right+n.rightNode.parentContainer.padding),n.bottomNode&&n.bottomNode.parentContainer&&(n.bottom=n.bottom+n.bottomNode.parentContainer.padding),n.topNode&&n.topNode.parentContainer&&(n.top=n.top-n.topNode.parentContainer.padding-n.topNode.parentContainer.headerHeight),n.width=Math.round(n.right-n.left),n.height=Math.round(n.bottom-n.top),n},this.translateToCenter=function(t){var e,n,i=this.getElementsBound();null!=i&&(n=e=0,n=t?(e=t.canvas.width/2-(i.left+i.right)/2,t.canvas.height/2-(i.top+i.bottom)/2):(e=this.stage.width/2-(i.left+i.right)/2,this.stage.height/2-(i.top+i.bottom)/2),this.translateX=e,this.translateY=n)},this.setCenter=function(t,e){t-=this.stage.width/2,e-=this.stage.height/2;this.translateX=-t,this.translateY=-e},this.centerAndZoom=function(t,e){var n,i,r,o;this.translateToCenter(e),null==t?null!=(i=this.getElementsBound())&&(n=i.width,i=i.height,o=r=1,o=e?(r=e.canvas.width/n,e.canvas.height/i):(r=this.stage.width/n,this.stage.height/i),e=Math.min(r,o),this.zoom(e=1<e?1:e)):this.zoom(t)},this.getCenterLocation=function(){return{x:this.stage.width/2,y:this.stage.height/2}},n}function et(t,e){return t[0]-e[0]||t[1]-e[1]}function nt(t){for(var e,n,i,r=t.length,o=[0,1],s=2,a=2;a<r;++a){for(;1<s&&(e=t[o[s-2]],n=t[o[s-1]],i=t[a],(n[0]-e[0])*(i[1]-e[1])-(n[1]-e[1])*(i[0]-e[0])<=0);)--s;o[s++]=a}return o.slice(0,s)}O.util=t,Q.prototype={get width(){return this.canvas.width},get height(){return this.canvas.height},set mode(e){this.childs.forEach(function(t){t.mode=e})}},tt.prototype=new $;function it(t){if((e=t.length)<3)return null;for(var e,n=new Array(e),i=new Array(e),r=0;r<e;++r)n[r]=[+t[r][0],+t[r][1],r];for(n.sort(et),r=0;r<e;++r)i[r]=[n[r][0],-n[r][1]];var o=nt(n),s=nt(i),a=s[0]===o[0],h=s[s.length-1]===o[o.length-1],c=[];for(r=o.length-1;0<=r;--r)c.push(t[n[o[r]][2]]);for(r=+a;r<s.length-h;++r)c.push(t[n[s[r]][2]]);return c}function rt(t){if(2==t.length)return[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2];if(3==t.length)return[(t[0][0]+t[1][0]+t[2][0])/3,(t[0][1]+t[1][1]+t[2][1])/3];for(var e,n,i=-1,r=t.length,o=0,s=0,a=t[r-1],h=0;++i<r;)e=a,a=t[i],h+=n=e[0]*a[1]-a[0]*e[1],o+=(e[0]+a[0])*n,s+=(e[1]+a[1])*n;return[o/(h*=3),s/h]}function ot(t,e){var n=e[0]-t[0],e=e[1]-t[1];return Math.sqrt(n*n+e*e)}function st(t){var r=this,e=0,s=0;function o(i,t){var r=this,n=t,o=t+1;this.advanceEnd=function(){o+=1},this.decreaseEnd=function(){--o},this.end=function(){return o},this.validEnd=function(){return i.closed()?o<i.size():o<i.size()-1},this.endPoint=function(){return i.get(o)},this.startPoint=function(){return i.get(n)},this.lineDstSqr=function(t){var t=i.get(t),e=r.startPoint(),n=r.endPoint();return a.linePtSegDistSq(e[0],e[1],n[0],n[1],t[0],t[1])},this.canTakeNext=function(){if(!r.validEnd())return!1;var t=!0;r.advanceEnd();for(var e=n+1;e<o;e+=1)if(r.lineDstSqr(e)>s){t=!1;break}return r.decreaseEnd(),t}}this.tolerance=function(t){if(!arguments.length)return e;s=(e=t)*e},this.isDisabled=function(){return e<0},this.apply=function(t){if(r.isDisabled()||t.size()<3)return t;for(var e=[],n=0;n<t.size();){for(var i=new o(t,n);i.canTakeNext();)i.advanceEnd();n=i.end(),e.push(i)}return new ht(e.map(function(t){return t.startPoint()}))},arguments.length&&r.tolerance(t)}function at(){var a=this,e=6;function h(t,e,n){for(var i=0,r=0,o=-2;o<=1;o+=1){var s=t.get(e+o),a=function(t,e){switch(t){case-2:return(((3-e)*e-3)*e+1)/6;case-1:return((3*e-6)*e*e+4)/6;case 0:return(((-3*e+3)*e+3)*e+1)/6;case 1:return e*e*e/6;default:console.warn("internal error!")}}(o,n);i+=a*s[0],r+=a*s[1]}return[i,r]}this.granularity=function(t){if(!arguments.length)return e;e=t},this.apply=function(t){if(t.size()<3)return t;var e=new ht,n=t.size()+3-1,i=a.granularity(),r=t.closed();e.add(h(t,2-(r?0:2),0));for(var o=2-(r?0:2);o<n+(r?0:2);o+=1)for(var s=1;s<=i;s+=1)e.add(h(t,o,s/i));return e}}var a=function h(){function E(t){var h=this,r=0,o=0,s=0,a=0,e=0;this.rect=function(t){if(!arguments.length)return{x:r,y:o,width:s,height:a};r=+t.x,o=+t.y,s=+t.width,a=+t.height},this.minX=function(){return r},this.minY=function(){return o},this.maxX=function(){return r+s},this.maxY=function(){return o+a},this.centerX=function(){return r+.5*s},this.centerY=function(){return o+.5*a},this.width=function(){return s},this.height=function(){return a},this.centroidDistance=function(t){if(!arguments.length)return e;e=t},this.cmp=function(t){return e<t.centroidDistance()?-1:(t.centroidDistance(),0)},this.add=function(t){var e=Math.min(h.minX(),t.minX()),n=Math.min(h.minY(),t.minY()),i=Math.max(h.maxX(),t.maxX()),t=Math.max(h.maxY(),t.maxY());s=i-(r=e),a=t-(o=n)},this.contains=function(t){var e=t.x(),t=t.y();return h.containsPt(e,t)},this.containsPt=function(t,e){return!(t<r||r+s<=t||e<o||o+a<=e)},this.intersects=function(t){return!(h.width()<=0||h.height()<=0||t.width()<=0||t.height()<=0)&&t.maxX()>h.minX()&&t.maxY()>h.minY()&&t.minX()<h.maxX()&&t.minY()<h.maxY()},this.intersectsLine=function(t){var e,n,i,r=t.x1(),o=t.y1(),s=t.x2(),a=t.y2();if(0!==(n=h.outcode(s,a)))for(;0!==(e=h.outcode(r,o));){if(0!=(e&n))return!1;0!=(e&(E.OUT_LEFT|E.OUT_RIGHT))?(i=h.minX(),0!=(e&E.OUT_RIGHT)&&(i+=h.width()),o+=(i-r)*(a-o)/(s-r),r=i):(i=h.minY(),0!=(e&E.OUT_BOTTOM)&&(i+=h.height()),r+=(i-o)*(s-r)/(a-o),o=i)}return!0},this.outcode=function(t,e){var n=0;return s<=0?n|=E.OUT_LEFT|E.OUT_RIGHT:t<r?n|=E.OUT_LEFT:r+s<t&&(n|=E.OUT_RIGHT),a<=0?n|=E.OUT_TOP|E.OUT_BOTTOM:e<o?n|=E.OUT_TOP:o+a<e&&(n|=E.OUT_BOTTOM),n},arguments.length&&t&&this.rect(t)}function C(t,e){var n=+t,i=+e;this.x=function(t){if(!arguments.length)return n;n=t},this.y=function(t){if(!arguments.length)return i;i=t},this.distanceSq=function(t){return C.ptsDistanceSq(n,i,t.x(),t.y())},this.get=function(){return[n,i]}}function N(t){var n=0,i=[],r=(i.length=t,{});function o(t){return t.x()+"x"+t.y()}this.add=function(t){r[o(t)]=t,i[n]=t,n+=1},this.contains=function(t){var e=r[o(t)];return!!e&&e.x()===t.x()&&e.y()===t.y()},this.isFirst=function(t){var e;return!!n&&(e=i[0]).x()===t.x()&&e.y()===t.y()},this.list=function(){return i.filter(function(t){return t}).map(function(t){return t.get()})},this.clear=function(){for(var t=0;t<i.length;t+=1)i[t]=null;r={},n=0},this.get=function(t){return i[t]},this.size=function(){return n}}function L(t,e,n,i){var r=+t,o=+e,s=+n,a=+i;this.rect=function(){var t=Math.min(r,s),e=Math.min(o,a);return new E({x:t,y:e,width:Math.max(r,s)-t,height:Math.max(o,a)-e})},this.x1=function(t){if(!arguments.length)return r;r=t},this.x2=function(t){if(!arguments.length)return s;s=t},this.y1=function(t){if(!arguments.length)return o;o=t},this.y2=function(t){if(!arguments.length)return a;a=t},this.cuts=function(t){var e;return o!==a&&!((e=t.y())<o&&e<=a||o<e&&a<=e||(t=t.x(),r<t&&s<=t)||!(t<r&&t<=s||t<=r+(e-o)*(s-r)/(a-o)))},this.ptSegDistSq=function(t,e){return h.linePtSegDistSq(r,o,s,a,t,e)},this.ptClose=function(t,e,n){if(r<s){if(t<r-n||s+n<t)return!1}else if(t<s-n||r+n<t)return!1;if(o<a){if(e<o-n||a+n<e)return!1}else if(e<a-n||o+n<e)return!1;return!0}}function S(i,r){var o=new Float32Array(i*r);this.bound=function(t,e){return t<0?0:Math.min(t,(e?i:r)-1)},this.get=function(t,e){return t<0||i<=t||e<0||r<=e?Number.NaN:o[t+e*i]},this.set=function(t,e,n){t<0||i<=t||e<0||r<=e||(o[t+e*i]=n)},this.width=function(){return i},this.height=function(){return r}}function _(t,e){var n=t,i=e;this.getState=function(){return i},this.getPoint=function(){return n}}E.prototype.toString=function(){return"Rectangle[x="+this.minX()+", y="+this.minY()+", w="+this.width()+", h="+this.height()+"]"},E.OUT_LEFT=1,E.OUT_TOP=2,E.OUT_RIGHT=4,E.OUT_BOTTOM=8,C.ptsDistanceSq=function(t,e,n,i){return(t-n)*(t-n)+(e-i)*(e-i)},C.doublePointsEqual=function(t,e,n,i,r){return C.ptsDistanceSq(t,e,n,i)<r*r},_.POINT=1,_.PARALLEL=2,_.COINCIDENT=3,_.NONE=4,_.intersectLineLine=function(t,e){var n,i=(e.x2()-e.x1())*(t.y1()-e.y1())-(e.y2()-e.y1())*(t.x1()-e.x1()),r=(t.x2()-t.x1())*(t.y1()-e.y1())-(t.y2()-t.y1())*(t.x1()-e.x1()),e=(e.y2()-e.y1())*(t.x2()-t.x1())-(e.x2()-e.x1())*(t.y2()-t.y1());return e?(n=r/e,0<=(e=i/e)&&e<=1&&0<=n&&n<=1?new _(new C(t.x1()+e*(t.x2()-t.x1()),t.y1()+e*(t.y2()-t.y1())),_.POINT):new _(null,_.NONE)):new _(null,0==i||0==r?_.COINCIDENT:_.PARALLEL)},_.fractionAlongLineA=function(t,e){var n=(e.x2()-e.x1())*(t.y1()-e.y1())-(e.y2()-e.y1())*(t.x1()-e.x1()),i=(t.x2()-t.x1())*(t.y1()-e.y1())-(t.y2()-t.y1())*(t.x1()-e.x1()),e=(e.y2()-e.y1())*(t.x2()-t.x1())-(e.x2()-e.x1())*(t.y2()-t.y1());if(e){t=n/e,n=i/e;if(0<=t&&t<=1&&0<=n&&n<=1)return t}return Number.POSITIVE_INFINITY};var a=new L(0,0,0,0);function T(o,r,s,t){var a=T.S,h=t,n=!1;function i(t,e,n,i){t=r.get(t,e);return isNaN(t)?t:h<t?n+i:n}function c(t,e){var n=i(t,e,0,1);return n=i(t+1,e,n,2),n=i(t,e+1,n,4),n=i(t+1,e+1,n,8),isNaN(n)?(console.warn("marched out of bounds: "+t+" "+e+" bounds: "+r.width()+" "+r.height()),-1):n}this.march=function(){for(var t=0;t<r.width()&&!n;t+=1)for(var e=0;e<r.height()&&!n;e+=1)r.get(t,e)>h&&15!=c(t,e)&&(n=function(t,e){for(var n=t,i=e;;){var r=new C(n*s,i*s);if(o.contains(r)){if(o.isFirst(r))return!0}else o.add(r);switch(c(n,i)){case-1:return!0;case 0:case 3:case 2:case 7:a=T.E;break;case 12:case 14:case 4:a=T.W;break;case 6:a=a===T.N?T.W:T.E;break;case 1:case 13:case 5:a=T.N;break;case 9:a=a===T.E?T.N:T.S;break;case 10:case 8:case 11:a=T.S}switch(a){case T.N:--i;break;case T.S:i+=1;break;case T.W:--n;break;case T.E:n+=1}}}(t,e));return n}}_.fractionToLineCenter=function(t,r){var o=Number.POSITIVE_INFINITY,s=0;function e(t,e,n,i){a.x1(t),a.y1(e),a.x2(n),a.y2(i);t=_.fractionAlongLineA(r,a);0<=(t=Math.abs(t-.5))&&t<=1&&(s+=1,t<o)&&(o=t)}return e(t.minX(),t.minY(),t.maxX(),t.minY()),e(t.minX(),t.minY(),t.minX(),t.maxY()),!(1<s||(e(t.minX(),t.maxY(),t.maxX(),t.maxY()),1<s)||(e(t.maxX(),t.minY(),t.maxX(),t.maxY()),0!==s))?-1:o},_.fractionToLineEnd=function(t,r){var o=Number.POSITIVE_INFINITY,s=0;function e(t,e,n,i){t=_.fractionAlongLineA(r,new L(t,e,n,i));0<=t&&t<=1&&(s+=1,t<o)&&(o=t)}return e(t.minX(),t.minY(),t.maxX(),t.minY()),e(t.minX(),t.minY(),t.minX(),t.maxY()),!(1<s||(e(t.minX(),t.maxY(),t.maxX(),t.maxY()),1<s)||(e(t.maxX(),t.minY(),t.maxX(),t.maxY()),0!==s))?-1:o},_.testIntersection=function(o,t,s){var a=0;function e(t,e,n,i,r){s[t]=_.intersectLineLine(o,new L(e,n,i,r)),s[t].getState()===_.POINT&&(a+=1)}return e(0,t.minX(),t.minY(),t.maxX(),t.minY()),e(1,t.minX(),t.minY(),t.minX(),t.maxY()),e(2,t.minX(),t.maxY(),t.maxX(),t.maxY()),e(3,t.maxX(),t.minY(),t.maxX(),t.maxY()),a},T.N=0,T.S=1,T.E=2,T.W=3;var P=h.DEFAULT_MAX_ROUTING_ITERATIONS,O=h.DEFAULT_MAX_MARCHING_ITERATIONS,A=h.DEFAULT_PIXEL_GROUP,n=h.DEFAULT_EDGE_R0,I=h.DEFAULT_EDGE_R1,v=h.DEFAULT_NODE_R0,D=h.DEFAULT_NODE_R1,B=h.DEFAULT_MORPH_BUFFER,z=h.DEFAULT_SKIP,R=(this.maxRoutingIterations=function(t){if(!arguments.length)return P;P=t},this.maxMarchingIterations=function(t){if(!arguments.length)return O;O=t},this.pixelGroup=function(t){if(!arguments.length)return A;A=t},this.edgeR0=function(t){if(!arguments.length)return n;n=t},this.edgeR1=function(t){if(!arguments.length)return I;I=t},this.nodeR0=function(t){if(!arguments.length)return v;v=t},this.nodeR1=function(t){if(!arguments.length)return D;D=t},this.morphBuffer=function(t){if(!arguments.length)return B;B=t},this.skip=function(t){if(!arguments.length)return z;z=t},1),V=1,j=1,F=-.8,X=null,Y=[],U=null,W=Number.NaN,G=!(this.createOutline=function(t,e,n){if(!t.length)return[];var i,r,o,s,a,h,c,u,l,d=t.map(function(t){return new E(t)}),f=e.map(function(t){return new E(t)}),p=(i=f,a=[],Y=[],s=o=r=0,(e=t=d).forEach(function(t){r+=t.centerX(),o+=t.centerY(),s+=1}),r/=s,o/=s,e.forEach(function(t){var e=r-t.centerX(),n=o-t.centerY();t.centroidDistance(Math.sqrt(e*e+n*n))}),t.sort(function(t,e){return t.cmp(e)}),t.forEach(function(t){(function(r,t,e){var n=[],i=[],o=new C(t.centerX(),t.centerY()),s=null,a=Number.POSITIVE_INFINITY;if(e.forEach(function(t){var n,e=new C(t.centerX(),t.centerY()),i=o.distanceSq(e),e=new L(o.x(),o.y(),e.x(),e.y()),e=(n=e,r.reduce(function(t,e){return e.intersectsLine(n)&&0<=_.fractionToLineCenter(e,n)?t+1:t},0));i*(e+1)*(e+1)<a&&(s=t,a=i*(e+1)*(e+1))}),s){var t=new L(o.x(),o.y(),s.centerX(),s.centerY()),h=(i.push(t),!0),c=0,u=[];for(u.length=4;h&&c<P;)for(h=!1;!h&&i.length;){var l=i.pop();if((v=K(r,l))&&2===_.testIntersection(l,v,u)){for(var d=B,f=Z(v,d,u,!0),p=J(f,i)||J(f,n),g=H(f,r);!p&&g&&1<=d;)p=J(f=Z(v,d/=1.5,u,!0),i)||J(f,n),g=H(f,r);if(!f||p||g||(i.push(new L(l.x1(),l.y1(),f.x(),f.y())),i.push(new L(f.x(),f.y(),l.x2(),l.y2())),h=!0),!h){for(var y=J(f=Z(v,d=B,u,!1),i)||J(f,n),g=H(f,r);!y&&g&&1<=d;)y=J(f=Z(v,d/=1.5,u,!1),i)||J(f,n),g=H(f,r);f&&!y&&(i.push(new L(l.x1(),l.y1(),f.x(),f.y())),i.push(new L(f.x(),f.y(),l.x2(),l.y2())),h=!0)}}h||n.push(l),c+=1}for(;i.length;)n.push(i.pop());for(;n.length;){var v,m,x,w=n.pop();n.length?(m=n.pop(),x=new L(w.x1(),w.y1(),m.x2(),m.y2()),(v=K(r,x))?(i.push(w),n.push(m)):n.push(x)):i.push(w)}n=i}return n})(i,t,a).forEach(function(t){Y.push(t)}),a.push(t)}),n&&n.forEach(function(t){Y.push(new L(t.x1,t.y1,t.x2,t.y2))}),X=null,d.forEach(function(t){X?X.add(t):X=new E(t.rect())}),Y.forEach(function(t){X.add(t.rect())}),X.rect({x:X.minX()-Math.max(I,D)-B,y:X.minY()-Math.max(I,D)-B,width:X.width()+2*Math.max(I,D)+2*B,height:X.height()+2*Math.max(I,D)+2*B}),U=new S(Math.ceil(X.width()/A),Math.ceil(X.height()/A)),new N(2*(Math.floor(X.width())+Math.floor(X.height())))),e=R,t=F,n=V,g=j,y=0;for(q(X,d,f,U);c=X,u=d,l=f,(!new T(h=p,U,A,R).march()||!function(t,e,n,i){var r=[],o=null;function s(t,e){var n=null,i=null,r=0;return t.forEach(function(t){n?(n.x1(n.x2()),n.y1(n.y2()),n.x2(t.x()),n.y2(t.y()),n.cuts(e)&&(r+=1)):(n=new L(t.x(),t.y(),t.x(),t.y()),i=t)}),i&&(n.x1(n.x2()),n.y1(n.y2()),n.x2(i.x()),n.y2(i.y()),n.cuts(e))&&(r+=1),r%2==1}var a=z,h=t.size();if(1<a)for(h=t.size()/a;h<3&&1<a;)a--,h=t.size()/a;for(var c=e.minX(),u=e.minY(),l=0;l<h-1;l+=1){var d=t.get(l*a).x()+c,f=t.get(l*a).y()+u,p={x:d,y:f,width:0,height:0};o?o.add(new E(p)):o=new E(p),r.push(new C(d,f))}var g=!0,y=!1;return o&&(n.forEach(function(t){t=new C(t.centerX(),t.centerY());g=(g=g&&o.contains(t))&&s(r,t)}),i.forEach(function(t){t=new C(t.centerX(),t.centerY());o.contains(t)&&s(r,t)&&(y=!0)})),[g,y]}(h,c,u,l)[0])&&y<O;)p.clear(),(y+=1)<=.5*O&&0!=F&&(R*=.95,F*=.8,q(X,d,f,U)),.5*O<y&&(R*=.95,V*=1.2,j*=1.2,q(X,d,f,U));W=R,R=e,F=t,V=n,j=g;var v=z,m=p.size();if(1<v)for(m=Math.floor(p.size()/v);m<3&&1<v;)--v,m=Math.floor(p.size()/v);for(var x=X.minX(),w=X.minY(),b=new N(m),k=0,M=0;M<m;M+=1,k+=v)b.add(new C(p.get(k).x()+x,p.get(k).y()+w));return G||(U=X=null),b.list()});function q(d,t,e,f){var u,l,p,g,y=0;V&&t.forEach(function(t){var e=v-D,n=f,i=(y=V)/(e*e),r=D,o=t;i<0&&console.warn("expected positive influence",i);for(var s=n.bound(Math.floor((o.minX()-r-X.minX())/A),!0),e=n.bound(Math.floor((o.minY()-r-X.minY())/A),!1),a=n.bound(Math.ceil((o.maxX()+r-X.minX())/A),!0),h=n.bound(Math.ceil((o.maxY()+r-X.minY())/A),!1),c=e;c<h;c+=1)for(var u=s;u<a;u+=1){var l=m(o,u*A+X.minX(),c*A+X.minY());l<r*r&&(l=Math.sqrt(l)-r,n.set(u,c,n.get(u,c)+i*l*l))}}),j&&(y=j,t=(n-I)*(n-I),0<Y.length)&&(u=f,l=y/t,p=I,g=d,Y.forEach(function(t){for(var e,n,i=t.rect(),r=u.bound(Math.floor((i.minX()-p-g.minX())/A),!0),o=u.bound(Math.floor((i.minY()-p-g.minY())/A),!1),s=u.bound(Math.ceil((i.maxX()+p-g.minX())/A),!0),a=u.bound(Math.ceil((i.maxY()+p-g.minY())/A),!1),h=o;h<a;h+=1)for(var c=r;c<s;c+=1)l<0&&u.get(c,h)<=0||(e=c*A+g.minX(),n=h*A+g.minY(),(e=t.ptSegDistSq(e,n))<p*p&&(n=Math.sqrt(e)-p,u.set(c,h,u.get(c,h)+l*n*n)))})),F&&e.forEach(function(t){if(d.intersects(t)){var e=v-D,n=f,i=(y=F)/(e*e),r=D,o=t;0<i&&console.warn("expected negative influence",i);for(var s,a=n.bound(Math.floor((o.minX()-r-X.minX())/A),!0),e=n.bound(Math.floor((o.minY()-r-X.minY())/A),!1),h=n.bound(Math.ceil((o.maxX()+r-X.minX())/A),!0),c=n.bound(Math.ceil((o.maxY()+r-X.minY())/A),!1),u=e;u<c;u+=1)for(var l=a;l<h;l+=1)n.get(l,u)<=0||(s=m(o,l*A+X.minX(),u*A+X.minY()))<r*r&&(s=Math.sqrt(s)-r,n.set(l,u,n.get(l,u)+i*s*s))}})}function H(e,t){return t.some(function(t){return t.contains(e)})}function J(e,t){var n=!1;return t.forEach(function(t){n||(C.doublePointsEqual(t.x1(),t.y1(),e.x(),e.y(),.001)&&(n=!0),C.doublePointsEqual(t.x2(),t.y2(),e.x(),e.y(),.001)&&(n=!0))}),n}function K(t,n){var i=Number.POSITIVE_INFINITY,r=null;return t.forEach(function(t){var e;t.intersectsLine(n)&&0<=(e=_.fractionToLineCenter(t,n))&&e<i&&(r=t,i=e)}),r}function m(t,e,n){if(!t.containsPt(e,n)){var i=t.outcode(e,n);if((i&E.OUT_TOP)===E.OUT_TOP)return(i&E.OUT_LEFT)===E.OUT_LEFT?C.ptsDistanceSq(e,n,t.minX(),t.minY()):(i&E.OUT_RIGHT)===E.OUT_RIGHT?C.ptsDistanceSq(e,n,t.maxX(),t.minY()):(t.minY()-n)*(t.minY()-n);if((i&E.OUT_BOTTOM)===E.OUT_BOTTOM)return(i&E.OUT_LEFT)===E.OUT_LEFT?C.ptsDistanceSq(e,n,t.minX(),t.maxY()):(i&E.OUT_RIGHT)===E.OUT_RIGHT?C.ptsDistanceSq(e,n,t.maxX(),t.maxY()):(n-t.maxY())*(n-t.maxY());if((i&E.OUT_LEFT)===E.OUT_LEFT)return(t.minX()-e)*(t.minX()-e);if((i&E.OUT_RIGHT)===E.OUT_RIGHT)return(e-t.maxX())*(e-t.maxX())}return 0}function Z(t,e,n,i){var r,o=n[0],s=n[1],a=n[2],n=n[3];if(i){if(s.getState()===_.POINT)return o.getState()===_.POINT?new C(t.minX()-e,t.minY()-e):a.getState()===_.POINT?new C(t.minX()-e,t.maxY()+e):(r=t.height()*t.width(),t.width()*(.5*(s.getPoint().y()-t.minY()+(n.getPoint().y()-t.minY())))<.5*r?s.getPoint().y()>n.getPoint().y()?new C(t.minX()-e,t.minY()-e):new C(t.maxX()+e,t.minY()-e):s.getPoint().y()<n.getPoint().y()?new C(t.minX()-e,t.maxY()+e):new C(t.maxX()+e,t.maxY()+e));if(n.getState()===_.POINT){if(o.getState()===_.POINT)return new C(t.maxX()+e,t.minY()-e);if(a.getState()===_.POINT)return new C(t.maxX()+e,t.maxY()+e)}return r=t.height()*t.width(),t.height()*(.5*(o.getPoint().x()-t.minX()+(a.getPoint().x()-t.minX())))<.5*r?o.getPoint().x()>a.getPoint().x()?new C(t.minX()-e,t.minY()-e):new C(t.minX()-e,t.maxY()+e):o.getPoint().x()<a.getPoint().x()?new C(t.maxX()+e,t.minY()-e):new C(t.maxX()+e,t.maxY()+e)}if(s.getState()===_.POINT)return o.getState()===_.POINT?new C(t.maxX()+e,t.maxY()+e):a.getState()===_.POINT?new C(t.maxX()+e,t.minY()-e):(r=t.height()*t.width(),t.width()*(.5*(s.getPoint().y()-t.minY()+(n.getPoint().y()-t.minY())))<.5*r?s.getPoint().y()>n.getPoint().y()?new C(t.maxX()+e,t.maxY()+e):new C(t.minX()-e,t.maxY()+e):s.getPoint().y()<n.getPoint().y()?new C(t.maxX()+e,t.minY()-e):new C(t.minX()-e,t.minY()-e));if(n.getState()===_.POINT){if(o.getState()===_.POINT)return new C(t.minX()-e,t.maxY()+e);if(a.getState()===_.POINT)return new C(t.minX()-e,t.minY()-e)}return r=t.height()*t.width(),t.height()*(.5*(o.getPoint().x()-t.minX()+(a.getPoint().x()-t.minX())))<.5*r?o.getPoint().x()>a.getPoint().x()?new C(t.maxX()+e,t.maxY()+e):new C(t.maxX()+e,t.minY()-e):o.getPoint().x()<a.getPoint().x()?new C(t.minX()-e,t.maxY()+e):new C(t.minX()-e,t.minY()-e)}this.debug=function(t){if(!arguments.length)return G;G=!!t},this.debugPotentialArea=function(){G||console.warn("debug mode should be activated");for(var t=[],e=0;e<U.width();e+=1)for(var n=0;n<U.height();n+=1)t.push({x:e*A+Math.floor(X.minX()),y:n*A+Math.floor(X.minY()),width:A,height:A,value:U.get(e,n),threshold:W});return t}},ht=(a.DEFAULT_MAX_ROUTING_ITERATIONS=100,a.DEFAULT_MAX_MARCHING_ITERATIONS=20,a.DEFAULT_PIXEL_GROUP=4,a.DEFAULT_EDGE_R0=10,a.DEFAULT_EDGE_R1=20,a.DEFAULT_NODE_R0=15,a.DEFAULT_NODE_R1=50,a.DEFAULT_MORPH_BUFFER=a.DEFAULT_NODE_R0,a.DEFAULT_SKIP=8,a.linePtSegDistSq=function(t,e,n,i,r,o){n-=t,i-=e,r-=t,t=o-e,o=r*n+t*i,e=o<=0||(o=(r=n-r)*n+(t=i-t)*i)<=0?0:o*o/(n*n+i*i),o=r*r+t*t-e;return o=o<0?0:o},a.addPadding=function(t,e){return t.map(function(t){return{x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e}})},function(t){var i=this,r=[],e=!0;this.closed=function(t){if(!arguments.length)return e;e=t},this.addAll=function(t){t.forEach(function(t){i.add(t)})},this.add=function(t){var e=t[0],t=t[1];(Number.isNaN(e)||Number.isNaN(t))&&console.warn("Point with NaN",e,t),r.push([e,t])},this.size=function(){return r.length},this.get=function(t){var e=i.size(),n=i.closed();return t<0?n?i.get(t+e):i.get(0):e<=t?n?i.get(t-e):i.get(e-1):r[t]},this.forEach=function(n){r.forEach(function(t,e){n(t,e,i)})},this.isEmpty=function(){return!i.size()},this.transform=function(t){var e=i;return t.forEach(function(t){e=t.apply(e)}),e},this.toString=function(){var e="";return this.forEach(function(t){e.length?e+=" L"+t[0]+" "+t[1]:e+="M"+t[0]+" "+t[1]}),e.length?(this.closed()&&(e+=" Z"),e):"M0 0"},arguments.length&&t&&i.addAll(t)});function ct(){this.initialize=function(){ct.prototype.initialize.apply(this,arguments),this.elementType="displayElement",this.id=null,this.x=0,this.y=0,this.width=40,this.height=40,this.radius=20,this.size=40,this.visible=!0,this.alpha=1,this.rotate=0,this.scale=1,this.color=null,this.strokeColor="22,255,22",this.borderColor="22,255,22",this.fillColor="22,255,22",this.showShadow=!1,this.shadowBlur=20,this.shadowColor="rgba(20,200,20,0.5)",this.shadowOffsetX=0,this.shadowOffsetY=0,this.transformAble=!1,this.animate=!1,this.zIndex=0,this.properties={}},this.initialize(),this.paint=function(t){t.beginPath(),t.rect(-this.width/2,-this.height/2,this.width,this.height),this.fillColor&&(t.fillStyle="rgba(".concat(this.fillColor,",").concat(this.alpha,")"),t.fill()),t.strokeStyle="rgba(".concat(this.strokeColor,",").concat(this.alpha,")"),t.stroke(),t.closePath()},this.getLocation=function(){return{x:this.x,y:this.y}},this.setLocation=function(t,e){return this.x=t,this.y=e,this},this.getCenterLocation=function(){return{x:this.x+this.width/2,y:this.y+this.height/2}},this.setCenterLocation=function(t,e){return this.x=t-this.width/2,this.y=e-this.height/2,this},this.getSize=function(){return{width:this.width,height:this.heith}},this.setSize=function(t,e){return this.width=Number(t)||40,this.height=Number(e)||40,this.raduis=Math.round(this.width/2),this},this.getBound=function(){return{left:this.x-this.borderWidth,top:this.y-this.borderWidth,right:this.x+this.width+this.borderWidth,bottom:this.y+this.height+this.borderWidth,width:this.width,height:this.height}},this.setBound=function(t,e,n,i){return this.setLocation(t,e),this.setSize(n,i),this},this.getPosition=function(t){var e,n=this.getBound();switch(t){case"Top_Left":e={x:n.left,y:n.top};break;case"Top_Center":e={x:this.cx,y:n.top};break;case"Top_Right":e={x:n.right,y:n.top};break;case"Middle_Left":e={x:n.left,y:this.cy};break;case"Middle_Center":e={x:this.cx,y:this.cy};break;case"Middle_Right":e={x:n.right,y:this.cy};break;case"Bottom_Left":e={x:n.left,y:n.bottom};break;case"Bottom_Center":e={x:this.cx,y:n.bottom};break;case"Bottom_Right":e={x:n.right,y:n.bottom};break;default:e={x:this.cx,y:this.cy}}return e}}function ut(){this.initialize=function(){ut.prototype.initialize.apply(this,arguments),this.elementType="interactiveElement",this.dragable=!1,this.selected=!1,this.showSelected=!1,this.isMouseOver=!1,this.selectedLocation=null,this.showBackGround=!1,this.animate=!1,this.visible=!0,this.mouseInteractive=!0},this.initialize(),this.paintMouseover=function(t){this.showSelected=!0},this.isInBound=function(t,e){var n,i,r,o,s,a;return"rect"==this.shape?(n=this.width*this.scale,i=this.height*this.scale,0==this.rotate?t>this.cx-n/2&&t<this.cx+n/2&&e>this.cy-i/2&&e<this.cy+i/2:(a=this.cx,r=this.cy,o=-this.rotate*Math.PI/180,s=(t-a)*Math.cos(o)-(e-r)*Math.sin(o)+a,a=(t-a)*Math.sin(o)+(e-r)*Math.cos(o)+r,s>this.cx-n/2&&s<this.cx+n/2&&a>this.cy-i/2&&a<this.cy+i/2)):(t-this.cx)*(t-this.cx)+(e-this.cy)*(e-this.cy)<this.radius*this.scale*this.radius*this.scale},this.selectedHandler=function(){this.selected=!0,this.selectedLocation={x:this.x,y:this.y}},this.unselectedHandler=function(){this.selected=!1,this.selectedLocation=null},this.dbclickHandler=function(t){this.dispatchEvent("dbclick",t)},this.clickHandler=function(t){this.dispatchEvent("click",t)},this.mousedownHander=function(t){this.dispatchEvent("mousedown",t)},this.mouseupHandler=function(t){this.dispatchEvent("mouseup",t)},this.mouseoverHandler=function(t){this.isMouseOver=!0,this.dispatchEvent("mouseover",t)},this.mousemoveHandler=function(t){this.dispatchEvent("mousemove",t)},this.mouseoutHandler=function(t){this.isMouseOver=!1,this.showSelected=!1,this.dispatchEvent("mouseout",t)},this.mousedragHandler=function(t){var e=this.selectedLocation.x+t.dx,n=this.selectedLocation.y+t.dy;this.setLocation(e,n),this.dispatchEvent("mousedrag",t)},this.addEventListener=function(t,e){var n=this;return this.eventBus||(this.eventBus=new K),this.eventBus.subscribe(t,function(t){e.call(n,t)}),this},this.dispatchEvent=function(t,e){return this.eventBus?(this.eventBus.publish(t,e),this):null},this.removeEventListener=function(t){this.eventBus.unsubscribe(t)},this.removeAllEventListener=function(){this.eventBus=new K};var t=this;["click","dbclick","mousedown","mouseup","mouseover","mouseout","mousemove","mousedrag"].forEach(function(e){t[e]=function(t){null!=t?this.addEventListener(e,t):this.dispatchEvent(e)}})}function lt(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.initialize=function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];lt.prototype.initialize.apply(this,arguments),this.elementType="group",this.zIndex=O.Group_zIndex,this.fixed=e,this.width=100,this.height=100,this.childs=[],this.alpha=.1,this.dragable=!0,this.childDragable=!0,this.visible=!0,this.fillColor="250,250,250",this.borderWidth=1,this.borderColor="100,100,220",this.selectedBorderWidth=2,this.selectedBorderColor="30,30,250",this.showHeader=!1,this.label=t,this.textAlign="center",this.textOffsetX=10,this.font="normal 14px Arial",this.fontColor="255,255,255",this.headerColor="60,60,200",this.headerAlpha=.8,this.headerHeight=40,this.padding=20,this.polygonPoints=[],this.outerCircleCenter={x:0,y:0},this.outerCircleRadius=0,this.shape="rect",this.needUpdate=!0,this.pathCache=null},this.add=function(t){var e=this,n=this;t instanceof Array?t.forEach(function(t){n.childs.push(t),t.parentContainer=e}):(n.childs.push(t),t.parentContainer=this),this.needUpdate=!0},this.remove=function(t){for(var e=0;e<this.childs.length;e++)if(this.childs[e]===t){t.dragable=!0,t.parentContainer=null,this.childs.splice(e,1);break}this.needUpdate=!0},this.removeAll=function(){this.childs.forEach(function(t){t.dragable=!0,t.parentContainer=null}),this.childs=[],this.needUpdate=!0},this.setLocation=function(t,e){var n=t-this.x,i=e-this.y;this.x=t,this.y=e,this.childs.forEach(function(t){t.setLocation(t.x+n,t.y+i)}),this.needUpdate=!0},this.computeHullPolygon=function(){var e=this.padding,n=[];return this.childs.forEach(function(t){t.visible&&(n.push([t.x-e,t.y-e]),n.push([t.x-e,t.cy+t.radius+e]),n.push([t.cx+t.radius+e,t.y-e]),n.push([t.cx+t.radius+e,t.cy+t.radius+e]))}),n=it(n)},this.computeHullPolygon1=function(){var e=[],n=(this.childs.forEach(function(t){t.visible&&e.push([t.cx,t.cy])}),e=it(e),rt(e));return e.forEach(function(t){t[0]=n[0]+1.4*(t[0]-n[0]),t[1]=n[1]+1.4*(t[1]-n[1])}),this.polygonPoints=e},this.computeOuterCircle=function(){var t=this.computeHullPolygon(),e=rt(t),n=0;return t.forEach(function(t){n=Math.max(ot(t,e),n)}),this.outerCircleCenter={x:Math.round(e[0]),y:Math.round(e[1])},this.outerCircleRadius=Math.max(Math.round(n),120),{radius:this.outerCircleRadius,center:this.outerCircleCenter}},this.paintStorkeStyle=function(t,e){0<this.borderWidth&&!this.showSelected&&!this.selected&&(t.lineWidth=this.borderWidth,t.strokeStyle="rgba(".concat(this.borderColor,",1)"),null==e?t.stroke():t.stroke(e)),0<this.selectedBorderWidth&&(this.showSelected||this.selected)&&(t.lineWidth=this.selectedBorderWidth,t.strokeStyle="rgba(".concat(this.selectedBorderColor,",1)"),null==e?t.stroke():t.stroke(e))},this.paintPolygonArea=function(t){if(this.needUpdate){var e=this.computeHullPolygon(),n=(this.polygonPoints=e,null);if(this.smoothPath)n=this.generateSmoothPath(e);else{for(var i=["M".concat(e[0][0]," ").concat(e[0][1])],r=1;r<e.length;r++)i.push(" L".concat(e[r][0]," ").concat(e[r][1]));i.push(" Z"),n=i.join("")}this.pathCache=n}n=new Path2D(this.pathCache);t.save(),this.fillColor&&(t.fillStyle="rgba(".concat(this.fillColor,",").concat(this.alpha,")"),t.fill(n)),this.paintStorkeStyle(t,n),t.restore()},this.paintBubbleSet=function(t){t.save(),this.fillColor?(t.fillStyle="rgba(".concat(this.fillColor,",").concat(this.alpha,")"),t.fill(new Path2D(this.computeBubblePath()))):(t.lineWidth=this.borderWidth,t.strokeStyle="rgba(".concat(this.borderColor,",1)"),t.stroke(new Path2D(this.computeBubblePath()))),t.restore()},this.computeBubblePath=function(){var t,e=[],n=[],i=[],r=this.padding,o=(this.childs.forEach(function(t){t.visible&&(n.push({x:t.x-r,y:t.y-r,width:t.width+2*r,height:t.height+2*r}),e.push(t.id),(t.outLinks||[]).forEach(function(t){i.push(t)}))}),new a),s=[];return s=this.considerEdges?(t=i.filter(function(t){return-1!=e.indexOf(t.target.id)}).map(function(t){return{x1:t.source.cx,y1:t.source.cy,x2:t.target.cx,y2:t.target.cy}}),o.createOutline(n,[],t)):o.createOutline(n,[]),this.generateSmoothPath(s)},this.generateSmoothPath=function(t){return new ht(t).transform([new st(0),new at,new st(0)]).toString()},this.paintRectArea=function(t){this.fixed||this.ajustAreaRange(),t.save(),t.beginPath(),this.fillColor?(t.fillStyle="rgba(".concat(this.fillColor,",").concat(this.alpha,")"),t.fillRect(this.x,this.y,this.width,this.height)):t.rect(this.x,this.y,this.width,this.height),this.paintStorkeStyle(t),t.restore(),this.showHeader&&this.paintHeader(t)},this.paintOuterCircle=function(t){this.ajustAreaRange(),t.save(),t.beginPath(),t.arc(this.outerCircleCenter.x,this.outerCircleCenter.y,this.outerCircleRadius,0,2*Math.PI),t.fillStyle="rgba(".concat(this.fillColor,",").concat(this.alpha,")"),t.fill(),this.paintStorkeStyle(t),t.restore()},this.paint=function(t){switch(this.shape){case"polygon":this.paintPolygonArea(t);break;case"circle":this.paintOuterCircle(t);break;case"bubbleset":this.paintBubbleSet(t);break;default:this.paintRectArea(t)}},this.paintHeader=function(t){t.save(),t.beginPath(),t.rect(this.x,this.y,this.width,this.headerHeight),t.fillStyle="rgba(".concat(this.headerColor,",").concat(this.headerAlpha,")"),t.fill();var e=this.borderWidth;0<(e=this.showSelected||this.selected?this.selectedBorderWidth:e)&&(t.lineWidth=e,t.strokeStyle="rgba(".concat(this.headerColor,",").concat(this.headerAlpha,")"),t.stroke()),this.label&&(e=t.measureText(this.label).width,e=this.getTextPostion(e),t.font=this.font,t.textBaseline="middle",t.fillStyle="rgba(".concat(this.fontColor,",").concat(this.headerAlpha,")"),t.fillText(this.label,e.x,e.y)),t.restore()},this.getTextPostion=function(t){var e=null;switch(this.textAlign){case"center":e={x:this.x+this.width/2-t/2,y:this.y+this.headerHeight/2};break;case"right":e={x:this.x+this.width-(t+2*this.textOffsetX),y:this.y+this.headerHeight/2};break;default:e={x:this.x+this.textOffsetX,y:this.y+this.headerHeight/2}}return e},this.paintMouseover=function(t){this.showSelected=!0},this.isInBound=function(t,e){var n=!1;return"rect"==this.shape?n=t>this.x&&t<this.x+this.width&&e>this.y&&e<this.y+this.height:"polygon"==this.shape?0<(this.polygonPoints||[]).length&&(n=function(t,e){for(var n,i,r=t.length,o=t[r-1],s=e[0],a=e[1],h=o[0],c=o[1],u=!1,l=0;l<r;++l)n=(o=t[l])[0],(i=o[1])>a!=a<c&&s<(h-n)*(a-i)/(c-i)+n&&(u=!u),h=n,c=i;return u}(this.polygonPoints,[t,e])):"circle"==this.shape&&(n=ot([this.outerCircleCenter.x,this.outerCircleCenter.y],[t,e])<this.outerCircleRadius),n},this.ajustAreaRange=function(){var e=this,n=1/0,i=-1/0,r=1/0,o=-1/0,s=this.padding;e.childs.forEach(function(t){t.visible&&(t.dragable=e.childDragable,n=Math.min(t.x-s,n),i=Math.max(t.cx+t.radius+s,i),r=Math.min(t.y-s,r),o=Math.max(t.cy+t.radius+s,o))}),e.outerCircleCenter={x:Math.round((i+n)/2),y:Math.round((o+r)/2)},e.outerCircleRadius=Math.round(Math.sqrt(Math.pow(i-n,2)+Math.pow(o-r,2),2)/2),e.x=n,e.y=r-(this.showHeader?e.headerHeight:0),e.width=Math.round(i-n),e.height=Math.round(o-r)+(this.showHeader?e.headerHeight:0)},this.initialize(t,e)}ct.prototype=new $,Object.defineProperties(ct.prototype,{cx:{get:function(){return Math.round(this.x+this.width/2)},set:function(t){this.x=Math.round(t-this.width/2)}},cy:{get:function(){return Math.round(this.y+this.height/2)},set:function(t){this.y=Math.round(t-this.height/2)}},radius:{get:function(){return Math.round(this.width/2)},set:function(t){this.width=this.height=2*t}},size:{get:function(){return Math.round(2*this.radius)},set:function(t){this.radius=Math.round(Math.round(t/2),2)}}}),ut.prototype=new ct,lt.prototype=new ut;function dt(t,e,n){return gt(t,e,n).length}function ft(t,e,n){return{bearing:e=Math.atan2(t.y-e.y,t.x-e.x),x:t.x-n*Math.cos(e),y:t.y-n*Math.sin(e)}}function pt(t,e,n,i,r,o,s,a){var h=Math.PI/2,c=Math.min(Math.sqrt(Math.pow(n-t,2)+Math.pow(i-e,2)),Math.sqrt(Math.pow(n-r,2)+Math.pow(i-o,2))),u=a,s=("TB"==s|"BT"==s?Math.abs(r-t)<a&&(u=Math.abs(r-t)):Math.abs(o-e)<a&&(u=Math.abs(o-e)),Math.min(u/2,c*Math.tan(h/2))),a=Math.abs(s/Math.tan(h/2)),u=(n-t)*(i-o)-(n-r)*(i-e)<0?1:0,c=ft({x:n,y:i},{x:t,y:e},a),h=ft({x:n,y:i},{x:r,y:o},a);return"L".concat(c.x," ").concat(c.y," A").concat(s," ").concat(s," 0 0 ").concat(u," ").concat(h.x," ").concat(h.y)}var gt=function(t,n,e){var i=[];return(t.outLinks||[]).forEach(function(e){(n.inLinks||[]).forEach(function(t){e===t&&i.push(t)})}),e&&(n.outLinks||[]).forEach(function(e){(t.inLinks||[]).forEach(function(t){e===t&&i.push(t)})}),i},yt=Math.PI/2,c=Math.PI,vt=2*Math.PI,mt=3*Math.PI,xt={font:"normal 13px Arial",fontColor:"120,120,120",lineWidth:2,lineJoin:"miter",lineCap:"butt",strokeColor:"120,120,120",selectedColor:"10,10,230",selectedAlpha:1,background:null,bundleOffset:20,bundleGap:20,groupNum:1,curveness:.5,arrowsRadius:5,lineType:"straight",showlabel:!0,showArrow:!0,arrowType:"triangle",labelBackGround:null,labelBorderWidth:0,labelBorderColor:"255,255,255",labelBorderRadius:0,lineDash:null,path:[],pathDefine:null,animate:!1,animateSpeed:5,animateBallIndex:1,animateBall:null,animateBallColor:"255,0,0",animateBallSize:5,lineDashOffset:0,multiControlPercent:.2,parallelType:"curve"};function wt(h,t,e){this.initialize=function(t,e,n){wt.prototype.initialize.apply(this,arguments),this.elementType="link",this.zIndex=O.Link_zIndex,this.label=n,this.source=t,this.target=e,this.source&&null==this.source.outLinks&&(this.source.outLinks=[]),this.source&&null==this.source.inLinks&&(this.source.inLinks=[]),this.target&&null==this.target.inLinks&&(this.target.inLinks=[]),this.target&&null==this.target.outLinks&&(this.target.outLinks=[]),null!=this.source&&this.source.outLinks.push(this),null!=this.target&&this.target.inLinks.push(this),this.linePointCache=null,this.pathDefine=null,this.arrowCache=null,this.textCache={text:null,width:0,height:0},Object.assign(this,xt),this.caculateIndex()},this.findInsertPoint=function(t,e){e=O.util.lineVir(t.cx,t.cy,e.cx,e.cy),t=t.getBound();return O.util.intersectionLineBound(e,t)},this.caculateIndex=function(){var t=dt(this.source,this.target,!1);0<t&&(this.nodeIndex=t-1)},this.removeHandler=function(){var e,n=this;this.source.outLinks=(this.source.outLinks||[]).filter(function(t){return t!==n}),this.target.inLinks=(this.target.inLinks||[]).filter(function(t){return t!==n}),gt((e=this).source,e.target).filter(function(t){return e!==t}).forEach(function(t,e){t.nodeIndex=e})},this.getStartPosition=function(){var t=this.findInsertPoint(this.source,this.target);return t=null==t?{x:this.source.cx,y:this.source.cy}:t},this.getEndPosition=function(){var t=this.findInsertPoint(this.target,this.source);return t=null==t?{x:this.target.cx,y:this.target.cy}:t},this.isInBound=function(t,e){var n,i=this.lineWidth;if(this.labelBackHeight&&(i=Math.round(this.labelBackHeight/2)),0<this.path.length){for(var r=!1,o=this.path,s=1;s<o.length;s++){var a=o[s-1],h=o[s];if(O.util.containStroke(a.x,a.y,h.x,h.y,i+2,t,e)){r=!0;break}}return r}return this.bezierPoints?(n=this.bezierPoints,O.util.containBerzierStroke(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],i,t,e)):!!this.quadraticPoints&&(n=this.quadraticPoints,O.util.containQuadraticStroke(n[0],n[1],n[2],n[3],n[4],n[5],i+2,t,e))},this.paint=function(t,e){"function"==typeof this.definedPaintFunc?this.definedPaintFunc(t,e):this.drawOriginalLine(t,e)},this.drawOriginalLine=function(t){if(this.source&&this.source.visible&&this.target&&this.target.visible){if("source"==this.colorType?this.strokeColor=this.source.fillColor:"target"==this.colorType&&(this.strokeColor=this.target.fillColor),this.source===this.target)this.lineType="curver";else if(this.groupNum=dt(this.target,this.source,!0),1<this.groupNum)return void("curve"==this.parallelType?this.paintMutilCurve(t):this.paintMutilLine(t));this.paintLine(t,e)}},this.paintLine=function(t,e){switch(this.lineType){case"direct":case"straight":this.paintDrirectLine(t,e);break;case"vlink":this.paintVerticalLink(t,e);break;case"hlink":this.paintHorizolLink(t,e);break;case"vcurve":this.paintVCurve(t,e);break;case"hcurve":this.paintHCurve(t,e);break;case"hvfold":this.paintHVFoldLink(t,e);break;case"vhfold":this.paintVHFoldLink(t,e);break;case"bezier":this.paintBezier(t,e);break;case"vbezier":this.paintVBezierLink(t,e);break;case"hbezier":this.paintHBezierLink(t,e);break;case"arrowline":this.paintArrowLine(t,e);break;case"curver":this.paintCurverLink(t,e);break;default:this.lineType="straight",this.paintDrirectLine(t,e)}},this.paintAnimateBall=function(t){var e,n,i,r,o,s,a=this.path;2==a.length&&(this.animateBallIndex=1),0<this.animateBallIndex&&this.animateBallIndex<a.length?(e=a[this.animateBallIndex-1].x,n=a[this.animateBallIndex-1].y,i=a[this.animateBallIndex].x,a=a[this.animateBallIndex].y,r=Math.atan2(a-n,i-e),null!=(s=this.animateBall)&&s.sx==e&&s.sy==n&&s.tx==i&&s.ty==a||(s=i-e,o=a-n,s=Math.sqrt(s*s+o*o)/this.animateSpeed,this.animateBall={x:e,y:n,sx:e,sy:n,tx:i,ty:a,angle:r,moves:s})):(this.animateBallIndex=0,this.animateBall=null),this.animateBall&&0<this.animateBall.moves?(this.animateBall.moves--,this.animateBall.x+=this.animateSpeed*Math.cos(this.animateBall.angle),this.animateBall.y+=this.animateSpeed*Math.sin(this.animateBall.angle),t.save(),t.beginPath(),t.fillStyle="rgba(".concat(this.animateBallColor,",").concat(this.alpha,")"),t.arc(this.animateBall.x,this.animateBall.y,this.animateBallSize,0,vt),t.fill(),t.restore(),this.animateBall.moves<=0&&(this.animateBall=null,this.animateBallIndex++)):this.animateBallIndex++},this.setLineStyle=function(t){var e;this.selected||this.showSelected?(t.strokeStyle="rgba(".concat(this.selectedColor,",").concat(this.selectedAlpha,")"),t.lineWidth=this.lineWidth+2):("both"==this.colorType?(e=t.createLinearGradient(this.source.cx,this.source.cy,this.target.cx,this.target.cy),this.source.fillColor&&e.addColorStop(0,"rgba(".concat(this.source.fillColor,",").concat(this.alpha,")")),this.target.fillColor&&e.addColorStop(1,"rgba(".concat(this.target.fillColor,",").concat(this.alpha,")")),t.strokeStyle=e):"source"==this.colorType?t.strokeStyle="rgba(".concat(this.source.fillColor,",").concat(this.alpha,")"):"target"==this.colorType?t.strokeStyle="rgba(".concat(this.target.fillColor,",").concat(this.alpha,")"):t.strokeStyle="rgba(".concat(this.strokeColor,",").concat(this.alpha,")"),t.lineWidth=this.lineWidth),this.lineDash&&1<this.lineDash.length&&(t.setLineDash(this.lineDash),this.animate)&&(t.lineDashOffset=--this.lineDashOffset,this.lineDashOffset=this.lineDashOffset<-100?1:this.lineDashOffset)},this.paintMutilCurve=function(t){this.bundleGap=60;var e={x:this.source.cx,y:this.source.cy},n={x:this.target.cx,y:this.target.cy},i=this.computeControlPoint(e,n,.49),r=i.startPoint,i=i.endPoint,o=null,s=(o="rect"==this.source.shape?(s=O.util.lineVir(r.x,r.y,this.source.cx,this.source.cy),O.util.intersectionLineBound(s,this.source.getBound())):(s=(this.source.radius+this.source.borderWidth/2)*this.source.scale,O.util.pointOnCircle(e.x,e.y,s,Math.atan2(r.y-e.y,r.x-e.x))),Math.atan2(i.y-n.y,i.x-n.x),n),a=n,h=(this.showArrow&&(s=this.calculateEndPoint({cx:i.x,cy:i.y},this.target),h=this.getArrowRadius(),a.x=s.x-h*Math.cos(s.angle),a.y=s.y-h*Math.sin(s.angle)),function(t){for(var e=[],n=0,i=t.length;n<i-2;n+=2){var r=[{x:+t[n-2],y:+t[n-1]},{x:+t[n],y:+t[n+1]},{x:+t[n+2],y:+t[n+3]},{x:+t[n+4],y:+t[n+5]}];i-4===n?r[3]=r[2]:n||(r[0]={x:+t[n],y:+t[n+1]}),e=[(-r[0].x+6*r[1].x+r[2].x)/6,(-r[0].y+6*r[1].y+r[2].y)/6,(r[1].x+6*r[2].x-r[3].x)/6,(r[1].y+6*r[2].y-r[3].y)/6,r[2].x,r[2].y]}return e}([o.x,o.y,r.x,r.y,i.x,i.y,a.x,a.y])),o=(this.path=[],this.bezierPoints=[o.x,o.y,h[0],h[1],h[2],h[3],a.x,a.y],this.pathDefine="M".concat(o.x," ").concat(o.y," C").concat(h[0]," ").concat(h[1]," ").concat(h[2]," ").concat(h[3]," ").concat(a.x," ").concat(a.y),h=O.util.getPointOnBezierCurve(.33,o.x,o.y,a.x,a.y,h[0],h[1],h[2],h[3]),r=n.x<e.x?Math.atan2(e.y-n.y,e.x-n.x):Math.atan2(n.y-e.y,n.x-e.x),this.arrowCache={start:{x:i.x,y:i.y},end:s,textMid:{x:h.x,y:h.y},angle:r},new Path2D(this.pathDefine));this.paintLineBackGround(t,o),t.save(),this.setLineStyle(t),t.stroke(o),t.restore(),this.showArrow&&this.paintSpecialArrow(t,this.arrowCache.start,this.arrowCache.end),this.animate&&(null==this.lineDash||this.lineDash.length<=1)&&(a=this.bezierPoints,this.paintBezierAnimate(t,a[0],a[1],a[6],a[7],a[2],a[3],a[4],a[5])),this.paintLineText(t,this.arrowCache.textMid.x,this.arrowCache.textMid.y,this.arrowCache.angle),this.paintLineTips(t,this.arrowCache.textMid)},this.paintMutilLine=function(t){this.bundleGap=25;var e={x:this.source.cx,y:this.source.cy},n={x:this.target.cx,y:this.target.cy},i=this.computeControlPoint(e,n,this.multiControlPercent),r=i.startPoint,i=i.endPoint,o=n;this.showArrow&&(o=this.calculateEndPoint({cx:i.x,cy:i.y},this.target),h=this.getArrowRadius(),n.x=o.x-h*Math.cos(o.angle),n.y=o.y-h*Math.sin(o.angle)),this.path=[{x:e.x,y:e.y},{x:r.x,y:r.y},{x:i.x,y:i.y},{x:o.x,y:o.y}];for(var s=["M".concat(e.x," ").concat(e.y," ")],a=1;a<this.path.length-1;a++)s.push("L".concat(this.path[a].x," ").concat(this.path[a].y," "));s.push("L".concat(n.x," ").concat(n.y)),this.pathDefine=s.join(),this.arrowCache={start:{x:i.x,y:i.y},end:o,textStart:{cx:r.x,cy:r.y},textEnd:{cx:i.x,cy:i.y}};var h=new Path2D(this.pathDefine);this.paintLineBackGround(t,h),t.save(),this.setLineStyle(t),t.stroke(h),t.restore(),this.showArrow&&this.paintSpecialArrow(t,this.arrowCache.start,this.arrowCache.end),this.animate&&(null==this.lineDash||this.lineDash.length<=1)&&this.paintAnimateBall(t),this.showlabel&&this.paintTextOnLineWithAngle(t,this.arrowCache.textStart,this.arrowCache.textEnd)},this.computeControlPoint=function(t,e,n){this.bundleOffset=O.util.getDistance(t,e)*n;var n=this.groupNum,i=Math.atan2(e.y-t.y,e.x-t.x),r=t.x+this.bundleOffset*Math.cos(i),t=t.y+this.bundleOffset*Math.sin(i),o=e.x+this.bundleOffset*Math.cos(i-c),e=e.y+this.bundleOffset*Math.sin(i-c),n=n*this.bundleGap/2-this.bundleGap/2,s=this.bundleGap*this.nodeIndex,a=(i-=yt,s*Math.cos(i)),s=s*Math.sin(i),h=Math.cos(i-c),i=Math.sin(i-c);return{startPoint:{x:r+a+n*h,y:t+s+n*i},endPoint:{x:o+a+n*h,y:e+s+n*i}}},this.paintCurverLink=function(t){this.checkNeedUpdate()&&(e=this.source.cx,n=this.source.cy,d=(i=this.target.cx)-e,c=(r=this.target.cy)-n,l=e<i?1:-1,o={},s={},a=0,this.path=[],u=null,u=(this.source===this.target?(h=this.source.radius/2*this.source.scale||20,this.showArrow=!1,o=O.util.getSelfLoopControlPoints(e,n,h+10*this.nodeIndex),s=O.util.getPointOnBezierCurve(.5,e,n,i,r,o.x1,o.y1,o.x2,o.y2),a=Math.atan2(1,1),this.animate=!1,this.bezierPoints=[e,n,o.x1,o.y1,o.x2,o.y2,i,r],"M".concat(e," ").concat(n," C").concat(o.x1," ").concat(o.y1," ").concat(o.x2," ").concat(o.y2," ")):(o=O.util.getQuadraticControlPoint(e,n,i,r,4,this.curveness),s=O.util.getPointOnQuadraticCurve(.5,e,n,i,r,o.x,o.y),a=Math.atan2(c*l,d*l),this.quadraticPoints=[e,n,o.x,o.y,i,r],"M".concat(e," ").concat(n," Q").concat(o.x," ").concat(o.y," "))).concat(i," ").concat(r),this.pathDefine=u,this.showArrow&&(h=O.util.getPointOnQuadraticCurve(.5,e,n,i,r,o.x,o.y),c=O.util.getPointOnQuadraticCurve(.52,e,n,i,r,o.x,o.y),this.arrowCache={start:{x:h.x,y:h.y},end:{x:c.x,y:c.y}}),this.control={x:s.x,y:s.y,angle:a});var e,n,i,r,o,s,a,h,c,u,l,d=new Path2D(this.pathDefine);this.paintLineBackGround(t,d),this.setLineStyle(t),t.stroke(d),this.animate&&(null==this.lineDash||this.lineDash.length<=1)&&(l=this.quadraticPoints,this.paintCurverAnimate(t,l[0],l[1],l[4],l[5],l[2],l[3])),this.showArrow&&this.paintSpecialArrow(t,this.arrowCache.start,this.arrowCache.end),this.paintLineText(t,this.control.x,this.control.y,this.control.angle),this.paintLineTips(t,{x:this.control.x,y:this.control.y})},this.paintCurverAnimate=function(t,e,n,i,r,o,s){this.animateBall&&this.animateBall.moves<1?(this.animateBall.moves+=.01,e=O.util.getPointOnQuadraticCurve(this.animateBall.moves,e,n,i,r,o,s),t.save(),t.beginPath(),t.fillStyle="rgba(".concat(this.animateBallColor,",").concat(this.alpha,")"),t.arc(e.x,e.y,this.animateBallSize,0,vt),t.fill(),t.restore()):this.animateBall={moves:0}},this.paintArrowLine=function(t){var e=(e=this.lineWidth)<4?4:e,n={x:this.target.cx,y:this.target.cy},i=(this.showArrow&&(n=this.calculateEndPoint(this.source,this.target)),this.source.cx),r=this.source.cy,o=n.x,s=n.y;this.reverse&&(i=n.x,r=n.y,o=this.source.cx,s=this.source.cy),this.path=[{x:i,y:r},{x:o,y:s}],t.save(),t.beginPath(),this.showArrow?t.paintCustomArrow(i,r,o,s,[-3*e,e,-4*e,3*e+1]):t.paintCustomArrow(i,r,o,s,[0,e]),t.lineJoin="round","both"==this.colorType?((n=t.createLinearGradient(this.source.cx,this.source.cy,this.target.cx,this.target.cy)).addColorStop(0,"rgba(".concat(this.source.fillColor,",").concat(this.alpha,")")),n.addColorStop(1,"rgba(".concat(this.target.fillColor,",").concat(this.alpha,")")),t.fillStyle=n):t.fillStyle="rgba(".concat(this.strokeColor,",").concat(this.alpha,")"),(this.selected||this.showSelected)&&(t.fillStyle="rgba(".concat(this.selectedColor,",").concat(this.selectedAlpha,")")),t.fill(),t.restore(),this.paintTextOnLineWithAngle(t,this.source,this.target)},this.checkNeedUpdate=function(){return(null==this.linePointCache||this.linePointCache.source.x!=this.source.x||this.linePointCache.source.y!=this.source.y||this.linePointCache.target.x!=this.target.x||this.linePointCache.target.y!=this.target.y||this.lineType!=this.linePointCache.lineType)&&(this.linePointCache={source:{x:this.source.x,y:this.source.y},target:{x:this.target.x,y:this.target.y},lineType:this.lineType},!0)},this.paintDrirectLine=function(t){this.checkNeedUpdate()&&(r=this.target.cx,o=this.target.cy,this.arrowCache=null,this.showArrow&&(n=(e=this.calculateEndPoint(this.source,this.target)).x,i=e.y,r=n-(s=this.getArrowRadius())*Math.cos(e.angle),o=i-s*Math.sin(e.angle),this.arrowCache={start:{x:this.source.cx,y:this.source.cy},end:{x:n,y:i}}),this.path=[{x:this.source.cx,y:this.source.cy},{x:this.target.cx,y:this.target.cy}],this.pathDefine="M".concat(this.source.cx," ").concat(this.source.cy," L").concat(r," ").concat(o));var e,n,i,r,o,s=new Path2D(this.pathDefine);this.paintLineBackGround(t,s),this.setLineStyle(t),t.stroke(s),this.showArrow&&this.paintSpecialArrow(t,this.arrowCache.start,this.arrowCache.end),this.animate&&(null==this.lineDash||this.lineDash.length<=1)&&this.paintAnimateBall(t),this.paintTextOnLineWithAngle(t,this.source,this.target)},this.paintTextOnLineWithAngle=function(t,e,n){var i={x:(n.cx+e.cx)/2,y:(n.cy+e.cy)/2};this.showlabel&&this.label&&(n=Math.atan2(n.cy-e.cy,n.cx-e.cx),yt<n&&(n-=c),n<-yt&&(n+=c),this.paintLineText(t,i.x,i.y,n)),this.paintLineTips(t,{x:i.x,y:i.y})},this.paintLineTips=function(t,e){var n,i,r;!this.hideText&&this.tipText&&(r=this.tipRadius||0,t.save(),t.font=this.tipFont||"normal 13px Arial",n=t.measureText(this.tipText).width+12,r=(i=t.measureText("田").width+12-2)/2<r?i/2:r,t.translate(e.x-n/2,e.y-i-6),t.beginPath(),t.arc(n-r,i-r,r,0,yt),t.lineTo(n/2+4,i),t.lineTo(n/2,6+i),t.lineTo(n/2-4,i),t.lineTo(r,i),t.arc(r,i-r,r,yt,c),t.lineTo(0,r),t.arc(r,r,r,c,mt/2),t.lineTo(n-r,0),t.arc(n-r,r,r,mt/2,vt),t.lineTo(n,i-r),t.closePath(),t.fillStyle="rgba(".concat(this.tipColor||"250,50,50",",").concat(this.alpha,")"),t.fill(),t.translate(n/2,i/2),t.textBaseline="middle",t.textAlign="center",t.fillStyle="rgba(".concat(this.tipFontColor||"250,250,250",",").concat(this.alpha,")"),t.fillText(this.tipText,0,0),t.restore())},this.calculateEndPoint=function(t,e){var n,i,r=0,o=0,s=e.cx,a=e.cy;return"rect"==this.target.shape?(s=(n=this.getEndPosition()).x,a=n.y,r=Math.atan2(a-t.cy,s-t.cx)):(n=e.cx,i=e.cy,o=-(e.radius+e.borderWidth/2)*e.scale,r=Math.atan2(i-t.cy,n-t.cx),s=n+o*Math.cos(r),a=i+o*Math.sin(r)),{x:Math.round(s),y:Math.round(a),angle:r}},this.getArrowRadius=function(){var t=3;return"dot"!=this.arrowType&&"box"!=this.arrowType||(t=2),t=this.selected||this.showSelected?Math.round(t*(this.lineWidth+1)):Math.round(t*this.lineWidth),Math.min(Math.max(t,3),80)},this.getTargetBorderPoint=function(){var t,e=0;return this.showArrow&&(e=(t=this.target).radius,e="rect"==t.shape?-1!=["vbezier","vlink"].indexOf(this.lineType)?(t.height/2+t.borderWidth/2)*t.scale:(t.width/2+t.borderWidth/2)*t.scale:(t.radius+t.borderWidth/2)*t.scale),e},this.paintSpecialArrow=function(t,e,n){var i=this.getArrowRadius(),r=Math.atan((n.x-e.x)/(n.y-e.y));switch(t.save(),t.translate(n.x,n.y),0<=n.y-e.y?t.rotate(-r):t.rotate(c-r),this.selected||this.showSelected?t.fillStyle="rgba(".concat(this.selectedColor,",").concat(this.selectedAlpha,")"):t.fillStyle="rgba(".concat(this.strokeColor,",").concat(this.alpha,")"),t.beginPath(),this.arrowType){case"arrow":var o="M0 0 L".concat(.6*-i," ").concat(1.5*-i," L0 ").concat(-i," L").concat(.6*i," ").concat(1.5*-i," Z");t.fill(new Path2D(o));break;case"dot":t.arc(0,-i,i,0,2*c),t.fill();break;case"box":t.fillRect(-i,-2*i,2*i,2*i);break;default:t.fill(new Path2D("M0 0 L".concat(-i/2," ").concat(1.2*-i," L").concat(i/2," ").concat(1.2*-i," Z")))}t.restore()},this.paintVerticalLink=function(t){if(this.checkNeedUpdate()){var e=this.source.y+this.source.height,n=this.target.y,i=this.showArrow?this.getArrowRadius():0;e>n+this.target.height&&(e=this.source.y,n=this.target.y+this.target.height,i=-i),this.path=[{x:this.source.cx,y:e},{x:this.source.cx,y:(e+n)/2},{x:this.target.cx,y:(e+n)/2},{x:this.target.cx,y:n-i}];for(var r=["M".concat(this.path[0].x," ").concat(this.path[0].y," ")],o=1;o<this.path.length;o++)r.push("L".concat(this.path[o].x," ").concat(this.path[o].y," "));this.pathDefine=r.join(),this.arrowCache={start:{x:this.target.cx,y:(e+n)/2},end:{x:this.target.cx,y:n},midPos:{x:this.target.cx,y:((e+n)/2+n)/2}}}i=new Path2D(this.pathDefine);this.paintLineBackGround(t,i),this.setLineStyle(t),t.stroke(i),this.showArrow&&this.paintSpecialArrow(t,this.arrowCache.start,this.arrowCache.end),this.animate&&(null==this.lineDash||this.lineDash.length<=1)&&this.paintAnimateBall(t),this.paintLineText(t,this.arrowCache.midPos.x,this.arrowCache.midPos.y),this.paintLineTips(t,this.arrowCache.midPos)},this.paintVCurve=function(t){this.checkNeedUpdate()&&(e=this.source.y+this.source.height,n=this.target.y,i=this.showArrow?this.getArrowRadius():0,e>n+this.target.height&&(e=this.source.y,n=this.target.y+this.target.height,i=-i),r=this.target.cx-this.source.cx<0?-1:1,o=(i=n-i)-e<0?-1:1,s=Math.abs(this.target.cx-this.source.cx)/2<30?Math.abs(this.target.cx-this.source.cx)/2:30,s=Math.abs(i-e)/2<s?Math.abs(i-e)/2:s,a=Math.abs(i-e)/2-s,c=Math.abs(this.target.cx-this.source.cx)-2*s,h=e+a*o+s*o,this.pathDefine=" M ".concat(this.source.cx," ").concat(e,"\n                                L ").concat(this.source.cx," ").concat(e+a*o,"\n                                C  ").concat(this.source.cx," ").concat(h," ").concat(this.source.cx," ").concat(h," ").concat(this.source.cx+s*r," ").concat(h,"\n                                L ").concat(this.source.cx+c*r+s*r," ").concat(h,"\n                                C  ").concat(this.target.cx," ").concat(h," ").concat(this.target.cx,"  ").concat(h," ").concat(this.target.cx," ").concat(i-a*o,"\n                                L ").concat(this.target.cx," ").concat(i),this.path=[{x:this.source.cx,y:e},{x:this.source.cx,y:h},{x:this.target.cx,y:h},{x:this.target.cx,y:i}],this.arrowCache={start:{x:this.target.cx,y:(e+n)/2},end:{x:this.target.cx,y:n},midPos:{x:this.target.cx,y:((e+n)/2+n)/2}});var e,n,i,r,o,s,a,h,c=new Path2D(this.pathDefine);this.paintLineBackGround(t,c),this.setLineStyle(t),t.stroke(c),this.showArrow&&this.paintSpecialArrow(t,this.arrowCache.start,this.arrowCache.end),this.paintLineText(t,this.arrowCache.midPos.x,this.arrowCache.midPos.y)},this.paintHCurve=function(t){this.checkNeedUpdate()&&(e=this.source.x+this.source.width,n=this.target.x,i=this.showArrow?this.getArrowRadius():0,e>n+this.target.width&&(e=this.source.x,n=this.target.x+this.target.width,i=-i),r=(i=n-i)-e<0?-1:1,o=this.target.cy-this.source.cy<0?-1:1,h=Math.abs(i-e)/2<30?Math.abs(i-e)/2:30,h=Math.abs(this.target.cy-this.source.cy)/2<h?Math.abs(this.target.cy-this.source.cy)/2:h,a=e+(s=Math.abs(i-e)/2-h)*r+h*r,this.pathDefine="M ".concat(e," ").concat(this.source.cy,"\n                                L ").concat(e+s*r," ").concat(this.source.cy,"\n                                C ").concat(a," ").concat(this.source.cy," \n                                ").concat(a," ").concat(this.source.cy," \n                                ").concat(a," ").concat(this.source.cy+h*o,"\n                                L ").concat(a," ").concat(this.target.cy-h*o," \n                                C ").concat(a,"  ").concat(this.target.cy," \n                                ").concat(a,"  ").concat(this.target.cy," \n                                ").concat(i-s*r,"  ").concat(this.target.cy,"\n                                L ").concat(i," ").concat(this.target.cy),this.path=[{x:e,y:this.source.cy},{x:a,y:this.source.cy},{x:a,y:this.target.cy},{x:i,y:this.target.cy}],this.arrowCache={start:{x:(e+n)/2,y:this.target.cy},end:{x:n,y:this.target.cy},midPos:{x:((e+n)/2+n)/2,y:this.target.cy}});var e,n,i,r,o,s,a,h=new Path2D(this.pathDefine);this.paintLineBackGround(t,h),this.setLineStyle(t),t.stroke(h),this.showArrow&&this.paintSpecialArrow(t,this.arrowCache.start,this.arrowCache.end),this.paintLineText(t,this.arrowCache.midPos.x,this.arrowCache.midPos.y)},this.paintHorizolLink=function(t){if(this.checkNeedUpdate()){var e=this.source.x+this.source.width,n=this.target.x,i=this.showArrow?this.getArrowRadius():0;e>n+this.target.width&&(e=this.source.x,n=this.target.x+this.target.width,i=-i),this.path=[{x:e,y:this.source.cy},{x:(e+n)/2,y:this.source.cy},{x:(e+n)/2,y:this.target.cy},{x:n-i,y:this.target.cy}];for(var r=["M".concat(this.path[0].x," ").concat(this.path[0].y," ")],o=1;o<this.path.length;o++)r.push("L".concat(this.path[o].x," ").concat(this.path[o].y," "));this.pathDefine=r.join(),this.arrowCache={start:{x:(e+n)/2,y:this.target.cy},end:{x:n,y:this.target.cy},midPos:{x:((e+n)/2+n)/2,y:this.target.cy}}}i=new Path2D(this.pathDefine);this.paintLineBackGround(t,i),this.setLineStyle(t),t.stroke(i),this.showArrow&&this.paintSpecialArrow(t,this.arrowCache.start,this.arrowCache.end),this.animate&&(null==this.lineDash||this.lineDash.length<=1)&&this.paintAnimateBall(t),this.paintLineText(t,this.arrowCache.midPos.x,this.arrowCache.midPos.y),this.paintLineTips(t,this.arrowCache.midPos)},this.paintHVFoldLink=function(t){this.checkNeedUpdate()&&(e=this.source,s=this.target,(i=r=e.cx)<(n=s.cx)?i=e.x+e.width:n<r&&(i=e.x),r=s.cy,o=0,e.cy<s.cy?(r=s.y,this.showArrow&&(o=3*-this.lineWidth)):e.cy>s.cy&&(r=s.y+s.height,this.showArrow)&&(o=3*this.lineWidth),this.path=[{x:i,y:e.cy},{x:n,y:e.cy},{x:n,y:r}],this.pathDefine="M".concat(i," ").concat(e.cy," L").concat(n," ").concat(e.cy," L").concat(n," ").concat(r+o),this.arrowCache={start:{x:n,y:e.cy},end:{x:n,y:r},textPos:{x:n,y:(e.cy+r)/2}});var e,n,i,r,o,s=new Path2D(this.pathDefine);this.paintLineBackGround(t,s),this.setLineStyle(t),t.stroke(s),this.showArrow&&this.paintSpecialArrow(t,this.arrowCache.start,this.arrowCache.end),this.paintLineText(t,this.arrowCache.textPos.x,this.arrowCache.textPos.y,0)},this.paintVHFoldLink=function(t){this.checkNeedUpdate()&&(e=this.source,n=this.target,r=e.cy,i=n.cy,o=e.cy,r<i?o=e.y+e.height:i<r&&(o=e.y),i=n.cx,r=0,e.cx<n.cx?(i=n.x,this.showArrow&&(r=3*-this.lineWidth)):e.cx>n.cx&&(i=n.x+n.width,this.showArrow)&&(r=3*this.lineWidth),this.path=[{x:e.cx,y:o},{x:e.cx,y:n.cy},{x:i,y:n.cy}],this.pathDefine="M".concat(e.cx," ").concat(o," L").concat(e.cx," ").concat(n.cy," L").concat(i+r," ").concat(n.cy),this.arrowCache={start:{x:e.cx,y:n.cy},end:{x:i,y:n.cy},textPos:{x:(e.cx+i)/2,y:n.cy}});var e,n,i,r,o=new Path2D(this.pathDefine);this.paintLineBackGround(t,o),this.setLineStyle(t),t.stroke(o),this.showArrow&&this.paintSpecialArrow(t,this.arrowCache.start,this.arrowCache.end),this.paintLineText(t,this.arrowCache.textPos.x,this.arrowCache.textPos.y,0)},this.paintLineBackGround=function(t,e){this.background&&(t.save(),t.lineCap="round",t.lineJoin="round",t.strokeStyle="rgba(".concat(this.background,",").concat(.9*this.alpha,")"),t.lineWidth=3*(this.lineWidth+2),t.stroke(e),t.restore())},this.paintBezier=function(t){var e=O.util.calculateAngle(this.source.cx,this.source.cy,this.target.cx,this.target.cy);0<=e&&e<=45||135<=e&&e<=225||315<=e&&e<=360?this.paintVBezierLink(t):this.paintHBezierLink(t)},this.paintHBezierLink=function(t){this.checkNeedUpdate()&&(e=this.showArrow?this.getArrowRadius():0,(a=this.source.x+this.source.width)>(n=this.target.x)+this.target.width&&(a=this.source.x,n=this.target.x+this.target.width,e=-e),i=(a+n)*this.curveness,r=this.source.cy,o=(a+n)*this.curveness,s=this.target.cy,this.path=[],this.bezierPoints=[a,this.source.cy,i,r,o,s,n,this.target.cy],this.pathDefine="M".concat(a," ").concat(this.source.cy," C").concat(i," ").concat(r," ").concat(o," ").concat(s," ").concat(n-e," ").concat(this.target.cy),this.arrowCache={start:{x:n-e,y:this.target.cy},end:{x:n,y:this.target.cy}});var e,n,i,r,o,s,a=new Path2D(this.pathDefine);this.paintLineBackGround(t,a),this.setLineStyle(t),t.stroke(a),this.showArrow&&this.paintSpecialArrow(t,this.arrowCache.start,this.arrowCache.end),this.animate&&(null==this.lineDash||this.lineDash.length<=1)&&this.paintBezierAnimate(t,this.bezierPoints[0],this.bezierPoints[1],this.bezierPoints[6],this.bezierPoints[7],this.bezierPoints[2],this.bezierPoints[3],this.bezierPoints[4],this.bezierPoints[5]),this.paintBezierText(t,this.bezierPoints[0],this.bezierPoints[1],this.bezierPoints[6],this.bezierPoints[7],this.bezierPoints[2],this.bezierPoints[3],this.bezierPoints[4],this.bezierPoints[5])},this.paintVBezierLink=function(t){this.checkNeedUpdate()&&(e=this.showArrow?this.getArrowRadius():0,(a=this.source.y+h.height)>(n=this.target.y)+this.target.height&&(a=this.source.y,n=this.target.y+this.target.height,e=-e),i=this.source.cx,r=(a+n)*this.curveness,o=this.target.cx,s=(a+n)*this.curveness,this.path=[],this.bezierPoints=[this.source.cx,a,i,r,o,s,this.target.cx,n],this.pathDefine="M".concat(this.source.cx," ").concat(a," C").concat(i," ").concat(r," ").concat(o," ").concat(s," ").concat(this.target.cx," ").concat(n-e),this.arrowCache={start:{x:this.target.cx,y:n-e},end:{x:this.target.cx,y:n}});var e,n,i,r,o,s,a=new Path2D(this.pathDefine);this.paintLineBackGround(t,a),this.setLineStyle(t),t.stroke(a),this.showArrow&&this.paintSpecialArrow(t,this.arrowCache.start,this.arrowCache.end),this.paintBezierText(t,this.bezierPoints[0],this.bezierPoints[1],this.bezierPoints[6],this.bezierPoints[7],this.bezierPoints[2],this.bezierPoints[3],this.bezierPoints[4],this.bezierPoints[5]),this.animate&&(null==this.lineDash||this.lineDash.length<=1)&&this.paintBezierAnimate(t,this.bezierPoints[0],this.bezierPoints[1],this.bezierPoints[6],this.bezierPoints[7],this.bezierPoints[2],this.bezierPoints[3],this.bezierPoints[4],this.bezierPoints[5])},this.paintBezierAnimate=function(t,e,n,i,r,o,s,a,h){this.animateBall&&this.animateBall.moves<1?(this.animateBall.moves+=.02,e=O.util.getPointOnBezierCurve(this.animateBall.moves,e,n,i,r,o,s,a,h),t.save(),t.beginPath(),t.arc(e.x,e.y,this.animateBallSize,0,2*c),t.fillStyle="rgba(".concat(this.animateBallColor,",").concat(this.alpha,")"),t.fill(),t.restore()):this.animateBall={moves:0}},this.paintBezierText=function(t,e,n,i,r,o,s,a,h){var c,u=null;this.showlabel&&this.label&&(u=O.util.getPointOnBezierCurve(.5,e,n,i,r,o,s,a,h),"curver"==this.lineType?(c=0<a-o?-1:1,c=Math.atan2((a-o)*c,(h-s)*-c)+yt,this.paintLineText(t,u.x,u.y,c)):this.paintLineText(t,u.x,u.y)),this.tipText&&(null==u&&O.util.getPointOnBezierCurve(.5,e,n,i,r,o,s,a,h),this.paintLineTips(t,{x:u.x,y:u.y}))},this.paintLineText=function(t,e,n,i){if(!this.showlabel||!this.label||this.hideText)return!1;var r="bottom";null!=this.tipText&&(r="top"),t.save(),t.translate(e,n),t.rotate(i||0),t.font=this.font,this.labelBackGround&&(r="middle",this.computeTextWidth(t),e=this.textCache.width,n=this.textCache.height,t.DGraphRoundRect(-e/2,-n/2,e,n,this.labelBorderRadius),t.fillStyle="rgba(".concat(this.labelBackGround,",").concat(this.alpha,")"),t.fill()),t.textAlign="center",t.textBaseline=r,t.fillStyle="rgba(".concat(this.fontColor,",").concat(this.alpha,")"),t.fillText(this.label,0,1),t.restore()},this.computeTextWidth=function(t){var e;this.textCache.text!=this.label&&(e=t.measureText(this.label).width+6,t=t.measureText("国").width+3,this.labelBackHeight=t,this.textCache.text=this.label,this.textCache.width=e,this.textCache.height=t)},this.initialize(h,t,e)}wt.prototype=new ut;var bt={label:null,type:"default",shape:"circle",font:"normal 13px Arial",fontColor:"20,20,20",borderWidth:0,borderColor:"120,120,230",borderAlpha:1,selectedBorderColor:"120,120,230",selectedBorderWidth:6,borderRadius:0,shadowColor:"110,110,230",shadowBlur:10,dragable:!0,textPosition:"Middle_Center",textOffsetX:0,textOffsetY:0,transformAble:!0,inLinks:null,outLinks:null,labelBackGround:null,labelBorderWidth:0,labelBorderColor:"255,255,255",fillStyle:null,strokeStyle:null,textLines:[],showlabel:!0,nodeWrapText:!1,headTipText:null,headTipFont:"normal 13px YaHei",headTipFontColor:"250,250,250",headTipRadius:0,padding:0,tags:null,tagColor:"230,30,30"};function kt(){this.initialize=function(){kt.prototype.initialize.apply(this,arguments),this.elementType="node",this.nodeType="inner",this.zIndex=O.Node_zIndex,Object.assign(this,bt),this.icon=null,this.imageOffsetX=0,this.imageOffsetY=0,this.padding=0,this.textCache={sigleWidth:0,maxWidth:0,lineCount:0,font:null}},this.initialize(),this.drawNodeImg=function(t,e,n,i,r){var o;e&&e.width&&(o=this.padding/2,"rect"==this.shape||"square"==this.shape?t.drawImage(e,n+this.imageOffsetX+o,i+this.imageOffsetY+o,this.width-this.padding,this.height-this.padding):(r=2<r?r:2)<e.width/2?(this.paintShape(t),t.clip(),t.drawImage(e,n+this.imageOffsetX+o,i+this.imageOffsetY+o,this.width-this.padding,this.height-this.padding)):t.drawImage(e,-e.width/2+o,-e.height/2+o,e.width-this.padding,e.height-this.padding))},this.paint=function(t,e){"function"==typeof this.definedPaintFunc?this.definedPaintFunc(t,e):this.drawOriginalNode(t,e)},this.drawOriginalNode=function(t,e){var n;this.drawShape(t,e),this.image&&!e&&(n=t.globalAlpha,t.save(),t.globalAlpha=this.alpha,this.drawNodeImg(t,this.image,-this.width/2,-this.height/2,this.width/2),t.globalAlpha=n,t.restore()),e||this.hideText||(this.paintText(t),this.paintHeadTip(t),this.paintNodeTags(t))},this.drawShape=function(t,e){t.save(),t.beginPath(),this.paintShape(t),e?this.fillStyle?(t.fillStyle=this.fillStyle,t.fill()):this.fillColor?(t.fillStyle="rgba(".concat(this.fillColor,",").concat(this.alpha,")"),t.fill()):(t.lineWidth=this.borderWidth,t.strokeStyle="rgba(".concat(this.borderColor,",").concat(this.alpha,")"),t.stroke()):((this.fillColor||e)&&(this.paintShadow(t),t.fillStyle=this.fillStyle||"rgba(".concat(this.fillColor,",").concat(this.alpha,")"),t.fill()),this.lineDash&&1<this.lineDash.length&&t.setLineDash(this.lineDash),this.showSelected||this.selected?0<this.selectedBorderWidth&&(t.lineWidth=this.selectedBorderWidth,t.strokeStyle="rgba(".concat(this.selectedBorderColor,",").concat(this.alpha,")"),t.stroke()):0<this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.strokeStyle||"rgba(".concat(this.borderColor,",").concat(this.alpha,")"),t.stroke())),t.restore()},this.paintShape=function(t){switch(this.shape){case"rect":var e,n,i,r,o,s;this.borderRadius?(e=this.width,n=this.height,i=Math.PI/180,r=this.borderRadius,t.moveTo((o=-e/2)+(r=n-2*(r=e-2*r<0?e/2:r)<0?n/2:r),s=-n/2),t.lineTo(o+e-r,s),t.arc(o+e-r,s+r,r,270*i,360*i,!1),t.lineTo(o+e,s+n-r),t.arc(o+e-r,s+n-r,r,0,90*i,!1),t.lineTo(o+r,s+n),t.arc(o+r,s+n-r,r,90*i,180*i,!1),t.lineTo(o,s+r),t.arc(o+r,s+r,r,180*i,270*i,!1),t.closePath()):t.rect(-this.width/2,-this.height/2,this.width,this.height);break;case"square":t.rect(-this.radius,-this.radius,2*this.radius,2*this.radius);break;case"star":t.moveTo(0,-this.radius);for(var a=0;a<5;a++)t.rotate(Math.PI/5),t.lineTo(0,-.4*this.radius),t.rotate(Math.PI/5),t.lineTo(0,-this.radius);t.closePath();break;case"polygon":for(var h=2*Math.PI/6,a=0;a<6;a++)o=Math.cos(a*h),s=Math.sin(a*h),t.lineTo(o*this.radius,s*this.radius);t.closePath();break;case"circle":this.radius=this.radius<2?2:this.radius,t.arc(0,0,this.radius,0,2*Math.PI,!1);break;default:this.radius=this.radius<2?2:this.radius,t.arc(0,0,this.radius,0,2*Math.PI,!0)}},this.paintText=function(n){if(this.showlabel&&(s=this.label)){n.save(),n.font=this.font;var t,i=0;if(n.fillStyle="rgba(".concat(this.fontColor,",").concat(this.alpha,")"),1==this.nodeWrapText){var i=n.measureText("田").width,r=this.buildTextArray(s),o=0;n.textAlign="center",r.forEach(function(t,e){t=String(t),o=Math.max(o,n.measureText(t.replace(/ /g,"田")).width),n.fillText(t,0,-i/2*r.length+(e+1)*i)}),this.width=o+8<this.width?this.width:o+8}else{this.processLabel(n),i=this.textCache.sigleWidth;var e=this.textLines.length,s=e*i;if(this.labelBackGround&&(t=this.getTextPostion(this.textPosition,this.textCache.maxWidth,i),n.save(),n.lineWidth=1,n.strokeStyle="rgba(".concat(this.labelBorderColor,",").concat(this.alpha,")"),n.fillStyle="rgba(".concat(this.labelBackGround,",").concat(this.alpha,")"),n.DGraphRoundRect(t.x-5,t.y-1.45*i,this.textCache.maxWidth+10,s+i+(1==e?0:4),5),n.stroke(),n.fill(),n.restore()),0<this.labelBorderWidth&&(n.lineWidth=this.labelBorderWidth,n.strokeStyle="rgba(".concat(this.labelBorderColor,",").concat(this.alpha,")"),n.lineJoin="round",n.lineCap="round"),1==e)t=this.getTextPostion(this.textPosition,this.textCache.maxWidth,i),0<this.labelBorderWidth&&n.strokeText(this.textLines[0],t.x,t.y),n.fillText(this.textLines[0],t.x,t.y-1);else for(var a=0;a<e;a++)t=this.getTextPostion(this.textPosition,n.measureText(this.textLines[a]).width,i),0<this.labelBorderWidth&&n.strokeText(this.textLines[a],t.x,t.y+a*i+(0==a?0:2*a)),n.fillText(this.textLines[a],t.x,t.y-1+a*i+(0==a?0:2*a))}n.restore()}},this.paintNodeTags=function(n){var i,r,o,s,a;Array.isArray(this.tags)&&(i=this,o=r=0,s=Math.PI/6,a=i.radius+4,this.tags.forEach(function(t,e){r=a*Math.sin(-s*(e+1)+Math.PI),o=a*Math.cos(-s*(e+1)+Math.PI),i.paintTagText(n,t,{x:r,y:o})}))},this.paintTagText=function(t,e,n){t.save(),t.beginPath(),t.arc(n.x,n.y,8,0,2*Math.PI),t.fillStyle="rgba(".concat(this.tagColor||"230,30,30",",").concat(this.alpha,")"),t.fill(),t.lineWidth=1,t.strokeStyle="rgba(250,250,250,".concat(this.alpha,")"),t.stroke(),t.font="normal 8px Arial",t.fillStyle="rgba(250,250,250,".concat(this.alpha,")"),t.textAlign="center",t.textBaseline="middle",t.fillText(e.substr(0,1),n.x,n.y),t.restore()},this.processLabel=function(t){if(this.textLines=String(this.label).split("\n"),0==this.textCache.sigleWidth||this.textCache.lineCount!=this.textLines.length||this.textCache.font!=this.font)if(this.textCache.sigleWidth=t.measureText("田").width,this.textCache.font=this.font,this.textCache.lineCount=this.textLines.length,1==this.textLines.length)this.textCache.maxWidth=t.measureText(this.textLines[0]).width;else for(var e=0;e<this.textLines.length;e++)this.textCache.maxWidth=Math.max(t.measureText(this.textLines[e]).width,this.textCache.maxWidth)},this.buildTextArray=function(t){var e=String(t).length,n=[];return e<5?n.push(t):5<=e&&e<=9?(n.push(t.substring(0,4)),n.push(t.substring(4))):9<e&&e<=13?(n.push(t.substring(0,4)),n.push(t.substring(4,9)),n.push(t.substring(9))):(n.push(t.substring(0,4)),n.push(t.substring(4,9)),n.push(t.substring(9,12)+"..")),n},this.paintShadow=function(t){this.showShadow&&this.selected&&(t.shadowBlur=this.shadowBlur,t.shadowColor="rgba(".concat(this.shadowColor,",").concat(.9*this.alpha,")"),t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY)},this.paintHeadTip=function(t){var e,n,i;this.headTipText&&(i=this.headTipRadius||0,t.save(),t.font=this.headTipFont||"normal 13px Arial",e=t.measureText(this.headTipText).width+16,i=(n=t.measureText("田").width+16-2)/2<i?n/2:i,t.translate(-e/2,-n-this.height/2-6),t.beginPath(),t.arc(e-i,n-i,i,0,Math.PI/2),t.lineTo(e/2+4,n),t.lineTo(e/2,6+n),t.lineTo(e/2-4,n),t.lineTo(i,n),t.arc(i,n-i,i,Math.PI/2,Math.PI),t.lineTo(0,i),t.arc(i,i,i,Math.PI,3*Math.PI/2),t.lineTo(e-i,0),t.arc(e-i,i,i,3*Math.PI/2,2*Math.PI),t.lineTo(e,n-i),t.closePath(),t.fillStyle="rgba(".concat(this.headTipColor||"250,50,50",",").concat(this.alpha,")"),t.fill(),t.translate(e/2,n/2),t.textBaseline="middle",t.textAlign="center",t.fillStyle="rgba(".concat(this.headTipFontColor||"250,250,250",",").concat(this.alpha,")"),t.fillText(this.headTipText,0,0),t.restore())},this.getTextPostion=function(t,e,n){var i=null;return null==t||"Bottom_Center"==t?i={x:-this.width/2+(this.width-e)/2,y:this.height/2+n}:"Top_Center"==t?i={x:-this.width/2+(this.width-e)/2,y:-this.height/2-n/2}:"Top_Right"==t?i={x:this.width/2,y:-this.height/2-n/2}:"Top_Left"==t?i={x:-this.width/2-e,y:-this.height/2-n/2}:"Bottom_Right"==t?i={x:this.width/2,y:this.height/2+n}:"Bottom_Left"==t?i={x:-this.width/2-e,y:this.height/2+n}:"Middle_Center"==t?i={x:-this.width/2+(this.width-e)/2,y:n/2}:"Middle_Right"==t?i={x:this.width/2,y:n/2}:"Middle_Left"==t&&(i={x:-this.width/2-e,y:n/2}),null==i&&(i={x:-this.width/2+(this.width-e)/2,y:this.height/2+n}),null!=this.textOffsetX&&(i.x+=this.textOffsetX),null!=this.textOffsetY&&(i.y+=this.textOffsetY),i},this.setImage=function(t,e){var n,i,r;t&&(n=this,null==(i=O.imgStore[t])?"string"==typeof t?((r=new Image).setAttribute("crossOrigin","Anonymous"),r.src=t,r.onload=function(){n.image=r,"function"==typeof e&&e()},O.imgStore[t]=r):(this.image=t,this.setSize(t.width,t.height)):n.image=i)},this.removeHandler=function(e){var n=this;this.outLinks&&(this.outLinks.forEach(function(t){t.source===n&&e.remove(t)}),this.outLinks=null),this.inLinks&&(this.inLinks.forEach(function(t){t.target===n&&e.remove(t)}),this.inLinks=null)}}function Mt(t){this.initialize=function(t){Mt.prototype.initialize.apply(this,arguments),this.elementType="node",this.nodeType="custome",this.zIndex=O.Node_zIndex,Object.assign(this,bt),this.icon=null,this.imageOffsetX=0,this.imageOffsetY=0,this.padding=0,this.customeTemplate=t||[],this.needCheckElements=((null==(t=this.customeTemplate)?void 0:t.elements)||[]).filter(function(t){return!!t.isInBound})},this.initialize(t),this.paint=function(n,t){var i;this.drawOriginalNode(n,t),t||(t=(null==(t=this.customeTemplate)?void 0:t.elements)||[],i=this,t.forEach(function(t){var e=t.type,t=t.attrs;n.save(),i.drawNodeElement(n,e,t,i),n.restore()}))},this.drawNodeElement=function(t,e,n,i){switch(e){case"circle":case"rect":t.beginPath(),"circle"==e?t.arc(n.x,n.y,n.radius,0,2*Math.PI,!1):t.rect(n.x,n.y,n.width,n.height),n.fillColor&&("function"==typeof n.fillColor?t.fillStyle=n.fillColor(i)||"#fff":t.fillStyle=n.fillColor,t.fill()),n.borderWidth&&(t.lineWidth=n.borderWidth,t.strokeStyle=n.borderColor||"#fff",t.stroke());break;case"line":t.beginPath(),t.moveTo(n.x1,n.y1),t.lineTo(n.x2,n.y2),t.lineWidth=n.lineWidth||1,t.strokeStyle=n.color||"#fff",t.stroke();break;case"text":t.font=n.font||"13px Arial",t.fillStyle=n.color||"#444",t.textAlign=n.textAlign||"center",t.textBaseline=n.textBaseline||"middle","function"==typeof n.content?t.fillText(n.content(i)||" ",n.x,n.y):t.fillText(n.content||" ",n.x,n.y);break;case"image":(r="function"==typeof n.imageUrl?n.imageUrl(i):n.imageUrl)&&(r=i.getElementImage(r))&&t.drawImage(r,n.x,n.y,n.width,n.height);break;case"defined":var r=n.drawFunction;"function"==typeof r&&r(t,i)}},this.drawNodeImg=function(t,e,n,i,r){var o;e&&e.width&&(o=this.padding/2,"rect"==this.shape?t.drawImage(e,n+this.imageOffsetX+o,i+this.imageOffsetY+o,this.width-this.padding,this.height-this.padding):(r=2<r?r:2)<e.width/2?(this.paintShape(t),t.clip(),t.drawImage(e,n+this.imageOffsetX+o,i+this.imageOffsetY+o,this.width-this.padding,this.height-this.padding)):t.drawImage(e,-e.width/2+o,-e.height/2+o,e.width-this.padding,e.height-this.padding))},this.drawOriginalNode=function(t,e){this.drawShape(t,e),this.image&&!e&&(e=t.globalAlpha,t.save(),t.globalAlpha=this.alpha,this.drawNodeImg(t,this.image,-this.width/2,-this.height/2,this.width/2),t.globalAlpha=e,t.restore())},this.drawShape=function(t,e){t.save(),t.beginPath(),this.paintShape(t),e?this.fillStyle?(t.fillStyle=this.fillStyle,t.fill()):this.fillColor?(t.fillStyle="rgba(".concat(this.fillColor,",").concat(this.alpha,")"),t.fill()):(t.lineWidth=this.borderWidth,t.strokeStyle="rgba(".concat(this.borderColor,",").concat(this.alpha,")"),t.stroke()):((this.fillColor||e)&&(this.paintShadow(t),t.fillStyle=this.fillStyle||"rgba(".concat(this.fillColor,",").concat(this.alpha,")"),t.fill()),this.lineDash&&1<this.lineDash.length&&t.setLineDash(this.lineDash),this.showSelected||this.selected?0<this.selectedBorderWidth&&(t.lineWidth=this.selectedBorderWidth,t.strokeStyle="rgba(".concat(this.selectedBorderColor,",").concat(this.alpha,")"),t.stroke()):0<this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.strokeStyle||"rgba(".concat(this.borderColor,",").concat(this.alpha,")"),t.stroke())),t.restore()},this.paintShape=function(t){switch(this.shape){case"rect":this.borderRadius?t.DGraphRoundRect(-this.width/2,-this.height/2,this.width,this.height,this.borderRadius):t.rect(-this.width/2,-this.height/2,this.width,this.height);break;case"circle":this.radius=this.radius<2?2:this.radius,t.arc(0,0,this.radius,0,2*Math.PI,!1);break;default:this.radius=this.radius<2?2:this.radius,t.rect(-this.radius,-this.radius,2*this.radius,2*this.radius)}},this.paintShadow=function(t){this.showShadow&&this.selected&&(t.shadowBlur=this.shadowBlur,t.shadowColor="rgba(".concat(this.shadowColor,",").concat(.9*this.alpha,")"),t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY)},this.getElementImage=function(t){var e,n,i;if(t)return null!=(e=O.imgStore[t])?e:(n=this,"string"==typeof t&&((i=new Image).setAttribute("crossOrigin","Anonymous"),i.src=t,i.onload=function(){O.imgStore[t]=i,n.drawFinished()}),null)},this.setImage=function(t,e){var n,i,r;t&&(n=this,null==(i=O.imgStore[t])?"string"==typeof t?((r=new Image).setAttribute("crossOrigin","Anonymous"),r.src=t,r.onload=function(){n.image=r,"function"==typeof e&&e()},O.imgStore[t]=r):(this.image=t,this.setSize(t.width,t.height)):n.image=i)},this.drawFinished=function(){},this.isInBound=function(t,e){for(var n,i,r,o,s,a,h=0;h<this.needCheckElements.length;h++)if(this.needCheckElements[h].isInBound(this,t,e))return!0;return"rect"==this.shape?(n=this.width*this.scale,i=this.height*this.scale,0==this.rotate?t>this.cx-n/2&&t<this.cx+n/2&&e>this.cy-i/2&&e<this.cy+i/2:(a=this.cx,r=this.cy,o=-this.rotate*Math.PI/180,s=(t-a)*Math.cos(o)-(e-r)*Math.sin(o)+a,a=(t-a)*Math.sin(o)+(e-r)*Math.cos(o)+r,s>this.cx-n/2&&s<this.cx+n/2&&a>this.cy-i/2&&a<this.cy+i/2)):(t-this.cx)*(t-this.cx)+(e-this.cy)*(e-this.cy)<this.radius*this.scale*this.radius*this.scale},this.removeHandler=function(e){var n=this;this.outLinks&&(this.outLinks.forEach(function(t){t.source===n&&e.remove(t)}),this.outLinks=null),this.inLinks&&(this.inLinks.forEach(function(t){t.target===n&&e.remove(t)}),this.inLinks=null)}}function Et(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e,this.center=[1e3,600],this.alpha=.99,this.friction=.8,this.linkDistance=120,this.linkStrength=.03,this.charge=-300,this.gravity=.01,this.theta=.9,this.distances=[],this.strengths=[],this.charges=[],this.noverlap=!1,this.inited=!1,this.finished=!1,this.getConfig=function(){return[{label:"斥力",friction:.8},{label:"边长度",linkDistance:120},{label:"边强度",linkStrength:.03},{label:"引力",charge:-300},{label:"重力",gravity:.01},{label:"避免重叠",noverlap:[{label:"否",value:"false"},{label:"是",value:"true"}]}]},this.addData=function(t,e){this.nodes=t,this.links=e},this.resetConfig=function(t){t&&(this.friction=Number(t.friction)||.8,this.linkDistance=Number(t.linkDistance)||120,this.linkStrength=Number(t.linkStrength)||.03,this.charge=Number(t.charge)||-300,this.gravity=Number(t.gravity)||.01,this.noverlap=Boolean(t.noverlap)||!1,this.center=t.center||[1e3,600]),this.init()},this.excute=function(){if(this.inited)for(var t=0;t++<3;)this.tick()},this.init=function(){var t,e,n=this.nodes.length,i=this.links.length;for(this.charges=[],t=0;t<n;++t)(e=this.nodes[t]).index=t,e.weight=0,e.px=e.x,e.py=e.y,this.charges[t]=this.charge;for(t=0;t<i;++t){var r=(e=this.links[t]).source,o=e.target;this.distances[t]=this.linkDistance,this.strengths[t]=this.linkStrength,++r.weight,++o.weight}this.inited=!0},this.alpha1=function(t){return arguments.length?(this.alpha?this.alpha=0<t?t:0:0<t&&this.tick(),this):this.alpha},this.resume=function(){return this.alpha1(.8)},this.stop=function(){return this.alpha1(0)},this.tick=function(){var u=this;if((u.alpha*=.99)<.001)u.alpha=.01,u.finished=!0;else{for(var t,e,n,i,r,o,s,a,h=u.nodes.length,c=u.links.length,l=0;l<c;++l)n=(e=u.links[l]).source,(r=(s=(i=e.target).x-n.x)*s+(a=i.y-n.y)*a)&&(s*=r=u.alpha*u.strengths[l]*((r=Math.sqrt(r))-u.distances[l])/r,a*=r,i.x-=s*(o=n.weight/(i.weight+n.weight)),i.y-=a*o,n.x+=s*(o=1-o),n.y+=a*o);if((o=u.alpha*u.gravity)&&(s=u.center[0],a=u.center[1],l=-1,o))for(;++l<h;)(e=u.nodes[l]).x+=(s-e.x)*o,e.y+=(a-e.y)*o;if(u.charge)for(u.forceAccumulate(t=u.quadtree(u.nodes),u.alpha,u.charges),l=-1;++l<h;)(e=u.nodes[l]).fixed||t.visit(function(c){return function(t,e,n,i,r){if(t.point!==c){var o,s=t.cx-c.x,a=t.cy-c.y,h=1/Math.sqrt(s*s+a*a);if((i-e)*h<u.theta)return o=t.charge*h*h,c.px-=s*o,c.py-=a*o,!0;t.point&&isFinite(h)&&(o=t.pointCharge*h*h,c.px-=s*o,c.py-=a*o)}return!t.charge}}(e));for(l=-1;++l<h;)(e=u.nodes[l]).fixed?(e.x=e.px,e.y=e.py):(e.x-=(e.px-(e.px=e.x))*u.friction,e.y-=(e.py-(e.py=e.y))*u.friction,u.noverlap&&t.visit(function(c){var u=c.radius+20,l=c.x-u,d=c.x+u,f=c.y-u,p=c.y+u;return function(t,e,n,i,r){var o,s,a,h;return t.point&&t.point!==c&&(o=c.x-t.point.x,s=c.y-t.point.y,0==o&&0==s&&(c.x=c.x+Math.round(10*Math.random()),c.y=c.y+Math.round(10*Math.random()),o=c.x-t.point.x,s=c.y-t.point.y),(a=Math.sqrt(o*o+s*s))<(h=u+t.point.radius))&&(c.x-=o*=a=(a-h)/a*.5,c.y-=s*=a,t.point.x+=o,t.point.y+=s),d<e||i<l||p<n||r<f}}(e)))}},this.forceAccumulate=function(t,e,n){var i,r=0,o=0;if(t.charge=0,!t.leaf)for(var s,a=t.nodes,h=a.length,c=-1;++c<h;)null!=(s=a[c])&&(this.forceAccumulate(s,e,n),t.charge+=s.charge,r+=s.charge*s.cx,o+=s.charge*s.cy);t.point&&(t.leaf||(t.point.x+=Math.random(),t.point.y+=Math.random()),i=this.alpha*this.charges[t.point.index],t.charge+=t.pointCharge=i,r+=i*t.point.x,o+=i*t.point.y),t.cx=r/t.charge,t.cy=o/t.charge},this.quadtree=function(t){var e,n=-1,i=t.length;i&&isNaN(t[0].x)&&(t=t.map(function(t){return{x:t[0],y:t[1]}}));for(var r=1/0,o=1/0,s=-1/0,a=-1/0;++n<i;)(e=t[n]).x<r&&(r=e.x),e.y<o&&(o=e.y),e.x>s&&(s=e.x),e.y>a&&(a=e.y);var h=s-r,c=a-o;function l(t,e,n,i,r,o){var s;isNaN(e.x)||isNaN(e.y)||(t.leaf?(s=t.point)?(Math.abs(s.x-e.x)+Math.abs(s.y-e.y)<.1||(t.point=null,u(t,s,n,i,r,o)),u(t,e,n,i,r,o)):t.point=e:u(t,e,n,i,r,o))}function u(t,e,n,i,r,o){var s=.5*(n+r),a=.5*(i+o),h=e.x>=s,c=e.y>=a,u=(c<<1)+h;t.leaf=!1,h?n=s:r=s,c?i=a:o=a,l(t=t.nodes[u]||(t.nodes[u]={leaf:!0,nodes:[],point:null}),e,n,i,r,o)}c<h?a=o+h:s=r+c;var d={leaf:!0,nodes:[],point:null,add:function(t){l(d,t,r,o,s,a)},visit:function(t){!function t(e,n,i,r,o,s){var a,h;e(n,i,r,o,s)||(a=.5*(i+o),h=.5*(r+s),(n=n.nodes)[0]&&t(e,n[0],i,r,a,h),n[1]&&t(e,n[1],a,r,o,h),n[2]&&t(e,n[2],i,h,a,s),n[3]&&t(e,n[3],a,h,o,s))}(t,d,r,o,s,a)}};return t.forEach(d.add),d}}function Ct(){this.nodes=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],this.maxPadding=10,this.inited=!1,this.maxIterations=0,this.finished=!1,this.excute=function(){this.inited&&this.run()},this.getConfig=function(){return[{label:"间距",maxPadding:this.maxPadding}]},this.resetConfig=function(t){t&&(this.maxPadding=Number(t.maxPadding)||5,this.maxPadding<0)&&(this.maxPadding=0),this.init()},this.addData=function(){this.nodes=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]},this.init=function(){this.inited=!0,this.maxIterations=0},this.run=function(){var t,e,n=this;n.inited&&(t=n.nodes.length/2,n.maxIterations++<t?(e=n.quadtree(n.nodes),n.nodes.forEach(function(t){var c,u,l,d,f,p;e.visit((u=(c=t).radius*c.scale*2+n.maxPadding,l=c.x-u,d=c.x+u,f=c.y-u,p=c.y+u,function(t,e,n,i,r){var o,s,a,h;return t.point&&t.point!==c&&(o=c.x-t.point.x,s=c.y-t.point.y,0==o&&0==s&&(c.x=c.x+Math.round(10*Math.random()),c.y=c.y+Math.round(10*Math.random()),o=c.x-t.point.x,s=c.y-t.point.y),(a=Math.sqrt(o*o+s*s))<(h=u+t.point.radius))&&(c.x-=o*=a=(a-h)/a*.5,c.y-=s*=a,t.point.x+=o,t.point.y+=s),d<e||i<l||p<n||r<f}))})):n.finished=!0)},this.quadtree=function(t){var e,n=-1,i=t.length;i&&isNaN(t[0].x)&&(t=t.map(function(t){return{x:t[0],y:t[1]}}));for(var r=1/0,o=1/0,s=-1/0,a=-1/0;++n<i;)(e=t[n]).x<r&&(r=e.x),e.y<o&&(o=e.y),e.x>s&&(s=e.x),e.y>a&&(a=e.y);var h=s-r,c=a-o;function l(t,e,n,i,r,o){var s;isNaN(e.x)||isNaN(e.y)||(t.leaf?(s=t.point)?(Math.abs(s.x-e.x)+Math.abs(s.y-e.y)<.01||(t.point=null,u(t,s,n,i,r,o)),u(t,e,n,i,r,o)):t.point=e:u(t,e,n,i,r,o))}function u(t,e,n,i,r,o){var s=.5*(n+r),a=.5*(i+o),h=e.x>=s,c=e.y>=a,u=(c<<1)+h;t.leaf=!1,h?n=s:r=s,c?i=a:o=a,l(t=t.nodes[u]||(t.nodes[u]={leaf:!0,nodes:[],point:null}),e,n,i,r,o)}c<h?a=o+h:s=r+c;var d={leaf:!0,nodes:[],point:null,add:function(t){l(d,t,r,o,s,a)},visit:function(t){!function t(e,n,i,r,o,s){var a,h;e(n,i,r,o,s)||(a=.5*(i+o),h=.5*(r+s),(n=n.nodes)[0]&&t(e,n[0],i,r,a,h),n[1]&&t(e,n[1],a,r,o,h),n[2]&&t(e,n[2],i,h,a,s),n[3]&&t(e,n[3],a,h,o,s))}(t,d,r,o,s,a)}};return t.forEach(d.add),d}}function Nt(){this.nodes=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],this.defaults={center:[0,0],startAngle:Math.PI,clockwise:!0,equidistant:!1,avoidOverlap:!0,minNodeSpacing:10,maxNodeSize:70,levelWidth:1},this.boolTransition=!0,this.intSteps=50,this.inited=!1,this.finished=!1,this.finishedCount=0,this.getConfig=function(){return[{label:"节点大小",maxNodeSize:70},{label:"分层系数",levelWidth:1}]},this.resetConfig=function(t){t&&(this.defaults.maxNodeSize=Number(t.maxNodeSize)||70,this.defaults.levelWidth=Number(t.levelWidth)||1,this.defaults.center=t.center||[0,0]),this.init()},this.addData=function(){this.nodes=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]},this.excute=function(){this.inited&&this.run()},this.init=function(){for(var t=this.defaults,e=this.nodes,n={x1:this.defaults.center[0],y1:this.defaults.center[1],w:5*t.maxNodeSize,h:5*t.maxNodeSize},i=n.x1,r=n.y1,o=[],s=0;s<e.length;s++){var a=e[s],h=(a.inLinks||[]).length+(a.outLinks||[]).length;o.push({value:h,node:a})}o.sort(function(t,e){return e.value-t.value});for(var c=t.levelWidth,u=[[]],l=u[0],d=0;d<o.length;d++){var f=o[d];0<l.length&&Math.abs(l[0].value-f.value)>=c&&u.push(l=[]),l.push(f)}var p,g=t.maxNodeSize+t.minNodeSpacing;t.avoidOverlap&&(p=0<u.length&&1<u[0].length,n=(Math.min(n.w,n.h)/2-g)/(u.length+p?1:0),g=Math.min(g,n));for(var y=0,v=0;v<u.length;v++){var m,x=u[v],w=2*Math.PI-2*Math.PI/x.length,w=x.dTheta=w/Math.max(1,x.length-1);1<x.length&&t.avoidOverlap&&(m=Math.cos(w)-Math.cos(0),w=Math.sin(w)-Math.sin(0),m=Math.sqrt(g*g/(m*m+w*w)),y=Math.max(m,y)),x.r=y,y+=g}if(t.equidistant){for(var b=0,k=0,M=0;M<u.length;M++)var E=u[M].r-k,b=Math.max(b,E);for(var k=0,C=0;C<u.length;C++){var N=u[C];0===C&&(k=N.r),N.r=k,k+=b}}for(var L=0;L<u.length;L++)for(var S=u[L],_=S.dTheta,T=S.r,P=0;P<S.length;P++){var O=S[P],A=t.startAngle+(this.clockwise?1:-1)*_*P,I=i+T*Math.cos(A),A=r+T*Math.sin(A),D=this.newLayoutData();D.finishx=I,D.finishy=A,D.xdistance=1/this.intSteps*(I-O.node.x),D.ydistance=1/this.intSteps*(A-O.node.y),O.node.layoutData=D}this.inited=!0,this.finishedCount=0},this.newLayoutData=function(){return{finishx:0,finishy:0,xdistance:0,ydistance:0}},this.run=function(){for(var t,e=this.nodes,n=e.length,i=0;i<n;i++){var r,o=e[i];null!=(t=o.layoutData)&&(this.boolTransition?(r=Math.abs(o.x-t.finishx),Math.abs(o.x+t.xdistance-t.finishx)<r?o.x+=t.xdistance:o.x=t.finishx,r=Math.abs(o.y-t.finishy),Math.abs(o.y+t.ydistance-t.finishy)<r?o.y+=t.ydistance:o.y=t.finishy,o.x==t.finishx&&o.y==t.finishy&&(o.layoutData=null,this.finishedCount++)):(o.x=t.finishx,o.y=t.finishy,o.layoutData=null,this.finishedCount++))}this.finished=this.finishedCount>=n}}function Lt(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e,this.center=[0,0],this.layerSpace=160,this.nodeSpace=80,this.treeSpacing=60,this.direction="UD",this.sortType="selected",this.treeIndex=-1,this.continueOrBreak=0,this.boolTransition=!0,this.inited=!1,this.finished=!1,this.finishedCount=0,this.noverlap=!1,this.avoidFinished=!1,this.minNodeMargin=10,this.getConfig=function(){return[{label:"层间距",layerSpace:160},{label:"点间距",nodeSpace:80},{label:"排列方式",sortType:[{label:"连线方向",value:"directed"},{label:"度大小",value:"hubsize"},{label:"指定点",value:"selected"}]},{label:"排列方向",direction:[{label:"上下",value:"UD"},{label:"下上",value:"DU"},{label:"左右",value:"LR"},{label:"右左",value:"RL"}]},{label:"避免重叠",noverlap:[{label:"否",value:"false"},{label:"是",value:"true"}]},{label:"最小点间距",minNodeMargin:10}]},this.addData=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e},this.resetConfig=function(t){t&&(this.layerSpace=Number(t.layerSpace)||160,this.nodeSpace=Number(t.nodeSpace)||80,this.sortType=t.sortType||"directed",this.direction=t.direction||"UD",this.noverlap=Boolean(t.noverlap)||!1,this.minNodeMargin=Number(t.minNodeMargin)||10,this.center=t.center||[0,0]),this.init()},this.newLayoutData=function(){return{finishx:0,finishy:0,xdistance:0,ydistance:0}},this.init=function(){var r=this,o=(r.treeIndex=-1,r.continueOrBreak=0,r.nodeIdList=[],r.selectedNodeIds=null,r.positionedNodes={},r.hierarchicalLevels={},r.hierarchicalTrees={},r.lastNodeOnLevel={},r.hierarchicalChildrenReference={},r.distributionIndex={},r.distributionOrdering={},r.distributionOrderingPresence={},r.nodesIdMap={},r.edges={},r.definedLevels={},r.setData(),r.setupHierarchicalLayout(),r.computeCenter());r.nodes.forEach(function(t){var e=String(t.id),n=r.nodesIdMap[e],e=(t.treeLevel=r.hierarchicalLevels[e],0),i=0,i="DU"==r.direction?(e=n.x,-n.y):(e="RL"==r.direction?-n.x:n.x,n.y),n=(e+=o.x,i+=o.y,r.newLayoutData());n.finishx=e,n.finishy=i,n.xdistance=.02*(e-t.x),n.ydistance=.02*(i-t.y),t.layoutData=n}),r.inited=!0,this.finishedCount=0},this.computeCenter=function(){var e=this,n=1/0,i=-1/0,r=1/0,o=-1/0;return e.nodeIdList.forEach(function(t){t=e.nodesIdMap[t];r=Math.min(r,t.x),o=Math.max(o,t.x),n=Math.min(n,t.y),i=Math.max(i,t.y)}),{x:e.center[0]-(o-r)/2,y:e.center[1]-(i-n)/2}},this.setData=function(){var i=this,r=[];i.nodes.forEach(function(t){var e=String(t.id),n=i.NodeLocal(e);i.nodesIdMap[e]=n,i.nodeIdList.push(e),t.definedLevel&&(i.definedLevels[e]=t.definedLevel),1==t.selected&&r.push(e)}),i.links.forEach(function(t,e){var e=String(e+1),t=i.Edge(t.source.id,t.target.id,e),n=(i.edges[e]=t).fromId,t=t.toId,n=i.nodesIdMap[n],n=(-1==n.edgesIds.indexOf(e)&&n.edgesIds.push(e),i.nodesIdMap[t]);-1==n.edgesIds.indexOf(e)&&n.edgesIds.push(e)}),"selected"==i.sortType&&(i.selectedNodeIds=r)},this.setupHierarchicalLayout=function(){var e=this,t=("hubsize"==e.sortType?e.determineLevelsByHubsize():"selected"==e.sortType?e.determineLevelsBySelected():(e.sortType="directed",e.determineLevelsByDirected()),e.nodeIdList.forEach(function(t){null==e.hierarchicalLevels[t]&&(e.hierarchicalLevels[t]=0),null!=e.definedLevels[t]&&(e.hierarchicalLevels[t]=Math.max(e.definedLevels[t]-1,0))}),e.getDistribution());e.crawlNetwork("generateMap",-1),e.placeNodesByHierarchy(t),e.condenseHierarchy()},this.determineLevelsByDirected=function(){var e=this,n=(e.crawlNetwork("determineLevelsByDirected",-1),1/0);e.nodeIdList.forEach(function(t){null!=e.hierarchicalLevels[t]&&(n=Math.min(e.hierarchicalLevels[t],n))}),e.nodeIdList.forEach(function(t){null!=e.hierarchicalLevels[t]&&(e.hierarchicalLevels[t]=e.hierarchicalLevels[t]-n)})},this.determineLevelsBySelected=function(){var e=this;null!=e.selectedNodeIds&&(e.selectedNodeIds.forEach(function(t){e.hierarchicalLevels[t]=0}),e.selectedNodeIds.forEach(function(t){null!=e.nodesIdMap[t]&&e.crawlNetwork("determineLevelsByHubsize",t)})),e.determineLevelsByHubsize()},this.NodeLocal=function(t){return{id:t,edgesIds:[],x:.5,y:.5}},this.Edge=function(t,e,n){return{id:n,fromId:t,toId:e}},this.determineLevelsByHubsize=function(){for(var e=this,n=1;0<n;){var i=0;if(e.nodeIdList.forEach(function(t){t=e.nodesIdMap[t];null==e.hierarchicalLevels[t.id]&&(i=t.edgesIds.length<=i?i:t.edgesIds.length)}),0==(n=i))return;e.nodeIdList.forEach(function(t){t=e.nodesIdMap[t];t.edgesIds.length==n&&e.crawlNetwork("determineLevelsByHubsize",t.id)})}},this.condenseHierarchy=function(){for(var t,e,n=1/0,i=-1/0,r=0;r<this.treeIndex;r++){for(var o in this.hierarchicalTrees)0==r&&this.hierarchicalTrees[o]==r&&(e=this.getPositionForHierarchy(this.nodesIdMap[o])),this.hierarchicalTrees[o]==r+1&&(e=this.getPositionForHierarchy(this.nodesIdMap[o]),n=Math.min(e,n),i=Math.max(e,i));for(var o in this.hierarchicalTrees)this.hierarchicalTrees[o]==r+1&&(t=this.nodesIdMap[o],e=this.getPositionForHierarchy(t),this.setPositionForHierarchy(t,e+0+this.treeSpacing,-1));this.treeSpacing,this.treeSpacing}},this.shiftToCenter=function(){var n=this,i=1/0,e=-1/0,r=1/0,o=-1/0,t=(n.nodeIdList.forEach(function(t){t=n.nodesIdMap[t];r=Math.min(r,t.x),o=Math.max(o,t.x),i=Math.min(i,t.y),e=Math.max(e,t.y)}),o-r),s=e-i,a=1,h=1;5e3<t&&(a=5e3/t),3e3<s&&(h=3e3/s),n.nodeIdList.forEach(function(t){var t=n.nodesIdMap[t],e=t.x,e=(t.x=Math.round((e-r)*a),t.y);t.y=Math.round((e-i)*h)})},this.getDistribution=function(){var i=this,r={};return i.nodeIdList.forEach(function(t){var e=i.nodesIdMap[t],t=null==i.hierarchicalLevels[t]?1:i.hierarchicalLevels[t],n=("UD"==i.direction||"DU"==i.direction?e.y=i.layerSpace*t:e.x=i.layerSpace*t,r[t]);(n=null==n?[]:n).push(e),r[t]=n}),r},this.crawlNetwork=function(n,t){var i,r=this,o={};-1==t?(i=0,r.nodeIdList.forEach(function(t){var e=r.nodesIdMap[t];null==o[t]&&(o=r.crawler(o,e,n,i)),i++})):(t=r.nodesIdMap[t],o=r.crawler(o,t,n,-111))},this.crawler=function(t,e,n,i){if(null==t[e.id]){-111!=i&&null==this.hierarchicalTrees[e.id]&&(this.hierarchicalTrees[e.id]=i,this.treeIndex=Math.max(i,this.treeIndex)),t[e.id]=!0;for(var r=e.edgesIds.length,o=0;o<r;o++){var s=e.edgesIds[o],s=this.edges[s];null!=(s=s.toId==e.id?this.nodesIdMap[s.fromId]:this.nodesIdMap[s.toId])&&e.id!=s.id&&("determineLevelsByHubsize"==n?this.levelDownstream(e,s):"determineLevelsByDirected"==n?this.levelByDirection(e,s):"generateMap"==n&&this.fillInRelations(e,s),this.crawler(t,s,n,i))}}return t},this.levelDownstream=function(t,e){null==this.hierarchicalLevels[e.id]&&(null==this.hierarchicalLevels[t.id]&&(this.hierarchicalLevels[t.id]=0),this.hierarchicalLevels[e.id]=this.hierarchicalLevels[t.id]+1)},this.levelByDirection=function(t,e){null==this.hierarchicalLevels[t.id]&&(this.hierarchicalLevels[t.id]=1),null==this.hierarchicalLevels[e.id]&&(this.hierarchicalLevels[e.id]=this.hierarchicalLevels[t.id]+1)},this.fillInRelations=function(t,e){this.hierarchicalLevels[e.id]>this.hierarchicalLevels[t.id]&&(null==this.hierarchicalChildrenReference[t.id]&&(this.hierarchicalChildrenReference[t.id]=[]),this.hierarchicalChildrenReference[t.id].push(e.id))},this.placeNodesByHierarchy=function(t){for(var e in t)for(var n=t[e],i=0,r=n.length,o=0;o<r;o++){var s,a=n[o];null==this.positionedNodes[a.id]&&(s=this.nodeSpace*i,0<i&&(s=this.getPositionForHierarchy(n[o-1])+this.nodeSpace),this.setPositionForHierarchy(a,s,e),this.validataPositionAndContinue(a,e,s),i++)}},this.getPositionForHierarchy=function(t){return"UD"==this.direction||"DU"==this.direction?t.x:t.y},this.setPositionForHierarchy=function(t,e,n){-1!=n&&(null==this.distributionOrdering[n]&&(this.distributionOrdering[n]=[],this.distributionOrderingPresence[n]={}),null==this.distributionOrderingPresence[n][t.id]&&(this.distributionOrdering[n].push(t),this.distributionIndex[t.id]=this.distributionOrdering[n].length-1),this.distributionOrderingPresence[n][t.id]=!0),"UD"==this.direction||"DU"==this.direction?t.x=e:t.y=e},this.shiftBlock=function(t,e){"UD"==this.direction||"DU"==this.direction?this.nodesIdMap[t].x+=e:this.nodesIdMap[t].y+=e},this.placeBranchNodes=function(t,e){if(null!=this.hierarchicalChildrenReference[t.id]){for(var n=[],i=this.hierarchicalChildrenReference[t.id].length,r=0;r<i;r++)n.push(this.nodesIdMap[this.hierarchicalChildrenReference[t.id][r]]);for(var o=n.length,r=0;r<o;r++){var s,a=n[r],h=this.hierarchicalLevels[a.id];e<h&&null==this.positionedNodes[a.id]&&(s=(s=0)==r?this.getPositionForHierarchy(this.nodesIdMap[t.id]):this.getPositionForHierarchy(n[r-1])+this.nodeSpace,this.setPositionForHierarchy(a,s,h),this.validataPositionAndContinue(a,h,s))}var c=1/0,u=-1/0;for(r=0;r<o;r++)a=n[r],c=Math.min(c,this.getPositionForHierarchy(a)),u=Math.max(u,this.getPositionForHierarchy(a));this.setPositionForHierarchy(t,(c+u)/2,e)}},this.validataPositionAndContinue=function(t,e,n){var i;null!=this.lastNodeOnLevel[e]&&n-(i=this.getPositionForHierarchy(this.nodesIdMap[this.lastNodeOnLevel[e]]))<this.nodeSpace&&(i=i+this.nodeSpace-n,this.shiftBlock(t.id,i)),this.lastNodeOnLevel[e]=t.id,this.positionedNodes[t.id]=!0,this.placeBranchNodes(t,e)},this.excute=function(){this.inited&&this.run()},this.run=function(){for(var t,e=this.nodes,n=e.length,i=0;i<n;i++){var r,o=e[i];null!=(t=o.layoutData)&&(this.boolTransition?(r=Math.abs(o.x-t.finishx),Math.abs(o.x+t.xdistance-t.finishx)<r?o.x+=t.xdistance:o.x=t.finishx,r=Math.abs(o.y-t.finishy),Math.abs(o.y+t.ydistance-t.finishy)<r?o.y+=t.ydistance:o.y=t.finishy,o.x==t.finishx&&o.y==t.finishy&&(o.layoutData=null,this.finishedCount++)):(o.x=t.finishx,o.y=t.finishy,o.layoutData=null,this.finishedCount++))}this.finished=this.finishedCount>=n,this.noverlap&&this.finished&&!this.avoidFinished&&(this.avoidOverLap(),this.avoidFinished=!0)},this.avoidOverLap=function(){var t,i={},e=(this.nodes.forEach(function(t){var e=t.treeLevel,n=i[e];null!=n?n.push(t):i[e]=[t]}),this.nodes.length),n=this.minNodeMargin,r=-1!=["LR","RL"].indexOf(this.direction)?"y":"x";for(t in i){var o=i[t];1<o.length&&(e<=100?function t(e,n){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:10;e.sort(function(t,e){return t[n]>=e[n]?1:-1});for(var r=0;r<e.length-1;r++)for(var o=e[r],s=r+1;s<e.length;s++){var a=e[s],h=Math.abs(a[n]-o[n]);h<=o.radius+a.radius+i&&(e[r][n]-=i,e[s][n]+=i,t(e,n,i))}}:function(t,n){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:10;t.sort(function(t,e){return t[n]>=e[n]?1:-1});for(var i=0;i<t.length-1;i++){var r=t[i],o=t[i+1],s=Math.abs(o[n]-r[n]),a=r.radius;if(s<a+o.radius+e)for(var h=i+1;h<t.length;h++)Math.abs(t[h][n]-t[h-1][n])<=t[h-1].radius+t[h].radius+e&&(t[h][n]+=t[h].radius+a+e)}})(o,r,n)}}}function St(){this.nodes=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],this.nodeSpace=120,this.layerSpace=120,this.center=[100,100],this.splitType=2,this.boolTransition=!0,this.intSteps=50,this.inited=!1,this.finished=!1,this.finishedCount=0,this.getConfig=function(){return[{label:"水平间距",nodeSpace:120},{label:"垂直间距",layerSpace:120}]},this.resetConfig=function(t){t&&(this.nodeSpace=Number(t.nodeSpace)||120,this.layerSpace=Number(t.layerSpace)||120,this.center=t.center||[100,100],this.splitType=Number(t.splitType)||2,this.init())},this.addData=function(){this.nodes=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]},this.newLayoutData=function(){return{finishx:0,finishy:0,xdistance:0,ydistance:0}},this.excute=function(){this.inited&&this.run()},this.init=function(){var t=[].concat(this.nodes),e=(t.sort(function(t,e){return(e.inLinks||[]).length+(e.outLinks||[]).length-((t.inLinks||[]).length+(t.outLinks||[]).length)}),this.nodes.length),n=Math.round(Math.sqrt(e))+1,i=Math.round(Math.sqrt(e))+1,r=0,o=0,s=0,a=0;a=1==this.splitType?(s=this.center[0]-(r=n)/2*this.nodeSpace+this.nodeSpace,this.center[1]-(o=i)/2*this.layerSpace+this.layerSpace):(n=(r=Math.round(Math.sqrt(e/2))+1)-n,i=(o=Math.round(2*r)+1)-i,s=this.center[0]-r/2*this.nodeSpace+n*this.nodeSpace,this.center[1]-o/2*this.layerSpace+i*this.layerSpace);for(var h,c,u,l,d=0,f=0;f<r;f++)for(var p=0;p<o;p++)e<=d||(h=f*this.nodeSpace,c=p*this.layerSpace,c+=s,h+=a,u=t[d++],(l=this.newLayoutData()).finishx=c,l.finishy=h,l.xdistance=1/this.intSteps*(c-u.x),l.ydistance=1/this.intSteps*(h-u.y),u.layoutData=l);this.inited=!0,this.finishedCount=0},this.run=function(){for(var t,e=this.nodes,n=e.length,i=0;i<n;i++){var r,o=e[i];null!=(t=o.layoutData)&&(this.boolTransition?(r=Math.abs(o.x-t.finishx),Math.abs(o.x+t.xdistance-t.finishx)<r?o.x+=t.xdistance:o.x=t.finishx,r=Math.abs(o.y-t.finishy),Math.abs(o.y+t.ydistance-t.finishy)<r?o.y+=t.ydistance:o.y=t.finishy,o.x==t.finishx&&o.y==t.finishy&&(o.layoutData=null,this.finishedCount++)):(o.x=t.finishx,o.y=t.finishy,o.layoutData=null,this.finishedCount++))}this.finished=this.finishedCount>=n}}function _t(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e,this.VECTOR_D1=[],this.VECTOR_D2=[],this.lij=[],this.kij=[],this.tempNodes=[],this.center=[0,0],this.realSize=2e3,this.tempSize=1,this.sizeScale=1.3,this.inited=!1,this.finished=!1,this.getConfig=function(){return[{label:"缩放比例",sizeScale:sizeScale}]},this.resetConfig=function(t){t&&(this.sizeScale=Number(t.sizeScale)||1.3,this.center=t.center||[0,0],this.init())},this.addData=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e},this.excute=function(){for(var t=0;t++<100&&this.inited;)this.run()},this.init=function(){var n=this,t=n.nodes,e=t.length,i=n.tempSize,h=(n.nodeIdMapNode={},n.nodeIdIndex={},n.tempNodes=[],n.VECTOR_D1=[],n.VECTOR_D2=[],n.lij=[],n.kij=[],this.realSize=this.setRegionSize(e),t.forEach(function(t,e){n.nodeIdMapNode[t.id]=t,n.nodeIdIndex[t.id]=e,n.tempNodes.push({id:t.id,x:t.x/(n.realSize/n.tempSize),y:t.y/(n.realSize/n.tempSize)})}),[]),c=[],t=n.floydWarshall(e),e=n.getMaxDij(e,t),u=(n.getKijLij(i,e,t,c,h),[]),l=[];n.tempNodes.forEach(function(r,o){var s=0,a=0;n.tempNodes.forEach(function(t,e){var n,i;o!=e&&(n=r.x-t.x,t=r.y-t.y,i=Math.sqrt(n*n+t*t),s+=c[o][e]*(n-h[o][e]*n/i),a+=c[o][e]*(t-h[o][e]*t/i))}),u[o]=s,l[o]=a}),n.VECTOR_D1=u,n.VECTOR_D2=l,n.lij=h,n.kij=c,n.inited=!0},this.run=function(){for(var t,e,n=this.tempNodes.length,i=0,r=0,o=0,s=0,a=-1,h=0;h<n;h++){var c=this.VECTOR_D1[h]*this.VECTOR_D1[h]+this.VECTOR_D2[h]*this.VECTOR_D2[h];a<c&&(s=h,a=c)}if(a<=1e-8)this.finished=!0;else{for(var u,l,d,f,p,g,y,v,m,x,w=this.tempNodes[s],b=w.x,k=w.y,h=0;h<n;h++)h!=s&&(d=(u=b-(f=this.tempNodes[h]).x)*u+(l=k-f.y)*l,d=Math.sqrt(d)*d,i+=this.kij[s][h]*(1-this.lij[s][h]*l*l/d),r+=this.kij[s][h]*(this.lij[s][h]*u*l/d),o+=this.kij[s][h]*(1-this.lij[s][h]*u*u/d));for(t=b+-((M=this.VECTOR_D1[s])+r*(M=(r*M-this.VECTOR_D2[s]*i)/(o*i-r*r)))/i,e=k+M,h=this.VECTOR_D1[s]=this.VECTOR_D2[s]=0;h<n;h++)h!=s&&(p=b-(f=this.tempNodes[h]).x,g=k-f.y,y=Math.sqrt(p*p+g*g),v=t-f.x,m=e-f.y,x=Math.sqrt(v*v+m*m),this.VECTOR_D1[h]-=this.kij[s][h]*(-p+this.lij[s][h]*p/y),this.VECTOR_D2[h]-=this.kij[s][h]*(-g+this.lij[s][h]*g/y),this.VECTOR_D1[h]+=this.kij[s][h]*(-v+this.lij[s][h]*v/x),this.VECTOR_D2[h]+=this.kij[s][h]*(-m+this.lij[s][h]*m/x),this.VECTOR_D1[s]+=this.kij[s][h]*(v-this.lij[s][h]*v/x),this.VECTOR_D2[s]+=this.kij[s][h]*(m-this.lij[s][h]*m/x));w.x=t,w.y=e;var M=this.nodeIdMapNode[w.id];M.x=t*(this.realSize/this.tempSize),M.y=e*(this.realSize/this.tempSize)}},this.getMaxDij=function(t,e){for(var n=0,i=0;i<t;i++)for(var r=i+1;r<t;r++)e[i][r]!=1/0&&e[i][r]>n&&(n=e[i][r]);for(i=0;i<t;i++)for(r=0;r<t;r++)e[i][r]==1/0&&(e[i][r]=n);return n},this.getKijLij=function(t,e,n,i,r){for(var o=t/e,s=this.tempNodes.length,a=0;a<s;a++){i[a]=[],r[a]=[];for(var h=0;h<s;h++){var c=n[a][h]*n[a][h];a!=h&&(i[a][h]=Math.pow(s,2)/c,r[a][h]=o*n[a][h])}}},this.floydWarshall=function(t){for(var n=this,i=[],e=0;e<t;e++){i[e]=[];for(var r=0;r<t;r++)i[e][r]=e!=r?1/0:0}n.links.forEach(function(t){var e=n.nodeIdIndex[t.source.id],t=n.nodeIdIndex[t.target.id];i[e][t]=1,i[t][e]=1});for(var o=0;o<t;o++)for(e=0;e<t;e++)for(r=e+1;r<t;r++){var s=i[e][o]+i[o][r];s<i[e][r]&&(i[e][r]=s,i[r][e]=s)}return i},this.setRegionSize=function(t){t=50*Math.pow(2*t,2);return Math.round(Math.max(Math.sqrt(t),300))*this.sizeScale}}function Tt(){var u=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=u,this.links=t,this.boolTransition=!0,this.scale=1.1,this.center=[0,0],this.ordering="degree",this.intSteps=50,this.inited=!1,this.finished=!1,this.finishedCount=0,this.getConfig=function(){return[{label:"中心位置",center:[0,0]},{label:"间隔比例",scale:1.1},{label:"排序方式",ordering:"degree"}]},this.resetConfig=function(t){t&&(this.center=t.center||[0,0],this.ordering=t.ordering||"degree",this.scale=Number(t.scale)||1.1),this.init()},this.addData=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e},this.newLayoutData=function(){return{finishx:0,finishy:0,xdistance:0,ydistance:0}},this.init=function(){var n,i,r,o=this,t=[],e=("degree"==o.ordering?(t=t.concat(o.nodes)).sort(function(t,e){return(e.inLinks||[]).length+(e.outLinks||[]).length-((t.inLinks||[]).length+(t.outLinks||[]).length)}):t="topology"==o.ordering?o.topologyOrdering():u,0),s=(t.forEach(function(t){e+=t.scale*t.radius*2*o.scale}),(e*=o.scale)/Math.PI),a=2*Math.PI/e,h=0,c=s/2;t.forEach(function(t){n=t.scale*t.radius*2,r=a*n*o.scale,i=o.center[0]+c*Math.cos(h+r),r=o.center[1]+c*Math.sin(h+r),h+=n*o.scale*a*o.scale;var e=o.newLayoutData();e.finishx=i,e.finishy=r,e.xdistance=1/o.intSteps*(i-t.x),e.ydistance=1/o.intSteps*(r-t.y),t.layoutData=e}),this.inited=!0,this.finishedCount=0},this.topologyOrdering=function(){var a=this,h=a.links,c=a.nodes,u={},l=(c.forEach(function(t,e){u[t.id]=e}),a.getDegree(c.length,u,h)),d=(a.degrees=l,[c[0]]),f=c.length,p=[],g=(a.initHierarchy(c,h,u,!(p[0]=!0)),0);return c.forEach(function(t,e){if(0!==e)if(e!==f-1&&l[e]===l[e+1]&&!a.connect(d[g],t,h)||!0===p[e]){for(var n=d[g].children,i=!1,r=0;r<n.length;++r){var o=u[n[r].id];if(l[o]===l[e]&&!0!==p[o]){d.push(c[o]),i=p[o]=!0;break}}for(var s=0;!i&&(p[s]||(d.push(c[s]),i=p[s]=!0),++s!==f););}else d.push(t),p[e]=!0,g++}),d},this.excute=function(){this.inited&&this.run()},this.initHierarchy=function(n,t,i,e){n.forEach(function(t,e){t.children=[],t.parent=[]}),e?t.forEach(function(t){var e=i[t.source.id],t=i[t.target.id];n[e].children.push(n[t]),n[t].parent.push(n[e])}):t.forEach(function(t){var e=i[t.source.id],t=i[t.target.id];n[e].children.push(n[t]),n[t].children.push(n[e])})},this.connect=function(t,e,n){for(var i=n.length,r=0;r<i;r++)if(t.id===n[r].source.id&&e.id===n[r].target.id||e.id===n[r].source.id&&t.id===n[r].target.id)return!0;return!1},this.getDegree=function(t,e,n){for(var i=[],r=0;r<t;r++)i[r]=0;return n.forEach(function(t){i[e[t.source.id]]+=1,i[e[t.target.id]]+=1}),i},this.run=function(){for(var t,e=this.nodes,n=e.length,i=0;i<n;i++){var r,o=e[i];null!=(t=o.layoutData)&&(this.boolTransition?(r=Math.abs(o.x-t.finishx),Math.abs(o.x+t.xdistance-t.finishx)<r?o.x+=t.xdistance:o.x=t.finishx,r=Math.abs(o.y-t.finishy),Math.abs(o.y+t.ydistance-t.finishy)<r?o.y+=t.ydistance:o.y=t.finishy,o.x==t.finishx&&o.y==t.finishy&&(o.layoutData=null,this.finishedCount++)):(o.x=t.finishx,o.y=t.finishy,o.layoutData=null,this.finishedCount++))}this.finished=this.finishedCount>=n}}function Pt(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e,this.MAX_DISPLACEMENT_SQUARED=50,this.CONVERGENT_MAX_TIMES=2,this.CONVERGENT_MOVEMENT=5,this.L=130,this.K_r=1e6,this.K_s=.5,this.delta_t=.015625,this.center=[0,0],this.inited=!1,this.finished=!1,this.excute=function(){this.inited&&this.run()},this.getConfig=function(){return[{label:"收敛系数",movement:this.CONVERGENT_MOVEMENT}]},this.resetConfig=function(t){t&&(this.center=t.center||[0,0]),this.init()},this.addData=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e},this.init=function(){this.inited=!0,this.finished=!1},this.run=function(){var n=this,i=!1;n.CONVERGENT_MAX_TIMES=200;for(var e,r,o,s,a,h,c,u,t=n.nodes,l=t.length,d=0;d<n.CONVERGENT_MAX_TIMES;d++){n.nodes.forEach(function(t){t.force_x=0,t.force_y=0});for(var i=!0,f=0;f<l-1;f++)for(var p=t[f],g=f+1;g<l;g++)e=t[g],r=e.x-p.x,o=e.y-p.y,0===r&&0===o||(h=r*r+o*o,c=Math.sqrt(h),u=n.K_r/h,s=u*r/c,a=u*o/c,p.force_x=p.force_x-s,p.force_y=p.force_y-a,e.force_x=e.force_x+s,e.force_y=e.force_y+a);this.links.forEach(function(t){p=t.source,e=t.target,p.id!=e.id&&(r=e.x-p.x,o=e.y-p.y,0===r&&0===o||(h=r*r+o*o,c=Math.sqrt(h),u=n.K_s*(c-n.L),s=u*r/c,a=u*o/c,p.force_x=p.force_x+s,p.force_y=p.force_y+a,e.force_x=e.force_x-s,e.force_y=e.force_y-a))}),this.nodes.forEach(function(t){var e;r=n.delta_t*t.force_x,o=n.delta_t*t.force_y,(h=r*r+o*o)>n.MAX_DISPLACEMENT_SQUARED&&(e=Math.sqrt(n.MAX_DISPLACEMENT_SQUARED/h),r*=e,o*=e),t.x+=r,t.y+=o,(r=0<r?r:-r)+(o=0<o?o:-o)>n.CONVERGENT_MOVEMENT&&(i=!1)})}n.finished=i}}function Ot(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e,this.nodeIds=[],this.nodeNeighbers=[],this.nodeSpace=60,this.layerSpace=60,this.currentX=0,this.currentY=0,this.center=[0,0],this.boolTransition=!0,this.intSteps=50,this.inited=!1,this.finished=!1,this.finishedCount=0,this.getConfig=function(){return[{label:"节点间距",nodeSpace:80},{label:"层间距",layerSpace:80}]},this.resetConfig=function(t){t&&(this.nodeSpace=Number(t.nodeSpace)||50,this.layerSpace=Number(t.layerSpace)||50,this.center=t.center||[0,0]),this.init()},this.addData=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e},this.excute=function(){this.inited&&this.run()},this.newLayoutData=function(){return{finishx:0,finishy:0,xdistance:0,ydistance:0}},this.init=function(){var e=this;e.nodeIds=[],e.nodeNeighbers=[],e.nodes.forEach(function(t){e.nodeIds.push(t.id);t=e.initNodeNeighbers(t);e.nodeNeighbers.push(t)}),e.buildTree(),e.setRadialLocations(),this.inited=!0,this.finishedCount=0},this.initNodeNeighbers=function(e){return this.links.filter(function(t){return e.id==t.source.id}).map(function(t){return t.target})},this.buildTree=function(){var e=this,t=e.getRoots();0<t.length&&(e.calculateRootsX(t),t.forEach(function(t){e.calculateNodeX(t),e.currentX+=t.sizeT/2+e.nodeSpace,e.buildNodeTree(t,e.currentX)}))},this.getRoots=function(){var e=[];return this.nodes.forEach(function(t){0==(t.inLinks||[]).length&&e.push(t)}),e},this.calculateRootsX=function(t){var n=this,i=0;return t.forEach(function(t){var e=n.getSuccessors(t);0!=e.length&&e.forEach(function(t){i+=n.calculateNodeX(t)+n.nodeSpace}),i=Math.max(0,i-n.nodeSpace),t.sizeT=i}),i},this.calculateNodeX=function(t){var e=this,n=0,i=e.getSuccessors(t);return 0!=i.length&&i.forEach(function(t){n+=e.calculateNodeX(t)+e.nodeSpace}),n=Math.max(0,n-e.nodeSpace),t.sizeT=n},this.buildNodeTree=function(t,e){var n=this;n.currentY+=n.layerSpace,n.currentX=e,n.setCurrentPositionFor(t);var i,r,o=e-t.sizeT/2;n.getSuccessors(t).forEach(function(t){i=t.sizeT,r=o+i/2,n.buildNodeTree(t,r),o=o+i+n.nodeSpace}),n.currentY-=n.layerSpace},this.setCurrentPositionFor=function(t){t.tempx=this.currentX,t.tempy=this.currentY},this.getSuccessors=function(t){t=this.nodeIds.indexOf(t.id);return this.nodeNeighbers[t]||[]},this.setRadialLocations=function(){var r=this,t=r.getMaxXY(),e=t.x,t=t.y,o=2*Math.PI/e,s=e/2/t;r.nodes.forEach(function(t){var e=t.tempx*o,n=(t.tempy-r.layerSpace)*s,i=n*Math.cos(e)+r.center[0],n=n*Math.sin(e)+r.center[1],e=r.newLayoutData();e.finishx=i,e.finishy=n,e.xdistance=1/r.intSteps*(i-t.x),e.ydistance=1/r.intSteps*(n-t.y),t.layoutData=e})},this.getMaxXY=function(){var e=this,n=0,i=0;return e.nodes.forEach(function(t){t.tempx||(t.tempx=e.currentX),t.tempy||(t.tempy=e.currentY),n=Math.max(n,t.tempx),i=Math.max(i,t.tempy)}),{x:n,y:i}},this.run=function(){for(var t,e=this.nodes,n=e.length,i=0;i<n;i++){var r,o=e[i];null!=(t=o.layoutData)&&(this.boolTransition?(r=Math.abs(o.x-t.finishx),Math.abs(o.x+t.xdistance-t.finishx)<r?o.x+=t.xdistance:o.x=t.finishx,r=Math.abs(o.y-t.finishy),Math.abs(o.y+t.ydistance-t.finishy)<r?o.y+=t.ydistance:o.y=t.finishy,o.x==t.finishx&&o.y==t.finishy&&(o.layoutData=null,this.finishedCount++)):(o.x=t.finishx,o.y=t.finishy,o.layoutData=null,this.finishedCount++))}this.finished=this.finishedCount>=n}}function At(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e,this.center=[0,0],this.strength=-1200,this.linkDistance=50,this.simulation=null,this.progress=0,this.iterations=0,this.maxIterations=200,this.ajustCluster=!1,this.inited=!1,this.finished=!1,this.excute=function(){this.inited&&this.run()},this.getConfig=function(){return[{label:"斥力",strength:this.strength},{label:"是否分组",ajustCluster:this.ajustCluster}]},this.resetConfig=function(t){t&&(this.center=t.center||[0,0],this.strength=Number(t.strength)||-1500,this.ajustCluster=Boolean(t.ajustCluster)),this.init()},this.addData=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e},this.init=function(){this.inited=!0,this.finished=!1,this.iterations=0,this.progress=0;var t,e=this.forceSimulation(this.nodes);(this.ajustCluster?e.force("x",this.forceX().strength(.05)).force("y",this.forceY().strength(.1)).force("cluster",this.forceCluster()).force("charge",this.manyBodyReuse().strength(this.strength)).force("collide",this.forceCollide(function(t){return t.radius+20}).strength(1)):(t=this.links.map(function(t,e){return{id:e,source:t.source.id,target:t.target.id}}),e.force("link",this.forceLink(t).id(function(t){return t.id}).strength(.15).distance(this.linkDistance)).force("x",this.forceX()).force("y",this.forceY()).force("charge",this.manyBodyReuse().strength(this.strength).distanceMin(120)).force("collide",this.forceCollide(function(t){return t.radius+20}).strength(1)))).force("center",this.forceCenter(this.center[0],this.center[1])),this.simulation=e},this.run=function(){this.progress+=1/Math.ceil(Math.log(this.simulation.alphaMin())/Math.log(1-this.simulation.alphaDecay())),this.iterations++;var t=this.iterations/this.maxIterations,t=Math.max(t,this.progress);1<=(t=1<t?1:t)?this.finished=!0:this.simulation.tick(t)},this.lcg=function(){var t=4294967296,e=1;return function(){return(e=(1664525*e+1013904223)%t)/t}},this.forceSimulation=function(h){var s,a=1,e=.001,c=1-Math.pow(e,1/300),u=0,l=.6,d={},t=this.timer(r),n=this.dispatch("tick","end"),i=this.lcg();function r(){f(),n.call("tick",s),a<e&&(t.stop(),n.call("end",s))}function o(t){for(var e in d)t(d[e])}function f(t){var e,n,i=h.length;void 0===t&&(t=1);for(var r=0;r<t;++r){for(var o in a+=(u-a)*c,d)d[o](a);for(e=0;e<i;++e)null==(n=h[e]).fx?n.x+=n.vx*=l:(n.x=n.fx,n.vx=0),null==n.fy?n.y+=n.vy*=l:(n.y=n.fy,n.vy=0)}return s}function p(){for(var t,e,n,i=0,r=h.length;i<r;++i)(t=h[i]).index=i,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),(isNaN(t.x)||isNaN(t.y))&&(e=initialRadius*Math.sqrt(.5+i),n=i*initialAngle,t.x=e*Math.cos(n),t.y=e*Math.sin(n)),(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}function g(t){return t.initialize&&t.initialize(h,i),t}return null==h&&(h=[]),p(),s={tick:f,restart:function(){return t.restart(r),s},stop:function(){return t.stop(),s},nodes:function(t){return arguments.length?(h=t,p(),o(g),s):h},alpha:function(t){return arguments.length?(a=+t,s):a},alphaMin:function(t){return arguments.length?(e=+t,s):e},alphaDecay:function(t){return arguments.length?(c=+t,s):+c},alphaTarget:function(t){return arguments.length?(u=+t,s):u},velocityDecay:function(t){return arguments.length?(l=1-t,s):1-l},randomSource:function(t){return arguments.length?(i=t,o(g),s):i},force:function(t,e){return 1<arguments.length?(null==e?d.delete[t]:d[t]=g(e),s):d[t]},find:function(t,e,n){var i,r,o,s=0,a=h.length;for(null==n?n=1/0:n*=n,s=0;s<a;++s)(i=(i=t-(r=h[s]).x)*i+(i=e-r.y)*i)<n&&(o=r,n=i);return o},on:function(t,e){return 1<arguments.length?(n.on(t,e),s):n.on(t)}}},this.jiggle=function(){return 1e-6*(Math.random()-.5)},this.constant=function(t){return function(){return t}},this.forceManyBody=function(){var r,h,c,u,l,d=this,i=d.constant(-30),f=1,p=1/0,g=.81;function o(t){return t.x}function s(t){return t.y}function e(t){var e,n=r.length,i=d.quadtree(r,o,s).visitAfter(a);for(u=t,e=0;e<n;++e)h=r[e],i.visit(y)}function n(){if(r){var t,e,n=r.length;for(l=new Array(n),t=0;t<n;++t)e=r[t],l[e.index]=+i(e,t,r)}}function a(t){var e,n,i,r,o,s=0,a=0;if(t.length){for(i=r=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(s+=e.value,a+=n,i+=n*e.x,r+=n*e.y);t.x=i/a,t.y=r/a}else for((e=t).x=e.data.x,e.y=e.data.y;s+=l[e.data.index],e=e.next;);t.value=s}function y(t,e,n,i){if(!t.value)return!0;var r=t.x-h.x,o=t.y-h.y,s=i-e,a=r*r+o*o;if(s*s/g<a)return a<p&&(0===r&&(a+=(r=d.jiggle(c))*r),0===o&&(a+=(o=d.jiggle(c))*o),a<f&&(a=Math.sqrt(f*a)),h.vx+=r*t.value*u/a,h.vy+=o*t.value*u/a),!0;if(!(t.length||p<=a))for((t.data!==h||t.next)&&(0===r&&(a+=(r=d.jiggle(c))*r),0===o&&(a+=(o=d.jiggle(c))*o),a<f)&&(a=Math.sqrt(f*a));t.data!==h&&(s=l[t.data.index]*u/a,h.vx+=r*s,h.vy+=o*s),t=t.next;);}return e.initialize=function(t,e){r=t,c=e,n()},e.strength=function(t){return arguments.length?(i="function"==typeof t?t:d.constant(+t),n(),e):i},e.distanceMin=function(t){return arguments.length?(f=t*t,e):Math.sqrt(f)},e.distanceMax=function(t){return arguments.length?(p=t*t,e):Math.sqrt(p)},e.theta=function(t){return arguments.length?(g=t*t,e):Math.sqrt(g)},e},this.manyBodyReuse=function(){var i,h,c,r,o,s,u,l=this,a=0,d=l.constant(-30),f=1,p=1/0,g=.81;function y(t){return t.x}function v(t){return t.y}function o(){return function(t){return t%13==0}}function e(t){var e,n=i.length;for(r&&!s(a,i)||(r=l.quadtree(i,y,v).visitAfter(m),i.update.push(a)),c=t,e=0;e<n;++e)h=i[e],r.visit(x);++a}function n(){if(i){a=0,i.update=[],s=o(),r=null;var t,e,n=i.length;for(u=new Array(n),t=0;t<n;++t)e=i[t],u[e.index]=+d(e,t,i)}}function m(t){var e,n,i,r,o,s=0,a=0;if(t.length){for(i=r=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(s+=e.value,a+=n,i+=n*e.x,r+=n*e.y);t.x=i/a,t.y=r/a}else for((e=t).x=e.data.x,e.y=e.data.y;s+=u[e.data.index],e=e.next;);t.value=s}function x(t,e,n,i){if(!t.value)return!0;var r=t.x-h.x,o=t.y-h.y,s=i-e,a=r*r+o*o;if(s*s/g<a)return a<p&&(0===r&&(a+=(r=l.jiggle())*r),0===o&&(a+=(o=l.jiggle())*o),a<f&&(a=Math.sqrt(f*a)),h.vx+=r*t.value*c/a,h.vy+=o*t.value*c/a),!0;if(!(t.length||p<=a))for((t.data!==h||t.next)&&(0===r&&(a+=(r=l.jiggle())*r),0===o&&(a+=(o=l.jiggle())*o),a<f)&&(a=Math.sqrt(f*a));t.data!==h&&(a=(r=t.data.x-h.x)*r+(o=t.data.y-h.y)*o,0===r&&(a+=(r=l.jiggle())*r),0===o&&(a+=(o=l.jiggle())*o),a<f&&(a=Math.sqrt(f*a)),s=u[t.data.index]*c/a,h.vx+=r*s,h.vy+=o*s),t=t.next;);}return e.initialize=function(t){i=t,n()},e.strength=function(t){return arguments.length?(d="function"==typeof t?t:l.constant(+t),n(),e):d},e.distanceMin=function(t){return arguments.length?(f=t*t,e):Math.sqrt(f)},e.distanceMax=function(t){return arguments.length?(p=t*t,e):Math.sqrt(p)},e.theta=function(t){return arguments.length?(g=t*t,e):Math.sqrt(g)},e.update=function(t){return arguments.length?(s=(o=t)(),e):o},e},this.manyBodySampled=function(){var v,m,x,w,b,k,M,E,e=this,i=e.constant(-30),C=0,N=1,L=1/0,r=function(){return 15},o=function(t){return Math.pow(t.length,.75)},s=function(t){return Math.pow(t.length,.25)},a=function(t){return t.length<100?1:t.length<200?3:Math.sqrt(t.length)},S=Math.random;function _(t){var e,n,i=Math.floor(S()*v.length),r=v[i],r=(t.x-r.x)*(t.x-r.x)+(t.y-r.y)*(t.y-r.y),o=-1/0,s=-1;if(!(0<=t.nearest.indexOf(i)))if(t.nearest.length<b)t.nearest.push(i);else{for(;++s<t.nearest.length;)e=t.nearest[s],e=v[e],(e=(t.x-e.x)*(t.x-e.x)-(t.y-e.y)*(t.y-e.y))>o&&(n=s,o=e);r<o&&(t.nearest[n]=i)}}function n(t){var e,n,i,r,o,s=0,a=C,h=v.length,c=C+k;for(m=t;s<h||a<c;++s,++a){if(a<c){u=void 0;g=void 0;p=void 0;d=void 0;l=void 0;f=void 0;var u=v[a%h];for(var l,d,f,p=function(t,e){e=Math.floor(e);for(var n,i,r=v.length,o=r-e,s=r-1;o<=s;--s)i=t[n=Math.floor(S()*s)],t[n]=t[s],t[s]=i;return t.slice(o)}(w,M),g=p.length-1;0<=g;--g)(d=v[p[g]])===u||(f=(l=d.x-u.x)*l+(d=d.y-u.y)*d)>=L||(0===l&&(f+=(l=1e-6*(S()-.5))*l),0===d&&(f+=(d=1e-6*(S()-.5))*d),f<N&&(f=Math.sqrt(N*f)),f=x[u.index]*m*E/f,u.vx+=l*f,u.vy+=d*f)}if(b&&s<h){y=void 0;e=void 0;n=void 0;r=void 0;i=void 0;o=void 0;var y=v[s];if(b&&_(y),n=y.nearest,b)for(e=n.length-1;0<=e;--e)(r=v[n[e]])===y||(o=(i=r.x-y.x)*i+(r=r.y-y.y)*r)>=L||(0===i&&(o+=(i=1e-6*(S()-.5))*i),0===r&&(o+=(r=1e-6*(S()-.5))*r),o<N&&(o=Math.sqrt(N*o)),o=x[y.index]*m*E/o,y.vx+=i*o,y.vy+=r*o)}}C=c%h}function h(){if(v){var t,e,n=v.length;for(w=new Array(n),t=0;t<n;++t)w[t]=t;for(x=new Array(n),b=(b=Math.min(Math.ceil(r()),n))<0?0:Math.min(b,v.length),k=(k=Math.ceil(o(v)))<0?0:Math.min(k,n),M=(M=Math.ceil(s(v)))<0?0:Math.min(M,n),E=a(v),m=1,t=0;t<n;++t)for(e=v[t],x[e.index]=+i(e,t,v),e.nearest=[];e.nearest.length<b;)_(e)}}return n.initialize=function(t){v=t,h()},n.strength=function(t){return arguments.length?(i="function"==typeof t?t:e.constant(+t),h(),n):i},n.distanceMin=function(t){return arguments.length?(N=t*t,n):Math.sqrt(N)},n.distanceMax=function(t){return arguments.length?(L=t*t,n):Math.sqrt(L)},n.neighborSize=function(t){return arguments.length?(r="function"==typeof t?t:e.constant(+t),h(),n):r},n.updateSize=function(t){return arguments.length?(o="function"==typeof t?t:e.constant(+t),h(),n):o},n.sampleSize=function(t){return arguments.length?(s="function"==typeof t?t:e.constant(+t),h(),n):s},n.chargeMultiplier=function(t){return arguments.length?(a="function"==typeof t?t:e.constant(+t),h(),n):a},n.source=function(t){return arguments.length?(S=t,n):S},n},this.forceCollide=function(i){var o,s,d,f=this,p=1,g=1;function e(){for(var t,e,a,h,c,u,l,n=o.length,i=0;i<g;++i)for(e=f.quadtree(o,y,v).visitAfter(m),t=0;t<n;++t)a=o[t],u=s[a.index],l=u*u,h=a.x+a.vx,c=a.y+a.vy,e.visit(r);function r(t,e,n,i,r){var o=t.data,t=t.r,s=u+t;if(!o)return h+s<e||i<h-s||c+s<n||r<c-s;o.index>a.index&&(n=(e=h-o.x-o.vx)*e+(i=c-o.y-o.vy)*i)<s*s&&(0===e&&(n+=(e=f.jiggle(d))*e),0===i&&(n+=(i=f.jiggle(d))*i),n=(s-(n=Math.sqrt(n)))/n*p,a.vx+=(e*=n)*(s=(t*=t)/(l+t)),a.vy+=(i*=n)*s,o.vx-=e*(s=1-s),o.vy-=i*s)}}function y(t){return t.x+t.vx}function v(t){return t.y+t.vy}function m(t){if(t.data)return t.r=s[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function n(){if(o){var t,e,n=o.length;for(s=new Array(n),t=0;t<n;++t)e=o[t],s[e.index]=+i(e,t,o)}}return"function"!=typeof i&&(i=f.constant(null==i?1:+i)),e.initialize=function(t,e){o=t,d=e,n()},e.iterations=function(t){return arguments.length?(g=+t,e):g},e.strength=function(t){return arguments.length?(p=+t,e):p},e.radius=function(t){return arguments.length?(i="function"==typeof t?t:f.constant(+t),n(),e):i},e},this.forceCluster=function(){var n=[],s=.4;function e(t){var i={};n.forEach(function(t){isNaN(t.x)&&(t.x=100*Math.random()),isNaN(t.y)&&(t.y=100*Math.random());var e=t.type||"default",n=i[e];null==n?i[e]=[]:(n.push(t),i[e]=n)});var e,r={};for(e in i)r[e]=function(t){var e=0,n=0,i=0,r=Math.pow(5,2);return t.forEach(function(t){e+=t.x*r,n+=t.y*r,i+=r}),e/=i,n/=i,isNaN(e)&&(e=20*Math.random()),isNaN(n)&&(n=20*Math.random()),{x:e,y:n}}(i[e]);var o=t*s;n.forEach(function(t){var e=r[t.type||"default"],n=e.x,e=e.y;t.vx-=(t.x-n)*o,t.vy-=(t.y-e)*o})}return e.initialize=function(t){return n=t},e.strength=function(t){return arguments.length?(s=+t,e):s},e},this.forceCenter=function(o,s){var a,h=1;function e(){for(var t,e=a.length,n=0,i=0,r=0;r<e;++r)n+=(t=a[r]).x,i+=t.y;for(n=(n/e-o)*h,i=(i/e-s)*h,r=0;r<e;++r)(t=a[r]).x-=n,t.y-=i}return null==o&&(o=0),null==s&&(s=0),e.initialize=function(t){a=t},e.x=function(t){return arguments.length?(o=+t,e):o},e.y=function(t){return arguments.length?(s=+t,e):s},e.strength=function(t){return arguments.length?(h=+t,e):h},e},this.forceLink=function(c){var u,l,o,s,d,f,p=this,a=function(t){return t.index},n=function(t){return 1/Math.min(s[t.source.index],s[t.target.index])},i=p.constant(30),g=1;function e(t){for(var e=0,n=c.length;e<g;++e)for(var i,r,o,s,a,h=0;h<n;++h)i=(r=c[h]).source,o=(r=r.target).x+r.vx-i.x-i.vx||p.jiggle(f),s=r.y+r.vy-i.y-i.vy||p.jiggle(f),o*=a=((a=Math.sqrt(o*o+s*s))-l[h])/a*t*u[h],s*=a,r.vx-=o*(a=d[h]),r.vy-=s*a,i.vx+=o*(a=1-a),i.vy+=s*a}function h(){if(o)for(var t=0,e=c.length;t<e;++t)u[t]=+n(c[t],t,c)}function y(){if(o)for(var t=0,e=c.length;t<e;++t)l[t]=+i(c[t],t,c)}function r(){if(o){var t,e,n=o.length,i=c.length,r={};for(o.forEach(function(t,e){return r[a(t,e,o)]=t}),t=0,s=new Array(n);t<i;++t)(e=c[t]).index=t,e.source=r[e.source],e.target=r[e.target],s[e.source.index]=(s[e.source.index]||0)+1,s[e.target.index]=(s[e.target.index]||0)+1;for(t=0,d=new Array(i);t<i;++t)e=c[t],d[t]=s[e.source.index]/(s[e.source.index]+s[e.target.index]);u=new Array(i),h(),l=new Array(i),y()}}return null==c&&(c=[]),e.initialize=function(t,e){o=t,f=e,r()},e.links=function(t){return arguments.length?(c=t,r(),e):c},e.id=function(t){return arguments.length?(a=t,e):a},e.iterations=function(t){return arguments.length?(g=+t,e):g},e.strength=function(t){return arguments.length?(n="function"==typeof t?t:p.constant(+t),h(),e):n},e.distance=function(t){return arguments.length?(i="function"==typeof t?t:p.constant(+t),y(),e):i},e},this.forceRadial=function(n,a,h){var c,u,l,e=this,i=e.constant(.1);function r(t){for(var e=0,n=c.length;e<n;++e){var i=c[e],r=i.x-a||1e-6,o=i.y-h||1e-6,s=Math.sqrt(r*r+o*o),s=(l[e]-s)*u[e]*t/s;i.vx+=r*s,i.vy+=o*s}}function o(){if(c){var t,e=c.length;for(u=new Array(e),l=new Array(e),t=0;t<e;++t)l[t]=+n(c[t],t,c),u[t]=isNaN(l[t])?0:+i(c[t],t,c)}}return"function"!=typeof n&&(n=e.constant(+n)),null==a&&(a=0),null==h&&(h=0),r.initialize=function(t){c=t,o()},r.strength=function(t){return arguments.length?(i="function"==typeof t?t:e.constant(+t),o(),r):i},r.radius=function(t){return arguments.length?(n="function"==typeof t?t:e.constant(+t),o(),r):n},r.x=function(t){return arguments.length?(a=+t,r):a},r.y=function(t){return arguments.length?(h=+t,r):h},r},this.forceX=function(n){var r,o,s,e=this,i=e.constant(.1);function a(t){for(var e,n=0,i=r.length;n<i;++n)(e=r[n]).vx+=(s[n]-e.x)*o[n]*t}function h(){if(r){var t,e=r.length;for(o=new Array(e),s=new Array(e),t=0;t<e;++t)o[t]=isNaN(s[t]=+n(r[t],t,r))?0:+i(r[t],t,r)}}return"function"!=typeof n&&(n=e.constant(null==n?0:+n)),a.initialize=function(t){r=t,h()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:e.constant(+t),h(),a):i},a.x=function(t){return arguments.length?(n="function"==typeof t?t:e.constant(+t),h(),a):n},a},this.forceY=function(n){var r,o,s,e=this,i=e.constant(.1);function a(t){for(var e,n=0,i=r.length;n<i;++n)(e=r[n]).vy+=(s[n]-e.y)*o[n]*t}function h(){if(r){var t,e=r.length;for(o=new Array(e),s=new Array(e),t=0;t<e;++t)o[t]=isNaN(s[t]=+n(r[t],t,r))?0:+i(r[t],t,r)}}return"function"!=typeof n&&(n=e.constant(null==n?0:+n)),a.initialize=function(t){r=t,h()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:e.constant(+t),h(),a):i},a.y=function(t){return arguments.length?(n="function"==typeof t?t:e.constant(+t),h(),a):n},a},this.timer=function(t,e,n){var s,a,h=0,c=0,i=0,u=0,l=0,d=0,f=Date,r="object"===("undefined"==typeof window?"undefined":Ft(window))&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function p(){return l||(r(o),l=f.now()+d)}function o(){l=0}function g(){l=(u=f.now())+d,h=c=0;try{p(),++h;for(var t,e=s;e;)0<=(t=l-e._time)&&e._call.call(void 0,t),e=e._next;--h}finally{for(var n,i,r=s,o=1/(h=0);r;)r=r._call?(o>r._time&&(o=r._time),(n=r)._next):(i=r._next,r._next=null,n?n._next=i:s=i);a=n,v(o),l=0}}function y(){var t=f.now(),e=t-u;1e3<e&&(d-=e,u=t)}function v(t){h||(c=c&&clearTimeout(c),24<t-l?(t<1/0&&(c=setTimeout(g,t-f.now()-d)),i=i&&clearInterval(i)):(i||(u=f.now(),i=setInterval(y,1e3)),h=1,r(g)))}var m=new function(){this._call=this._time=this._next=null,this.restart=function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?p():+n)+(null==e?0:+e),this._next||a===this||(a?a._next=this:s=this,a=this),this._call=t,this._time=n,v()},this.stop=function(){this._call&&(this._call=null,this._time=1/0,v())}};return m.restart(t,e,n),m},this.dispatch=function(){var o={value:function(){}};function i(t){this._=t}function h(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=o,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}i.prototype={constructor:i,on:function(t,e){var n,i,r=this._,o=(i=r,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(0<=n&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),s=-1,a=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<a;)if(n=(t=o[s]).type)r[n]=h(r[n],t.name,e);else if(null==e)for(n in r)r[n]=h(r[n],t.name,null);return this}for(;++s<a;)if(n=(n=(t=o[s]).type)&&function(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}(r[n],t.name))return n},copy:function(){var t,e={},n=this._;for(t in n)e[t]=n[t].slice();return new i(e)},call:function(t,e){if(0<(n=arguments.length-2))for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(i=this._[t]).length;o<n;++o)i[o].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new i(r)},this.quadtree=function(t,e,n){function l(t,e,n,i){if(!isNaN(e)&&!isNaN(n)){var r,o,s,a,h,c,u,l,d,f=t._root,p={data:i},g=t._x0,y=t._y0,v=t._x1,m=t._y1;if(f){for(;f.length;)if((c=e>=(o=(g+v)/2))?g=o:v=o,(u=n>=(s=(y+m)/2))?y=s:m=s,!(f=(r=f)[l=u<<1|c]))return r[l]=p,t;if(a=+t._x.call(null,f.data),h=+t._y.call(null,f.data),e===a&&n===h)p.next=f,r?r[l]=p:t._root=p;else{for(;r=r?r[l]=new Array(4):t._root=new Array(4),(c=e>=(o=(g+v)/2))?g=o:v=o,(u=n>=(s=(y+m)/2))?y=s:m=s,(l=u<<1|c)==(d=(s<=h)<<1|o<=a););r[d]=f,r[l]=p}}else t._root=p}return t}function v(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function o(t,e,n,i,r,o){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function s(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var i=o.prototype,i=(i.copy=function(){var t,e,n=new o(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(i)if(i.length)for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var r=0;r<4;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=new Array(4)}):i.target[r]=s(e));else n._root=s(i);return n},i.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return l(this.cover(e,n),e,n,t)},i.addAll=function(t){for(var e,n,i=t.length,r=new Array(i),o=new Array(i),s=1/0,a=1/0,h=-1/0,c=-1/0,u=0;u<i;++u)isNaN(e=+this._x.call(null,n=t[u]))||isNaN(n=+this._y.call(null,n))||((r[u]=e)<s&&(s=e),h<e&&(h=e),(o[u]=n)<a&&(a=n),c<n&&(c=n));if(!(h<s||c<a))for(this.cover(s,a).cover(h,c),u=0;u<i;++u)l(this,r[u],o[u],t[u]);return this},i.cover=function(t,e){if(!isNaN(t=+t)&&!isNaN(e=+e)){var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,o=(i=Math.floor(e))+1;else{for(var s,a,h=r-n||1,c=this._root;t<n||r<=t||e<i||o<=e;)switch(a=(e<i)<<1|t<n,(s=new Array(4))[a]=c,c=s,h*=2,a){case 0:r=n+h,o=i+h;break;case 1:n=r-h,o=i+h;break;case 2:r=n+h,i=o-h;break;case 3:n=r-h,i=o-h}this._root&&this._root.length&&(this._root=c)}this._x0=n,this._y0=i,this._x1=r,this._y1=o}return this},i.data=function(){var e=[];return this.visit(function(t){if(!t.length)for(;e.push(t.data),t=t.next;);}),e},i.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},i.find=function(t,e,n){var i,r,o,s,a,h,c,u,l=this._x0,d=this._y0,f=this._x1,p=this._y1,g=[],y=this._root;for(y&&g.push(new v(y,l,d,f,p)),null==n?n=1/0:(l=t-n,d=e-n,f=t+n,p=e+n,n*=n);i=g.pop();)!(y=i.node)||(a=i.x0)>f||(h=i.y0)>p||(s=i.x1)<l||(r=i.y1)<d||(y.length?(g.push(new v(y[3],o=(a+s)/2,c=(h+r)/2,s,r),new v(y[2],a,c,o,r),new v(y[1],o,h,s,c),new v(y[0],a,h,o,c)),(r=(c<=e)<<1|o<=t)&&(i=g[g.length-1],g[g.length-1]=g[g.length-1-r],g[g.length-1-r]=i)):(h=(s=t-+this._x.call(null,y.data))*s+(a=e-+this._y.call(null,y.data))*a)<n&&(l=t-(c=Math.sqrt(n=h)),d=e-c,f=t+c,p=e+c,u=y.data));return u},i.remove=function(t){if(!isNaN(o=+this._x.call(null,t))&&!isNaN(s=+this._y.call(null,t))){var e,n,i,r,o,s,a,h,c,u,l,d=this._root,f=this._x0,p=this._y0,g=this._x1,y=this._y1;if(d){if(d.length)for(;;){if((h=o>=(a=(f+g)/2))?f=a:g=a,(c=s>=(a=(p+y)/2))?p=a:y=a,!(d=(e=d)[u=c<<1|h]))return this;if(!d.length)break;(e[u+1&3]||e[u+2&3]||e[u+3&3])&&(n=e,l=u)}for(;d.data!==t;)if(!(d=(i=d).next))return this;(r=d.next)&&delete d.next,i?r?i.next=r:delete i.next:e?(r?e[u]=r:delete e[u],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[l]=d:this._root=d)):this._root=r}}return this},i.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},i.root=function(){return this._root},i.size=function(){var e=0;return this.visit(function(t){if(!t.length)for(;++e,t=t.next;);}),e},i.visit=function(t){var e,n,i,r,o,s,a,h=[],c=this._root;for(c&&h.push(new v(c,this._x0,this._y0,this._x1,this._y1));o=h.pop();)!t(c=o.node,n=o.x0,i=o.y0,r=o.x1,o=o.y1)&&c.length&&(s=(n+r)/2,a=(i+o)/2,(e=c[3])&&h.push(new v(e,s,a,r,o)),(e=c[2])&&h.push(new v(e,n,a,s,o)),(e=c[1])&&h.push(new v(e,s,i,r,a)),e=c[0])&&h.push(new v(e,n,i,s,a));return this},i.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new v(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var r,o,s,a,h,c,u,l=e.node;l.length&&(o=e.x0,s=e.y0,c=(o+(a=e.x1))/2,u=(s+(h=e.y1))/2,(r=l[0])&&n.push(new v(r,o,s,c,u)),(r=l[1])&&n.push(new v(r,c,s,a,u)),(r=l[2])&&n.push(new v(r,o,u,c,h)),r=l[3])&&n.push(new v(r,c,u,a,h)),i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},i.x=function(t){return arguments.length?(this._x=t,this):this._x},i.y=function(t){return arguments.length?(this._y=t,this):this._y},new o(null==e?function(t){return t[0]}:e,null==n?function(t){return t[1]}:n,NaN,NaN,NaN,NaN));return null==t?i:i.addAll(t)}}function It(){this.nodes=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],this.links=[],this.center=[0,0],this.neighberForce=5,this.attraction=.05,this.forceScale=6,this.deltaT=6,this.forceCutoff=10,this.inited=!1,this.finished=!1,this.totalIterates=100,this.getConfig=function(){return[{label:"邻边引力",neighberForce:5},{label:"向心力",attraction:.05},{label:"斥力",forceScale:6}]},this.resetConfig=function(t){t&&(this.center=t.center||[0,0],this.neighberForce=Number(t.neighberForce)||5,this.attraction=Number(t.attraction)||.05,this.forceScale=Number(t.forceScale)||6),this.init()},this.addData=function(){this.nodes=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],this.links=[]},this.init=function(){this.nodes.forEach(function(t){t.degree=(t.inLinks||[]).length+(t.outLinks||[]).length}),this.totalIterates=Math.max(150,15*Math.sqrt(this.nodes.length,2)),this.inited=!0},this.excute=function(){this.inited&&this.run()},this.run=function(){var i=this;i.nodes.forEach(function(t){var e=t.degree<=1?i.deltaT:i.deltaT/Math.pow(t.degree,.4),n={x:(n=i.getForceforNode(t)).x*e,y:n.y*e};t.x+=n.x,t.y+=n.y}),i.totalIterates--,i.totalIterates<=0&&(i.finished=!0)},this.getForceforNode=function(r){var t,o=this,s=o.nodes.length,a={x:0,y:0};return 0==r.x&&0==r.y||(o.nodes.forEach(function(t){var e,n,i;r.id!=t.id&&(e=t.x-r.x,n=t.y-r.y,0==e&&0==n&&(e=20,n=25),i=1,o.isAdjacent(r,t)&&(i=o.neighberForce),i*=o.attraction/Math.sqrt(s),a={x:a.x+e*i,y:a.y+n*i},i=1/Math.sqrt(e*e+n*n),a={x:a.x-e*i*o.forceScale,y:a.y-n*i*o.forceScale})}),(t=o.distance(0,0,a.x,a.y))>o.forceCutoff&&(t=o.forceCutoff/t,a={x:a.x*t,y:a.y*t})),a},this.isAdjacent=function(t,e){return t.id!=e.id&&(-1!=(t.inLinks||[]).map(function(t){return t.source.id}).indexOf(e.id)||-1!=(t.outLinks||[]).map(function(t){return t.target.id}).indexOf(e.id))},this.distance=function(t,e,n,i){return t-=n,e-=i,Math.sqrt(t*t+e*e)}}function Dt(t,e){this.nodes=t,this.links=e,this.nodeIds=[],this.nodeNeighbers=[],this.center=[0,0],this.nodeSpace=80,this.layerSpace=80,this.currentX=0,this.currentY=0,this.direction="UD",this.centerDist={x:0,y:0},this.boolTransition=!0,this.intSteps=50,this.hasCycle=!1,this.inited=!1,this.finished=!1,this.finishedCount=0,this.getConfig=function(){return[{label:"点间距",nodeSpace:80},{label:"层间距",layerSpace:120},{label:"排列方向",direction:[{label:"上下",value:"UD"},{label:"下上",value:"DU"},{label:"左右",value:"LR"},{label:"右左",value:"RL"}]}]},this.resetConfig=function(t){t&&(this.nodeSpace=Number(t.nodeSpace)||100,this.layerSpace=Number(t.layerSpace)||120,this.direction=t.direction||"UD",this.center=t.center||[0,0]),this.nodeIds=[],this.nodeNeighbers=[],this.init()},this.addData=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e},this.init=function(){var e=this;e.nodes.forEach(function(t){e.checkHasCycle(t,[]),e.nodeIds.push(t.id);t=e.initNodeNeighbers(t);e.nodeNeighbers.push(t)}),e.centerDist=this.computeCenter(),e.buildTree(),this.inited=!0,this.finishedCount=0},this.newLayoutData=function(){return{finishx:0,finishy:0,xdistance:0,ydistance:0}},this.initNodeNeighbers=function(i){var r=this,o=[];return(i.outLinks||[]).forEach(function(t){var e,n=t.target;t.source.id!=n.id&&(t=r.nodeIds.indexOf(n.id),t=r.nodeNeighbers[t]||[],e=[],t.forEach(function(t){e.push(t.id)}),-1==e.indexOf(i.id))&&o.push(n)}),o},this.excute=function(){!this.hasCycle&&this.inited&&this.run()},this.buildTree=function(){var e=this,t=e.getRoots();0<t.length&&(e.calculateRootsX(t),t.forEach(function(t){e.calculateNodeX(t),e.currentX+=t.sizeT/2+e.nodeSpace,e.buildNodeTree(t,e.currentX)}))},this.getRoots=function(){var e=[];return this.nodes.forEach(function(t){0==(t.inLinks||[]).length&&e.push(t)}),e},this.calculateRootsX=function(t){var n=this,i=0;return t.forEach(function(t){var e=n.getSuccessors(t);0!=e.length&&e.forEach(function(t){i+=n.calculateNodeX(t)+n.nodeSpace}),i=Math.max(0,i-n.nodeSpace),t.sizeT=i}),i},this.calculateNodeX=function(t){var e=this,n=0,i=e.getSuccessors(t);return 0!=i.length&&i.forEach(function(t){n+=e.calculateNodeX(t)+e.nodeSpace}),n=Math.max(0,n-e.nodeSpace),t.sizeT=n},this.buildNodeTree=function(t,e){var n=this;n.currentY+=n.layerSpace,n.currentX=e,n.setCurrentPositionFor(t);var i,r,o=e-t.sizeT/2;n.getSuccessors(t).forEach(function(t){i=t.sizeT,r=o+i/2,n.buildNodeTree(t,r),o=o+i+n.nodeSpace}),n.currentY-=n.layerSpace},this.setCurrentPositionFor=function(t){var e=this.currentX,n=this.currentY,i=e,i=("DU"==this.direction?n=-n:"LR"==this.direction?(e=n,n=i):"RL"==this.direction&&(e=-n,n=i),e+=this.centerDist.x,n+=this.centerDist.y,this.newLayoutData());i.finishx=e,i.finishy=n,i.xdistance=1/this.intSteps*(e-t.x),i.ydistance=1/this.intSteps*(n-t.y),t.layoutData=i},this.computeCenter=function(){var e=1/0,n=-1/0,i=1/0,r=-1/0;return this.nodes.forEach(function(t){i=Math.min(i,t.x),r=Math.max(r,t.x),e=Math.min(e,t.y),n=Math.max(n,t.y)}),{x:this.center[0]-(r-i)/2,y:this.center[1]-(n-e)/2}},this.getSuccessors=function(t){t=this.nodeIds.indexOf(t.id);return this.nodeNeighbers[t]||[]},this.run=function(){for(var t,e=this.nodes,n=e.length,i=0;i<n;i++){var r,o=e[i];null!=(t=o.layoutData)&&(this.boolTransition?(r=Math.abs(o.x-t.finishx),Math.abs(o.x+t.xdistance-t.finishx)<r?o.x+=t.xdistance:o.x=t.finishx,r=Math.abs(o.y-t.finishy),Math.abs(o.y+t.ydistance-t.finishy)<r?o.y+=t.ydistance:o.y=t.finishy,o.x==t.finishx&&o.y==t.finishy&&(o.layoutData=null,this.finishedCount++)):(o.x=t.finishx,o.y=t.finishy,o.layoutData=null,this.finishedCount++))}this.finished=this.finishedCount>=n},this.checkHasCycle=function(e,n){var i=this;(e.outLinks||[]).forEach(function(t){t=t.target;e.id!=t.id&&-1==n.indexOf(t.id)?(n.push(t.id),i.checkHasCycle(t,n)):i.hasCycle=!0})}}function Bt(t,e){this.nodes=t,this.links=e,this.center=[0,0],this.SPEED_DIVISOR=800,this.AREA_MULTIPLICATOR=1e5,this.area=5,this.speed=10,this.inited=!1,this.finished=!1,this.getConfig=function(){return[{label:"缩放比例",area:this.area},{label:"收敛速度",speed:this.speed}]},this.resetConfig=function(t){this.init(),t&&(this.area=Number(t.area)||5,this.speed=Number(t.speed)||10,this.center=t.center||[0,0])},this.init=function(){var e=this;this.area=200,this.speed=5,this.nodes.forEach(function(t){t.layoutData=e.newLayoutData()}),this.maxDisplace=Math.sqrt(e.AREA_MULTIPLICATOR*e.area)/10,this.k=Math.sqrt(e.AREA_MULTIPLICATOR*e.area/(1+e.nodes.length)),this.totalIterates=Math.max(150,15*Math.sqrt(this.nodes.length,2)),this.inited=!0},this.addData=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e},this.excute=function(){this.inited&&this.run()},this.run=function(){this.repulsiveForce(),this.attractiveForce(),this.sameTypeAttractive(),this.resetNodePosition(),this.totalIterates--,this.totalIterates<=0&&(this.finished=!0)},this.repulsiveForce=function(){var a=this;a.nodes.forEach(function(o,s){a.nodes.forEach(function(t,e){var n,i,r;s!=e&&(e=o.x-t.x,t=o.y-t.y,5<(n=Math.sqrt(e*e+t*t)))&&(i=a.k*a.k/n,(r=o.layoutData).dx+=e/n*i*.01,r.dy+=t/n*i*.01)})})},this.attractiveForce=function(){var s=this;s.links.forEach(function(t){var e=t.source,t=t.target,n=e.x-t.x,i=e.y-t.y,r=Math.sqrt(n*n+i*i),o=r*r/s.k;5<r&&(e=e.layoutData,t=t.layoutData,e.dx-=n/r*o,e.dy-=i/r*o,t.dx+=n/r*o,t.dy+=i/r*o)})},this.sameTypeAttractive=function(){var h=this;h.nodes.forEach(function(s,a){h.nodes.forEach(function(t,e){var n,i,r,o;a!=e&&s.cluster==t.cluster&&(e=s.x-t.x,n=s.y-t.y,0<(i=Math.sqrt(e*e+n*n)))&&(r=i*i/h.k,o=s.layoutData,t=t.layoutData,o.dx-=e/i*r,o.dy-=n/i*r,t.dx+=e/i*r,t.dy+=n/i*r)})})},this.resetNodePosition=function(){var o=this;o.nodes.forEach(function(t){t.layoutData.dx*=o.speed/o.SPEED_DIVISOR,t.layoutData.dy*=o.speed/o.SPEED_DIVISOR;var e,n=t.layoutData,i=n.dx,r=n.dy,n=Math.sqrt(n.dx*n.dx+n.dy*n.dy);10<n&&(e=Math.min(o.maxDisplace*(o.speed/o.SPEED_DIVISOR),n),t.x=t.x+i/n*e,t.y=t.y+r/n*e)})},this.newLayoutData=function(){return{dx:0,dy:0}}}kt.prototype=new ut,Mt.prototype=new ut;t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function zt(t,e){return t(e={exports:{}},e.exports),e.exports}function Rt(t,e){for(var n=t.length;n--;)if(Vt(t[n][0],e))return n;return-1}var Vt=function(t,e){return t===e||t!=t&&e!=e},Yt=Array.prototype.splice;function Ut(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Ut.prototype.clear=function(){this.__data__=[],this.size=0},Ut.prototype.delete=function(t){var e=this.__data__,t=Rt(e,t);return!(t<0||(t==e.length-1?e.pop():Yt.call(e,t,1),--this.size,0))},Ut.prototype.get=function(t){var e=this.__data__,t=Rt(e,t);return t<0?void 0:e[t][1]},Ut.prototype.has=function(t){return-1<Rt(this.__data__,t)},Ut.prototype.set=function(t,e){var n=this.__data__,i=Rt(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this};function Wt(t,e){return e=e,t=null==(t=t)?void 0:t[e],!w(e=t)||re(e)||!(ne(e)?he:ae).test(se(e))?void 0:t}var Gt=Ut,qt="object"==typeof t&&t&&t.Object===Object&&t,t="object"==typeof self&&self&&self.Object===Object&&self,r=qt||t||Function("return this")(),t=r.Symbol,e=Object.prototype,Ht=e.hasOwnProperty,Jt=e.toString,Kt=t?t.toStringTag:void 0,Zt=function(t){var e=Ht.call(t,Kt),n=t[Kt];try{var i=!(t[Kt]=void 0)}catch(t){}var r=Jt.call(t);return i&&(e?t[Kt]=n:delete t[Kt]),r},Qt=Object.prototype.toString,$t=function(t){return Qt.call(t)},te=t?t.toStringTag:void 0,ee=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":(te&&te in Object(t)?Zt:$t)(t)},w=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},ne=function(t){return!!w(t)&&("[object Function]"==(t=ee(t))||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t)},e=r["__core-js_shared__"],ie=(e=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||""))?"Symbol(src)_1."+e:"",re=function(t){return!!ie&&ie in t},oe=Function.prototype.toString,se=function(t){if(null!=t){try{return oe.call(t)}catch(t){}try{return t+""}catch(t){}}return""},ae=/^\[object .+?Constructor\]$/,e=Function.prototype,n=Object.prototype,e=e.toString,n=n.hasOwnProperty,he=RegExp("^"+e.call(n).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ce=Wt(r,"Map"),ue=Wt(Object,"create"),le=Object.prototype.hasOwnProperty,de=Object.prototype.hasOwnProperty;function fe(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}fe.prototype.clear=function(){this.__data__=ue?ue(null):{},this.size=0},fe.prototype.delete=function(t){t=this.has(t)&&delete this.__data__[t];return this.size-=t?1:0,t},fe.prototype.get=function(t){var e,n=this.__data__;return ue?"__lodash_hash_undefined__"===(e=n[t])?void 0:e:le.call(n,t)?n[t]:void 0},fe.prototype.has=function(t){var e=this.__data__;return ue?void 0!==e[t]:de.call(e,t)},fe.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=ue&&void 0===e?"__lodash_hash_undefined__":e,this};function pe(t,e){return t=t.__data__,ye(e)?t["string"==typeof e?"string":"hash"]:t.map}var ge=fe,ye=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};function ve(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}ve.prototype.clear=function(){this.size=0,this.__data__={hash:new ge,map:new(ce||Gt),string:new ge}},ve.prototype.delete=function(t){t=pe(this,t).delete(t);return this.size-=t?1:0,t},ve.prototype.get=function(t){return pe(this,t).get(t)},ve.prototype.has=function(t){return pe(this,t).has(t)},ve.prototype.set=function(t,e){var n=pe(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this};var me=ve;function xe(t){t=this.__data__=new Gt(t);this.size=t.size}xe.prototype.clear=function(){this.__data__=new Gt,this.size=0},xe.prototype.delete=function(t){var e=this.__data__,t=e.delete(t);return this.size=e.size,t},xe.prototype.get=function(t){return this.__data__.get(t)},xe.prototype.has=function(t){return this.__data__.has(t)},xe.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Gt){var i=n.__data__;if(!ce||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new me(i)}return n.set(t,e),this.size=n.size,this};function we(t,e,n,i){var r=!n;n=n||{};for(var o=-1,s=e.length;++o<s;){var a=e[o],h=i?i(n[a],t[a],a,n,t):void 0;void 0===h&&(h=t[a]),(r?Oe:Ie)(n,a,h)}return n}function be(t){return o(t)&&"[object Arguments]"==ee(t)}function ke(){return!1}function Me(e){return function(t){return e(t)}}function Ee(e,n){return function(t){return e(n(t))}}function Ce(){return[]}function Ne(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}function Le(t,e,n){return e=e(t),k(t)?e:Ne(e,n(t))}function Se(t){var e=new t.constructor(t.byteLength);return new Ln(e).set(new Ln(t)),e}var _e=xe,Te=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t},Pe=function(){try{var t=Wt(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),Oe=function(t,e,n){"__proto__"==e&&Pe?Pe(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},Ae=Object.prototype.hasOwnProperty,Ie=function(t,e,n){var i=t[e];Ae.call(t,e)&&Vt(i,n)&&(void 0!==n||e in t)||Oe(t,e,n)},De=function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i},o=function(t){return null!=t&&"object"==typeof t},e=Object.prototype,Be=e.hasOwnProperty,ze=e.propertyIsEnumerable,Re=be(function(){return arguments}())?be:function(t){return o(t)&&Be.call(t,"callee")&&!ze.call(t,"callee")},k=Array.isArray,Ve=zt(function(t,e){var e=e&&!e.nodeType&&e,n=e&&t&&!t.nodeType&&t,n=n&&n.exports===e?r.Buffer:void 0,e=(n?n.isBuffer:void 0)||ke;t.exports=e}),je=/^(?:0|[1-9]\d*)$/,Fe=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&je.test(t))&&-1<t&&t%1==0&&t<e},Xe=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991},i={},n=(i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,zt(function(t,e){var e=e&&!e.nodeType&&e,n=e&&t&&!t.nodeType&&t,i=n&&n.exports===e&&qt.process,e=function(){try{return n&&n.require&&n.require("util").types||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=e})),e=n&&n.isTypedArray,Ye=e?Me(e):function(t){return o(t)&&Xe(t.length)&&!!i[ee(t)]},Ue=Object.prototype.hasOwnProperty,We=function(t,e){var n,i=k(t),r=!i&&Re(t),o=!i&&!r&&Ve(t),s=!i&&!r&&!o&&Ye(t),a=i||r||o||s,h=a?De(t.length,String):[],c=h.length;for(n in t)!e&&!Ue.call(t,n)||a&&("length"==n||o&&("offset"==n||"parent"==n)||s&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||Fe(n,c))||h.push(n);return h},Ge=Object.prototype,qe=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ge)},He=Ee(Object.keys,Object),Je=Object.prototype.hasOwnProperty,Ke=function(t){if(!qe(t))return He(t);var e,n=[];for(e in Object(t))Je.call(t,e)&&"constructor"!=e&&n.push(e);return n},Ze=function(t){return null!=t&&Xe(t.length)&&!ne(t)},Qe=function(t){return(Ze(t)?We:Ke)(t)},$e=function(t,e){return t&&we(e,Qe(e),t)},tn=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e},en=Object.prototype.hasOwnProperty,nn=function(t){if(Ze(t))return We(t,!0);var e=t;if(!w(e))return tn(e);var n,i=qe(e),r=[];for(n in e)("constructor"!=n||!i&&en.call(e,n))&&r.push(n);return r},rn=function(t,e){return t&&we(e,nn(e),t)},on=zt(function(t,e){var e=e&&!e.nodeType&&e,n=e&&t&&!t.nodeType&&t,n=n&&n.exports===e?r.Buffer:void 0,i=n?n.allocUnsafe:void 0;t.exports=function(t,e){return e?t.slice():(e=t.length,e=i?i(e):new t.constructor(e),t.copy(e),e)}}),sn=function(t,e){var n=-1,i=t.length;for(e=e||Array(i);++n<i;)e[n]=t[n];return e},an=function(t,e){for(var n=-1,i=null==t?0:t.length,r=0,o=[];++n<i;){var s=t[n];e(s,n,t)&&(o[r++]=s)}return o},hn=Object.prototype.propertyIsEnumerable,cn=Object.getOwnPropertySymbols,un=cn?function(e){return null==e?[]:(e=Object(e),an(cn(e),function(t){return hn.call(e,t)}))}:Ce,ln=function(t,e){return we(t,un(t),e)},dn=Ee(Object.getPrototypeOf,Object),fn=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Ne(e,un(t)),t=dn(t);return e}:Ce,pn=function(t,e){return we(t,fn(t),e)},gn=function(t){return Le(t,Qe,un)},yn=function(t){return Le(t,nn,fn)},e=Wt(r,"DataView"),u=Wt(r,"Promise"),vn=Wt(r,"Set"),l=Wt(r,"WeakMap"),mn=se(e),xn=se(ce),wn=se(u),bn=se(vn),kn=se(l),Mn=ee,En=Mn=e&&"[object DataView]"!=Mn(new e(new ArrayBuffer(1)))||ce&&"[object Map]"!=Mn(new ce)||u&&"[object Promise]"!=Mn(u.resolve())||vn&&"[object Set]"!=Mn(new vn)||l&&"[object WeakMap]"!=Mn(new l)?function(t){var e=ee(t),t="[object Object]"==e?t.constructor:void 0,t=t?se(t):"";if(t)switch(t){case mn:return"[object DataView]";case xn:return"[object Map]";case wn:return"[object Promise]";case bn:return"[object Set]";case kn:return"[object WeakMap]"}return e}:Mn,Cn=Object.prototype.hasOwnProperty,Nn=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Cn.call(t,"index")&&(n.index=t.index,n.input=t.input),n},Ln=r.Uint8Array,Sn=/\w*$/,e=t?t.prototype:void 0,_n=e?e.valueOf:void 0,Tn=function(t,e){e=e?Se(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)},Pn=function(t,e,n){var i,r=t.constructor;switch(e){case"[object ArrayBuffer]":return Se(t);case"[object Boolean]":case"[object Date]":return new r(+t);case"[object DataView]":var o=t,s=n;return s=n?Se(o.buffer):o.buffer,new o.constructor(s,o.byteOffset,o.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Tn(t,n);case"[object Map]":return new r;case"[object Number]":case"[object String]":return new r(t);case"[object RegExp]":return(o=new(s=t).constructor(s.source,Sn.exec(s))).lastIndex=s.lastIndex,o;case"[object Set]":return new r;case"[object Symbol]":return i=t,_n?Object(_n.call(i)):{}}},On=Object.create,An=function(t){if(!w(t))return{};if(On)return On(t);In.prototype=t;t=new In;return In.prototype=void 0,t};function In(){}function Dn(n,i,r,t,e,o){var s,a=1&i,h=2&i,c=4&i;if(void 0===(s=r?e?r(n,t,e,o):r(n):s)){if(!w(n))return n;t=k(n);if(t){if(s=Nn(n),!a)return sn(n,s)}else{var u=En(n),l="[object Function]"==u||"[object GeneratorFunction]"==u;if(Ve(n))return on(n,a);if("[object Object]"==u||"[object Arguments]"==u||l&&!e){if(s=h||l?{}:Fn(n),!a)return h?pn(n,rn(s,n)):ln(n,$e(s,n))}else{if(!f[u])return e?n:{};s=Pn(n,u,a)}}l=(o=o||new _e).get(n);if(l)return l;o.set(n,s),Yn(n)?n.forEach(function(t){s.add(Dn(t,i,r,t,n,o))}):Xn(n)&&n.forEach(function(t,e){s.set(e,Dn(t,i,r,e,n,o))});var d=t?void 0:(c?h?yn:gn:h?nn:Qe)(n);Te(d||n,function(t,e){d&&(t=n[e=t]),Ie(s,e,Dn(t,i,r,e,n,o))})}return s}function Bn(t){return function(){return t}}function zn(t){return"function"==typeof t?t:qn}function Rn(t,e){return(k(t)?Te:Gn)(t,zn(e))}function Vn(t,i){var r=[];return Gn(t,function(t,e,n){i(t,e,n)&&r.push(t)}),r}var jn,Fn=function(t){return"function"!=typeof t.constructor||qe(t)?{}:An(dn(t))},u=n&&n.isMap,Xn=u?Me(u):function(t){return o(t)&&"[object Map]"==En(t)},l=n&&n.isSet,Yn=l?Me(l):function(t){return o(t)&&"[object Set]"==En(t)},f={},Un=(f["[object Arguments]"]=f["[object Array]"]=f["[object ArrayBuffer]"]=f["[object DataView]"]=f["[object Boolean]"]=f["[object Date]"]=f["[object Float32Array]"]=f["[object Float64Array]"]=f["[object Int8Array]"]=f["[object Int16Array]"]=f["[object Int32Array]"]=f["[object Map]"]=f["[object Number]"]=f["[object Object]"]=f["[object RegExp]"]=f["[object Set]"]=f["[object String]"]=f["[object Symbol]"]=f["[object Uint8Array]"]=f["[object Uint8ClampedArray]"]=f["[object Uint16Array]"]=f["[object Uint32Array]"]=!0,f["[object Error]"]=f["[object Function]"]=f["[object WeakMap]"]=!1,function(t,e,n){for(var i=-1,r=Object(t),o=n(t),s=o.length;s--;){var a=o[++i];if(!1===e(r[a],a,r))break}return t}),Wn=function(t,e){return t&&Un(t,e,Qe)},Gn=(jn=Wn,function(t,e){if(null!=t){if(!Ze(t))return jn(t,e);for(var n=t.length,i=-1,r=Object(t);++i<n&&!1!==e(r[i],i,r););}return t}),qn=function(t){return t},Mn=Rn;function Hn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new me;++e<n;)this.add(t[e])}Hn.prototype.add=Hn.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Hn.prototype.has=function(t){return this.__data__.has(t)};function Jn(t,e){return t.has(e)}function Kn(t,e,n,i,r,o){var s=1&n,a=t.length,h=e.length;if(a!=h&&!(s&&a<h))return!1;var h=o.get(t),c=o.get(e);if(h&&c)return h==e&&c==t;var u=-1,l=!0,d=2&n?new ri:void 0;for(o.set(t,e),o.set(e,t);++u<a;){var f,p=t[u],g=e[u];if(void 0!==(f=i?s?i(g,p,u,e,t,o):i(p,g,u,t,e,o):f)){if(f)continue;l=!1;break}if(d){if(!function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}(e,function(t,e){return!Jn(d,e)&&(p===t||r(p,t,n,i,o))&&d.push(e)})){l=!1;break}}else if(p!==g&&!r(p,g,n,i,o)){l=!1;break}}return o.delete(t),o.delete(e),l}function Zn(t){var n=-1,i=Array(t.size);return t.forEach(function(t,e){i[++n]=[e,t]}),i}function Qn(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function $n(t,e,n,i,r,o){var s=k(t),a=k(e),h=s?"[object Array]":En(t),a=a?"[object Array]":En(e),c="[object Object]"==(h="[object Arguments]"==h?"[object Object]":h),u="[object Object]"==(a="[object Arguments]"==a?"[object Object]":a);if((a=h==a)&&Ve(t)){if(!Ve(e))return!1;c=!(s=!0)}if(a&&!c){o=o||new _e;if(s||Ye(t))return Kn(t,e,n,i,r,o);else{var l=t;var d=e;s=h;var f=n;var p=i;var g=r;var y=o;switch(s){case"[object DataView]":if(l.byteLength!=d.byteLength||l.byteOffset!=d.byteOffset)return!1;l=l.buffer,d=d.buffer;case"[object ArrayBuffer]":return!(l.byteLength!=d.byteLength||!g(new Ln(l),new Ln(d)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Vt(+l,+d);case"[object Error]":return l.name==d.name&&l.message==d.message;case"[object RegExp]":case"[object String]":return l==d+"";case"[object Map]":var v=Zn;case"[object Set]":v=v||Qn;if(l.size!=d.size&&!(1&f))return!1;var m=y.get(l);if(m)return m==d;f|=2,y.set(l,d);m=Kn(v(l),v(d),f,p,g,y);return y.delete(l),m;case"[object Symbol]":if(oi)return oi.call(l)==oi.call(d)}return!1;return}}if(!(1&n)){h=c&&ai.call(t,"__wrapped__"),s=u&&ai.call(e,"__wrapped__");if(h||s)return r(h?t.value():t,s?e.value():e,n,i,o=o||new _e)}return!!a&&function(t,e,n,i,r,o){var s=1&n,a=gn(t),h=a.length;if(h!=gn(e).length&&!s)return!1;for(var c=h;c--;){var u=a[c];if(!(s?u in e:si.call(e,u)))return!1}var l=o.get(t),d=o.get(e);if(l&&d)return l==e&&d==t;var f=!0;o.set(t,e),o.set(e,t);for(var p=s;++c<h;){var g,y=t[u=a[c]],v=e[u];if(!(void 0===(g=i?s?i(v,y,u,e,t,o):i(y,v,u,t,e,o):g)?y===v||r(y,v,n,i,o):g)){f=!1;break}p=p||"constructor"==u}return f&&!p&&(l=t.constructor)!=(d=e.constructor)&&"constructor"in t&&"constructor"in e&&!("function"==typeof l&&l instanceof l&&"function"==typeof d&&d instanceof d)&&(f=!1),o.delete(t),o.delete(e),f}(t,e,n,i,r,o=o||new _e)}function ti(t,e,n,i,r){return t===e||(null==t||null==e||!o(t)&&!o(e)?t!=t&&e!=e:$n(t,e,n,i,ti,r))}function ei(t){return t==t&&!w(t)}function ni(e,n){return function(t){return null!=t&&t[e]===n&&(void 0!==n||e in Object(t))}}function ii(t,e){var n;return!k(t)&&(!("number"!=(n=typeof t)&&"symbol"!=n&&"boolean"!=n&&null!=t&&!ci(t))||li.test(t)||!ui.test(t)||null!=e&&t in Object(e))}var ri=Hn,e=t?t.prototype:void 0,oi=e?e.valueOf:void 0,si=Object.prototype.hasOwnProperty,ai=Object.prototype.hasOwnProperty,hi=function(e){var n=function(t){for(var e=Qe(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,ei(r)]}return e}(e);return 1==n.length&&n[0][2]?ni(n[0][0],n[0][1]):function(t){return t===e||function(t,e,n,i){var r=n.length,o=r,s=!i;if(null==t)return!o;for(t=Object(t);r--;){var a=n[r];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++r<o;){var h=(a=n[r])[0],c=t[h],u=a[1];if(s&&a[2]){if(void 0===c&&!(h in t))return!1}else{var l,d=new _e;if(!(void 0===(l=i?i(c,u,h,t,e,d):l)?ti(u,c,3,i,d):l))return!1}}return!0}(t,e,n)}},ci=function(t){return"symbol"==typeof t||o(t)&&"[object Symbol]"==ee(t)},ui=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,li=/^\w*$/;function di(i,r){if("function"!=typeof i||null!=r&&"function"!=typeof r)throw new TypeError("Expected a function");function o(){var t=arguments,e=r?r.apply(this,t):t[0],n=o.cache;return n.has(e)?n.get(e):(t=i.apply(this,t),o.cache=n.set(e,t)||n,t)}return o.cache=new(di.Cache||me),o}di.Cache=me;function fi(t){return null==t?"":Ui(t)}function pi(t,e){return null!=t&&Ji(t,e,Hi)}function gi(e){return function(t){return null==t?void 0:t[e]}}function yi(t){return"function"==typeof t?t:null==t?qn:"object"==typeof t?k(t)?Ki(t[0],t[1]):hi(t):Zi(t)}function vi(t,e){return(k(t)?an:Vn)(t,yi(e))}function mi(t,e){return null!=t&&Qi.call(t,e)}function xi(t,e){return null!=t&&Ji(t,e,mi)}function wi(t){return void 0===t}function bi(t,e){return(k(t)?Xi:tr)(t,yi(e))}function ki(t,e,n,i){var r=-1,o=null==t?0:t.length;for(i&&o&&(n=t[++r]);++r<o;)n=e(n,t[r],r,t);return n}function Mi(t,i,r,o,e){return e(t,function(t,e,n){r=o?(o=!1,t):i(r,t,e,n)}),r}function Ei(t,e,n){var i=k(t)?ki:Mi,r=arguments.length<3;return i(t,yi(e),n,r,Gn)}function Ci(t){var e;return null==t?0:Ze(t)?"string"==typeof(e=t)||!k(e)&&o(e)&&"[object String]"==ee(e)?(ir(e=t)?sr:er)(e):t.length:"[object Map]"==(e=En(t))||"[object Set]"==e?t.size:Ke(t).length}function Ni(t){return k(t)||Re(t)||!!(ar&&t&&t[ar])}function Li(t,e,n,i,r){var o=-1,s=t.length;for(n=n||Ni,r=r||[];++o<s;){var a=t[o];0<e&&n(a)?1<e?Li(a,e-1,n,i,r):Ne(r,a):i||(r[r.length]=a)}return r}function Si(o,s,a){return s=cr(void 0===s?o.length-1:s,0),function(){for(var t=arguments,e=-1,n=cr(t.length-s,0),i=Array(n);++e<n;)i[e]=t[s+e];for(var e=-1,r=Array(s+1);++e<s;)r[e]=t[e];return r[s]=a(i),hr(o,this,r)}}function _i(t,e){return lr(Si(t,e,qn),t+"")}function Ti(t,e,n,i){for(var r=t.length,o=n+(i?1:-1);i?o--:++o<r;)if(e(t[o],o,t))return o;return-1}function Pi(t){return t!=t}function Oi(t,e){return!(null==t||!t.length)&&-1<dr(t,e,0)}function Ai(t,e,n){for(var i=-1,r=null==t?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}function Ii(t){return null==t?[]:(t=Qe(e=t),Xi(t,function(t){return e[t]}));var e}var Di,Bi,zi,Ri,Vi=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ji=/\\(\\)?/g,Fi=(Di=(u=di(function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(Vi,function(t,e,n,i){r.push(n?i.replace(ji,"$1"):e||t)}),r},function(t){return 500===Di.size&&Di.clear(),t})).cache,u),Xi=function(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r},n=t?t.prototype:void 0,Yi=n?n.toString:void 0,Ui=function t(e){var n;return"string"==typeof e?e:k(e)?Xi(e,t)+"":ci(e)?Yi?Yi.call(e):"":"0"==(n=e+"")&&1/e==-1/0?"-0":n},Wi=function(t,e){return k(t)?t:ii(t,e)?[t]:Fi(fi(t))},Gi=function(t){var e;return"string"==typeof t||ci(t)?t:"0"==(e=t+"")&&1/t==-1/0?"-0":e},qi=function(t,e){for(var n=0,i=(e=Wi(e,t)).length;null!=t&&n<i;)t=t[Gi(e[n++])];return n&&n==i?t:void 0},Hi=function(t,e){return null!=t&&e in Object(t)},Ji=function(t,e,n){for(var i=-1,r=(e=Wi(e,t)).length,o=!1;++i<r;){var s=Gi(e[i]);if(!(o=null!=t&&n(t,s)))break;t=t[s]}return o||++i!=r?o:!!(r=null==t?0:t.length)&&Xe(r)&&Fe(s,r)&&(k(t)||Re(t))},Ki=function(n,i){return ii(n)&&ei(i)?ni(Gi(n),i):function(t){var e=function(t,e,n){t=null==t?void 0:qi(t,e);return void 0===t?n:t}(t,n);return void 0===e&&e===i?pi(t,n):ti(i,e,3)}},Zi=function(t){return ii(t)?gi(Gi(t)):(e=t,function(t){return qi(t,e)});var e},Qi=Object.prototype.hasOwnProperty,$i=Object.prototype.hasOwnProperty,tr=function(t,i){var r=-1,o=Ze(t)?Array(t.length):[];return Gn(t,function(t,e,n){o[++r]=i(t,e,n)}),o},er=gi("length"),nr=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),ir=function(t){return nr.test(t)},l="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",e="\\ud83c[\\udffb-\\udfff]",u="[^\\ud800-\\udfff]",n="(?:\\ud83c[\\udde6-\\uddff]){2}",rr="[\\ud800-\\udbff][\\udc00-\\udfff]",d="(?:"+l+"|"+e+")?",d="[\\ufe0e\\ufe0f]?"+d+"(?:\\u200d(?:"+[u,n,rr].join("|")+")[\\ufe0e\\ufe0f]?"+d+")*",u="(?:"+[u+l+"?",l,n,rr,"[\\ud800-\\udfff]"].join("|")+")",or=RegExp(e+"(?="+e+")|"+u+d,"g"),sr=function(t){for(var e=or.lastIndex=0;or.test(t);)++e;return e},ar=t?t.isConcatSpreadable:void 0,hr=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)},cr=Math.max,l=Pe?function(t,e){return Pe(t,"toString",{configurable:!0,enumerable:!1,value:Bn(e),writable:!0})}:qn,ur=Date.now,lr=(Bi=l,Ri=zi=0,function(){var t=ur(),e=16-(t-Ri);if(Ri=t,0<e){if(800<=++zi)return arguments[0]}else zi=0;return Bi.apply(void 0,arguments)}),dr=function(t,e,n){if(e!=e)return Ti(t,Pi,n);for(var i=t,r=e,o=n-1,s=i.length;++o<s;)if(i[o]===r)return o;return-1},fr=vn&&1/Qn(new vn([,-0]))[1]==1/0?function(t){return new vn(t)}:function(){},pr=function(t){return o(t)&&Ze(t)},n=_i(function(t){var e=Li(t,1,pr,!0),n=void 0,i=void 0,r=-1,o=Oi,s=e.length,a=!0,h=[],c=h;if(i)a=!1,o=Ai;else if(200<=s){t=n?null:fr(e);if(t)return Qn(t);a=!1,o=Jn,c=new ri}else c=n?[]:h;t:for(;++r<s;){var u=e[r],l=n?n(u):u,u=i||0!==u?u:0;if(a&&l==l){for(var d=c.length;d--;)if(c[d]===l)continue t;n&&c.push(l),h.push(u)}else o(c,l,i)||(c!==h&&c.push(l),h.push(u))}return h});try{so={clone:function(t){return Dn(t,4)},constant:Bn,each:Mn,filter:vi,has:xi,isArray:k,isEmpty:function(t){if(null!=t){if(Ze(t)&&(k(t)||"string"==typeof t||"function"==typeof t.splice||Ve(t)||Ye(t)||Re(t)))return!t.length;var e,n=En(t);if("[object Map]"==n||"[object Set]"==n)return!t.size;if(qe(t))return!Ke(t).length;for(e in t)if($i.call(t,e))return!1}return!0},isFunction:ne,isUndefined:wi,keys:Qe,map:bi,reduce:Ei,size:Ci,transform:function(t,i,r){var e,n=k(t),o=n||Ve(t)||Ye(t);return i=yi(i),null==r&&(e=t&&t.constructor,r=o?n?new e:[]:w(t)&&ne(e)?An(dn(t)):{}),(o?Te:Wn)(t,function(t,e,n){return i(r,t,e,n)}),r},union:n,values:Ii}}catch(D){}var p=so=so||window._,gr=g;function g(t){this._isDirected=!p.has(t,"directed")||t.directed,this._isMultigraph=!!p.has(t,"multigraph")&&t.multigraph,this._isCompound=!!p.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=p.constant(void 0),this._defaultEdgeLabelFn=p.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function yr(t,e){t[e]?t[e]++:t[e]=1}function vr(t,e){--t[e]||delete t[e]}function mr(t,e,n,i){e=""+e,n=""+n;return!t&&n<e&&(t=e,e=n,n=t),e+""+n+""+(p.isUndefined(i)?"\0":i)}function xr(t,e){return mr(t,e.v,e.w,e.name)}g.prototype._nodeCount=0,g.prototype._edgeCount=0,g.prototype.isDirected=function(){return this._isDirected},g.prototype.isMultigraph=function(){return this._isMultigraph},g.prototype.isCompound=function(){return this._isCompound},g.prototype.setGraph=function(t){return this._label=t,this},g.prototype.graph=function(){return this._label},g.prototype.setDefaultNodeLabel=function(t){return p.isFunction(t)||(t=p.constant(t)),this._defaultNodeLabelFn=t,this},g.prototype.nodeCount=function(){return this._nodeCount},g.prototype.nodes=function(){return p.keys(this._nodes)},g.prototype.sources=function(){var e=this;return p.filter(this.nodes(),function(t){return p.isEmpty(e._in[t])})},g.prototype.sinks=function(){var e=this;return p.filter(this.nodes(),function(t){return p.isEmpty(e._out[t])})},g.prototype.setNodes=function(t,e){var n=arguments,i=this;return p.each(t,function(t){1<n.length?i.setNode(t,e):i.setNode(t)}),this},g.prototype.setNode=function(t,e){return p.has(this._nodes,t)?1<arguments.length&&(this._nodes[t]=e):(this._nodes[t]=1<arguments.length?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]="\0",this._children[t]={},this._children["\0"][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount),this},g.prototype.node=function(t){return this._nodes[t]},g.prototype.hasNode=function(t){return p.has(this._nodes,t)},g.prototype.removeNode=function(t){var e,n=this;return p.has(this._nodes,t)&&(e=function(t){n.removeEdge(n._edgeObjs[t])},delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],p.each(this.children(t),function(t){n.setParent(t)}),delete this._children[t]),p.each(p.keys(this._in[t]),e),delete this._in[t],delete this._preds[t],p.each(p.keys(this._out[t]),e),delete this._out[t],delete this._sucs[t],--this._nodeCount),this},g.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(p.isUndefined(e))e="\0";else{for(var n=e+="";!p.isUndefined(n);n=this.parent(n))if(n===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},g.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},g.prototype.parent=function(t){if(this._isCompound){t=this._parent[t];if("\0"!==t)return t}},g.prototype.children=function(t){var e;return p.isUndefined(t)&&(t="\0"),this._isCompound?(e=this._children[t])?p.keys(e):void 0:"\0"===t?this.nodes():this.hasNode(t)?[]:void 0},g.prototype.predecessors=function(t){t=this._preds[t];if(t)return p.keys(t)},g.prototype.successors=function(t){t=this._sucs[t];if(t)return p.keys(t)},g.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return p.union(e,this.successors(t))},g.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},g.prototype.filterNodes=function(n){var i=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound}),r=(i.setGraph(this.graph()),this),o=(p.each(this._nodes,function(t,e){n(e)&&i.setNode(e,t)}),p.each(this._edgeObjs,function(t){i.hasNode(t.v)&&i.hasNode(t.w)&&i.setEdge(t,r.edge(t))}),{});return this._isCompound&&p.each(i.nodes(),function(t){i.setParent(t,function t(e){var n=r.parent(e);return void 0===n||i.hasNode(n)?o[e]=n:n in o?o[n]:t(n)}(t))}),i},g.prototype.setDefaultEdgeLabel=function(t){return p.isFunction(t)||(t=p.constant(t)),this._defaultEdgeLabelFn=t,this},g.prototype.edgeCount=function(){return this._edgeCount},g.prototype.edges=function(){return p.values(this._edgeObjs)},g.prototype.setPath=function(t,n){var i=this,r=arguments;return p.reduce(t,function(t,e){return 1<r.length?i.setEdge(t,e,n):i.setEdge(t,e),e}),this},g.prototype.setEdge=function(){var t,e=!1,n=arguments[0],n=("object"==typeof n&&null!==n&&"v"in n?(o=n.v,s=n.w,t=n.name,2===arguments.length&&(i=arguments[1],e=!0)):(o=n,s=arguments[1],t=arguments[3],2<arguments.length&&(i=arguments[2],e=!0)),o=""+o,s=""+s,p.isUndefined(t)||(t=""+t),mr(this._isDirected,o,s,t));if(p.has(this._edgeLabels,n))e&&(this._edgeLabels[n]=i);else{if(!p.isUndefined(t)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(o),this.setNode(s),this._edgeLabels[n]=e?i:this._defaultEdgeLabelFn(o,s,t);e=this._isDirected,i=""+(i=o),r=""+(r=s),!e&&r<i&&(e=i,i=r,r=e),e={v:i,w:r},(r=t)&&(e.name=r);var i,r=e,o=r.v,s=r.w;Object.freeze(r),this._edgeObjs[n]=r,yr(this._preds[s],o),yr(this._sucs[o],s),this._in[s][n]=r,this._out[o][n]=r,this._edgeCount++}return this},g.prototype.edge=function(t,e,n){t=1===arguments.length?xr(this._isDirected,t):mr(this._isDirected,t,e,n);return this._edgeLabels[t]},g.prototype.hasEdge=function(t,e,n){t=1===arguments.length?xr(this._isDirected,t):mr(this._isDirected,t,e,n);return p.has(this._edgeLabels,t)},g.prototype.removeEdge=function(t,e,n){var n=1===arguments.length?xr(this._isDirected,arguments[0]):mr(this._isDirected,t,e,n),i=this._edgeObjs[n];return i&&(t=i.v,e=i.w,delete this._edgeLabels[n],delete this._edgeObjs[n],vr(this._preds[e],t),vr(this._sucs[t],e),delete this._in[e][n],delete this._out[t][n],this._edgeCount--),this},g.prototype.inEdges=function(t,e){var t=this._in[t];if(t)return t=p.values(t),e?p.filter(t,function(t){return t.v===e}):t},g.prototype.outEdges=function(t,e){var t=this._out[t];if(t)return t=p.values(t),e?p.filter(t,function(t){return t.w===e}):t},g.prototype.nodeEdges=function(t,e){var n=this.inEdges(t,e);if(n)return n.concat(this.outEdges(t,e))};rr={Graph:gr,version:"2.1.8"},e={write:function(t){var i,r,e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:(r=t,p.map(r.nodes(),function(t){var e=r.node(t),n=r.parent(t),t={v:t};return p.isUndefined(e)||(t.value=e),p.isUndefined(n)||(t.parent=n),t})),edges:(i=t,p.map(i.edges(),function(t){var e=i.edge(t),n={v:t.v,w:t.w};return p.isUndefined(t.name)||(n.name=t.name),p.isUndefined(e)||(n.value=e),n}))};return p.isUndefined(t.graph())||(e.value=p.clone(t.graph())),e},read:function(t){var e=new gr(t.options).setGraph(t.value);return p.each(t.nodes,function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)}),p.each(t.edges,function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)}),e}};var wr=y;function y(){this._arr=[],this._keyIndices={}}y.prototype.size=function(){return this._arr.length},y.prototype.keys=function(){return this._arr.map(function(t){return t.key})},y.prototype.has=function(t){return p.has(this._keyIndices,t)},y.prototype.priority=function(t){t=this._keyIndices[t];if(void 0!==t)return this._arr[t].priority},y.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},y.prototype.add=function(t,e){var n,i,r=this._keyIndices;return t=String(t),!p.has(r,t)&&(i=(n=this._arr).length,r[t]=i,n.push({key:t,priority:e}),this._decrease(i),!0)},y.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},y.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},y.prototype._heapify=function(t){var e=this._arr,n=2*t,i=1+n,r=t;n<e.length&&(r=e[n].priority<e[r].priority?n:r,(r=i<e.length?e[i].priority<e[r].priority?i:r:r)!==t)&&(this._swap(t,r),this._heapify(r))},y.prototype._decrease=function(t){for(var e,n=this._arr,i=n[t].priority;0!==t&&!(n[e=t>>1].priority<i);)this._swap(t,e),t=e},y.prototype._swap=function(t,e){var n=this._arr,i=this._keyIndices,r=n[t],o=n[e];n[t]=o,n[e]=r,i[o.key]=t,i[r.key]=e};function br(e,t,n,i){var r=e,o=String(t),s=n||Mr,a=i||function(t){return e.outEdges(t)};function h(t){var e=t.v!==c?t.v:t.w,n=l[e],i=s(t),r=u.distance+i;if(i<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+i);r<n.distance&&(n.distance=r,n.predecessor=c,d.decrease(e,r))}var c,u,l={},d=new wr;for(r.nodes().forEach(function(t){var e=t===o?0:Number.POSITIVE_INFINITY;l[t]={distance:e},d.add(t,e)});0<d.size()&&(c=d.removeMin(),(u=l[c]).distance!==Number.POSITIVE_INFINITY);)a(c).forEach(h);return l}function kr(o){var s=0,a=[],h={},c=[];return o.nodes().forEach(function(t){p.has(h,t)||function e(t){var n=h[t]={onStack:!0,lowlink:s,index:s++};if(a.push(t),o.successors(t).forEach(function(t){p.has(h,t)?h[t].onStack&&(n.lowlink=Math.min(n.lowlink,h[t].index)):(e(t),n.lowlink=Math.min(n.lowlink,h[t].lowlink))}),n.lowlink===n.index){for(var i,r=[];i=a.pop(),h[i].onStack=!1,r.push(i),t!==i;);c.push(r)}}(t)}),c}var Mr=p.constant(1),Er=p.constant(1),Cr=Nr;function Nr(n){var i={},r={},o=[];if(p.each(n.sinks(),function t(e){if(p.has(r,e))throw new Lr;p.has(i,e)||(r[e]=!0,i[e]=!0,p.each(n.predecessors(e),t),delete r[e],o.push(e))}),p.size(i)!==n.nodeCount())throw new Lr;return o}function Lr(){}(Nr.CycleException=Lr).prototype=new Error;function Sr(e,t,n){p.isArray(t)||(t=[t]);var i=(e.isDirected()?e.successors:e.neighbors).bind(e),r=[],o={};return p.each(t,function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);!function e(n,t,i,r,o,s){p.has(r,t)||(r[t]=!0,i||s.push(t),p.each(o(t),function(t){e(n,t,i,r,o,s)}),i&&s.push(t))}(e,t,"post"===n,o,i,r)}),r}u={Graph:rr.Graph,json:e,alg:{components:function(e){var n,i={},r=[];function o(t){p.has(i,t)||(i[t]=!0,n.push(t),p.each(e.successors(t),o),p.each(e.predecessors(t),o))}return p.each(e.nodes(),function(t){n=[],o(t),n.length&&r.push(n)}),r},dijkstra:br,dijkstraAll:function(n,i,r){return p.transform(n.nodes(),function(t,e){t[e]=br(n,e,i,r)},{})},findCycles:function(e){return p.filter(kr(e),function(t){return 1<t.length||1===t.length&&e.hasEdge(t[0],t[0])})},floydWarshall:function(e,t,n){return i=t||Er,r=n||function(t){return e.outEdges(t)},s={},(a=e.nodes()).forEach(function(n){s[n]={},s[n][n]={distance:0},a.forEach(function(t){n!==t&&(s[n][t]={distance:Number.POSITIVE_INFINITY})}),r(n).forEach(function(t){var e=t.v===n?t.w:t.v,t=i(t);s[n][e]={distance:t,predecessor:n}})}),a.forEach(function(r){var o=s[r];a.forEach(function(t){var i=s[t];a.forEach(function(t){var e=i[r],n=o[t],t=i[t],e=e.distance+n.distance;e<t.distance&&(t.distance=e,t.predecessor=n.predecessor)})})}),s;var i,r,s,a},isAcyclic:function(t){try{Cr(t)}catch(t){if(t instanceof Cr.CycleException)return!1;throw t}return!0},postorder:function(t,e){return Sr(t,e,"post")},preorder:function(t,e){return Sr(t,e,"pre")},prim:function(t,i){var r,e=new gr,o={},s=new wr;function n(t){var e=t.v===r?t.w:t.v,n=s.priority(e);void 0!==n&&(t=i(t))<n&&(o[e]=r,s.decrease(e,t))}if(0!==t.nodeCount()){p.each(t.nodes(),function(t){s.add(t,Number.POSITIVE_INFINITY),e.setNode(t)}),s.decrease(t.nodes()[0],0);for(var a=!1;0<s.size();){if(r=s.removeMin(),p.has(o,r))e.setEdge(r,o[r]);else{if(a)throw new Error("Input graph is not connected: "+t);a=!0}t.nodeEdges(r).forEach(n)}}return e},tarjan:kr,topsort:Cr},version:rr.version};try{Ca=u}catch(D){}function _r(t,e,n){var i;return!!w(n)&&!!("number"==(i=typeof e)?Ze(n)&&Fe(e,n.length):"string"==i&&e in n)&&Vt(n[e],t)}function Tr(t){return t&&t.slice(0,function(t){for(var e=t.length;e--&&Wr.test(t.charAt(e)););return e}(t)+1).replace(Gr,"")}function Pr(t){return t?(t=Zr(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function Or(t,e,n){var i,r=Object(t);return Ze(t)||(i=yi(e),t=Qe(t),e=function(t){return i(r[t],t,r)}),-1<(e=Fr(t,e,n))?r[i?t[e]:e]:void 0}function Ar(t){return null!=t&&t.length?Li(t,1):[]}function Ir(t,e,n){for(var i=-1,r=t.length;++i<r;){var o,s,a=t[i],h=e(a);null!=h&&(void 0===o?h==h&&!ci(h):n(h,o))&&(o=h,s=a)}return s}function Dr(t,e){return e<t}function Br(g,y,v,m,x){g!==y&&Un(y,function(t,e){var n,i,r,o,s,a,h,c,u,l,d,f,p;x=x||new _e,w(t)?(i=y,o=v,s=Br,a=m,h=x,d=ro(n=g,r=e),f=ro(i,r),(p=h.get(f))?$r(n,r,p):((i=void 0===(p=a?a(d,f,r+"",n,i,h):void 0))&&(u=!(c=k(f))&&Ve(f),l=!c&&!u&&Ye(f),p=f,c||u||l?p=k(d)?d:pr(d)?sn(d):u?on(f,!(i=!1)):l?Tn(f,!(i=!1)):[]:io(f)||Re(f)?Re(p=d)?p=oo(d):w(d)&&!ne(d)||(p=Fn(f)):i=!1),i&&(h.set(f,p),s(p,f,o,a,h),h.delete(f)),$r(n,r,p))):(c=m?m(ro(g,e),t,e+"",g,y,x):void 0,$r(g,e,c=void 0===c?t:c))},nn)}function zr(t,e){return t<e}function Rr(n,t){for(var e=n,i=t,r=function(t,e){return pi(n,e)},o=-1,s=i.length,a={};++o<s;){var h=i[o],c=qi(e,h);r(c,h)&&ao(a,Wi(h,e),c)}return a}function Vr(t,e,n){n&&"number"!=typeof n&&_r(t,e,n)&&(e=n=void 0),t=Pr(t),void 0===e?(e=t,t=0):e=Pr(e),n=void 0===n?t<e?1:-1:Pr(n);for(var i=t,r=n,o=void 0,s=-1,a=co(ho((e-i)/(r||1)),0),h=Array(a);a--;)h[o?a:++s]=i,i+=r;return h}function jr(t,i,c){i=i.length?Xi(i,function(e){return k(e)?function(t){return qi(t,1===e.length?e[0]:e)}:e}):[qn];var r=-1,e=(i=Xi(i,Me(yi)),tr(t,function(e,t,n){return{criteria:Xi(i,function(t){return t(e)}),index:++r,value:e}})),t=function(t,e){for(var n=c,i=-1,r=t.criteria,o=e.criteria,s=r.length,a=n.length;++i<s;){var h=uo(r[i],o[i]);if(h)return a<=i?h:h*("desc"==n[i]?-1:1)}return t.index-e.index},n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var Fr,Xr,d=Ca=Ca||window.graphlib,Yr=Object.prototype,Ur=Yr.hasOwnProperty,t=_i(function(t,e){t=Object(t);var n=-1,i=e.length,r=2<i?e[2]:void 0;for(r&&_r(e[0],e[1],r)&&(i=1);++n<i;)for(var o=e[n],s=nn(o),a=-1,h=s.length;++a<h;){var c=s[a],u=t[c];(void 0===u||Vt(u,Yr[c])&&!Ur.call(t,c))&&(t[c]=o[c])}return t}),Wr=/\s/,Gr=/^\s+/,qr=/^[-+]0x[0-9a-f]+$/i,Hr=/^0b[01]+$/i,Jr=/^0o[0-7]+$/i,Kr=parseInt,Zr=function(t){if("number"==typeof t)return t;if(ci(t))return NaN;if(w(t)&&(e="function"==typeof t.valueOf?t.valueOf():t,t=w(e)?e+"":e),"string"!=typeof t)return 0===t?t:+t;t=Tr(t);var e=Hr.test(t);return e||Jr.test(t)?Kr(t.slice(2),e?2:8):qr.test(t)?NaN:+t},Qr=Math.max,$r=(Fr=function(t,e,n){var i,r=null==t?0:t.length;return r?((i=null!=n&&(n=Pr(n=n),i=n%1,n==n)?i?n-i:n:0)<0&&(i=Qr(r+i,0)),Ti(t,yi(e),i)):-1},function(t,e,n){(void 0===n||Vt(t[e],n))&&(void 0!==n||e in t)||Oe(t,e,n)}),l=Function.prototype,n=Object.prototype,to=l.toString,eo=n.hasOwnProperty,no=to.call(Object),io=function(t){return!(!o(t)||"[object Object]"!=ee(t))&&(null===(t=dn(t))||"function"==typeof(t=eo.call(t,"constructor")&&t.constructor)&&t instanceof t&&to.call(t)==no)},ro=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]},oo=function(t){return we(t,nn(t))},so=(Xr=function(t,e,n){Br(t,e,n)},_i(function(t,e){var n=-1,i=e.length,r=1<i?e[i-1]:void 0,o=2<i?e[2]:void 0,r=3<Xr.length&&"function"==typeof r?(i--,r):void 0;for(o&&_r(e[0],e[1],o)&&(r=i<3?void 0:r,i=1),t=Object(t);++n<i;){var s=e[n];s&&Xr(t,s,n)}return t})),ao=function(t,e,n,i){if(w(t))for(var r=-1,o=(e=Wi(e,t)).length,s=o-1,a=t;null!=a&&++r<o;){var h,c=Gi(e[r]),u=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;r!=s&&(h=a[c],void 0===(u=i?i(h,c,a):void 0))&&(u=w(h)?h:Fe(e[r+1])?[]:{}),Ie(a,c,u),a=a[c]}return t},rr=lr(Si(e=function(t,e){return null==t?{}:Rr(t,e)},void 0,Ar),e+""),ho=Math.ceil,co=Math.max,uo=function(t,e){if(t!==e){var n=void 0!==t,i=null===t,r=t==t,o=ci(t),s=void 0!==e,a=null===e,h=e==e,c=ci(e);if(!a&&!c&&!o&&e<t||o&&s&&h&&!a&&!c||i&&s&&h||!n&&h||!r)return 1;if(!i&&!o&&!c&&t<e||c&&n&&r&&!i&&!o||a&&n&&r||!s&&r||!h)return-1}return 0},u=_i(function(t,e){var n;return null==t?[]:(1<(n=e.length)&&_r(t,e[0],e[1])?e=[]:2<n&&_r(e[0],e[1],e[2])&&(e=[e[0]]),jr(t,Li(e,1),[]))}),lo=0;try{fo={cloneDeep:function(t){return Dn(t,5)},constant:Bn,defaults:t,each:Mn,filter:vi,find:Or,flatten:Ar,forEach:Rn,forIn:function(t,e){return null==t?t:Un(t,zn(e),nn)},has:xi,isUndefined:wi,last:function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0},map:bi,mapValues:function(t,i){var r={};return i=yi(i),Wn(t,function(t,e,n){Oe(r,e,i(t,e,n))}),r},max:function(t){return t&&t.length?Ir(t,qn,Dr):void 0},merge:so,min:function(t){return t&&t.length?Ir(t,qn,zr):void 0},minBy:function(t,e){return t&&t.length?Ir(t,yi(e),zr):void 0},now:function(){return r.Date.now()},pick:rr,range:Vr,reduce:Ei,sortBy:u,uniqueId:function(t){var e=++lo;return fi(t)+e},values:Ii,zipObject:function(t,e){for(var n=t||[],i=e||[],r=Ie,o=-1,s=n.length,a=i.length,h={};++o<s;){var c=o<a?i[o]:void 0;r(h,n[o],c)}return h}}}catch(D){}var fo,x=fo=fo||window._,po=go;function go(){var t={};t._next=t._prev=t,this._sentinel=t}function yo(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function vo(t,e){if("_next"!==t&&"_prev"!==t)return e}go.prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return yo(e),e},go.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&yo(t),t._next=e._next,e._next._prev=t,(e._next=t)._prev=e},go.prototype.toString=function(){for(var t=[],e=this._sentinel,n=e._prev;n!==e;)t.push(JSON.stringify(n,vo)),n=n._prev;return"["+t.join(", ")+"]"};var mo=d.Graph,xo=x.constant(1);function wo(i,r,o,t,s){var a=s?[]:void 0;return x.forEach(i.inEdges(t.v),function(t){var e=i.edge(t),n=i.node(t.v);s&&a.push({v:t.v,w:t.w}),n.out-=e,bo(r,o,n)}),x.forEach(i.outEdges(t.v),function(t){var e=i.edge(t),t=t.w,t=i.node(t);t.in-=e,bo(r,o,t)}),i.removeNode(t.v),a}function bo(t,e,n){(n.out?n.in?t[n.out-n.in+e]:t[t.length-1]:t[0]).enqueue(n)}var ko=function(n){var i,r,o,s,e,t,a,h,c,u,l,d,f,p="greedy"===n.graph().acyclicer?(f=e=n,p=function(t){return f.edge(t).weight},e.nodeCount()<=1?[]:(t=e,a=p||xo,h=new mo,u=c=0,x.forEach(t.nodes(),function(t){h.setNode(t,{v:t,in:0,out:0})}),x.forEach(t.edges(),function(t){var e=h.edge(t.v,t.w)||0,n=a(t);h.setEdge(t.v,t.w,e+n),u=Math.max(u,h.node(t.v).out+=n),c=Math.max(c,h.node(t.w).in+=n)}),l=x.range(u+c+3).map(function(){return new po}),d=c+1,x.forEach(h.nodes(),function(t){bo(l,d,h.node(t))}),t=function(t,e,n){for(var i,r=[],o=e[e.length-1],s=e[0];t.nodeCount();){for(;i=s.dequeue();)wo(t,e,n,i);for(;i=o.dequeue();)wo(t,e,n,i);if(t.nodeCount())for(var a=e.length-2;0<a;--a)if(i=e[a].dequeue()){r=r.concat(wo(t,e,n,i,!0));break}}return r}((p={graph:h,buckets:l,zeroIdx:d}).graph,p.buckets,p.zeroIdx),x.flatten(x.map(t,function(t){return e.outEdges(t.v,t.w)}),!0))):(i=n,r=[],o={},s={},x.forEach(i.nodes(),function e(t){x.has(s,t)||(s[t]=!0,o[t]=!0,x.forEach(i.outEdges(t),function(t){x.has(o,t.w)?r.push(t):e(t.w)}),delete o[t])}),r);x.forEach(p,function(t){var e=n.edge(t);n.removeEdge(t),e.forwardName=t.name,e.reversed=!0,n.setEdge(t.w,t.v,e,x.uniqueId("rev"))})},Mo=function(i){x.forEach(i.edges(),function(t){var e,n=i.edge(t);n.reversed&&(i.removeEdge(t),e=n.forwardName,delete n.reversed,delete n.forwardName,i.setEdge(t.w,t.v,n,e))})},Eo=d.Graph,M={addDummyNode:Co,simplify:function(i){var r=(new Eo).setGraph(i.graph());return x.forEach(i.nodes(),function(t){r.setNode(t,i.node(t))}),x.forEach(i.edges(),function(t){var e=r.edge(t.v,t.w)||{weight:0,minlen:1},n=i.edge(t);r.setEdge(t.v,t.w,{weight:e.weight+n.weight,minlen:Math.max(e.minlen,n.minlen)})}),r},asNonCompoundGraph:function(e){var n=new Eo({multigraph:e.isMultigraph()}).setGraph(e.graph());return x.forEach(e.nodes(),function(t){e.children(t).length||n.setNode(t,e.node(t))}),x.forEach(e.edges(),function(t){n.setEdge(t,e.edge(t))}),n},successorWeights:function(n){var t=x.map(n.nodes(),function(t){var e={};return x.forEach(n.outEdges(t),function(t){e[t.w]=(e[t.w]||0)+n.edge(t).weight}),e});return x.zipObject(n.nodes(),t)},predecessorWeights:function(n){var t=x.map(n.nodes(),function(t){var e={};return x.forEach(n.inEdges(t),function(t){e[t.v]=(e[t.v]||0)+n.edge(t).weight}),e});return x.zipObject(n.nodes(),t)},intersectRect:function(t,e){var n,i=t.x,r=t.y,o=e.x-i,e=e.y-r,s=t.width/2,t=t.height/2;if(o||e)return t=Math.abs(e)*s>Math.abs(o)*t?(n=(t=e<0?-t:t)*o/e,t):(n=s=o<0?-s:s)*e/o,{x:i+n,y:r+t};throw new Error("Not possible to find intersection inside of the rectangle")},buildLayerMatrix:function(i){var r=x.map(x.range(No(i)+1),function(){return[]});return x.forEach(i.nodes(),function(t){var e=i.node(t),n=e.rank;x.isUndefined(n)||(r[n][e.order]=t)}),r},normalizeRanks:function(e){var n=x.min(x.map(e.nodes(),function(t){return e.node(t).rank}));x.forEach(e.nodes(),function(t){t=e.node(t);x.has(t,"rank")&&(t.rank-=n)})},removeEmptyRanks:function(n){var i=x.min(x.map(n.nodes(),function(t){return n.node(t).rank})),r=[],o=(x.forEach(n.nodes(),function(t){var e=n.node(t).rank-i;r[e]||(r[e]=[]),r[e].push(t)}),0),s=n.graph().nodeRankFactor;x.forEach(r,function(t,e){x.isUndefined(t)&&e%s!=0?--o:o&&x.forEach(t,function(t){n.node(t).rank+=o})})},addBorderNode:function(t,e,n,i){var r={width:0,height:0};return 4<=arguments.length&&(r.rank=n,r.order=i),Co(t,"border",r,e)},maxRank:No,partition:function(t,e){var n={lhs:[],rhs:[]};return x.forEach(t,function(t){(e(t)?n.lhs:n.rhs).push(t)}),n},time:function(t,e){var n=x.now();try{return e()}finally{console.log(t+" time: "+(x.now()-n)+"ms")}},notime:function(t,e){return e()}};function Co(t,e,n,i){for(var r;r=x.uniqueId(i),t.hasNode(r););return n.dummy=e,t.setNode(r,n),r}function No(e){return x.max(x.map(e.nodes(),function(t){t=e.node(t).rank;if(!x.isUndefined(t))return t}))}function Lo(i){var r={};x.forEach(i.sources(),function e(t){var n=i.node(t);if(x.has(r,t))return n.rank;r[t]=!0;t=x.min(x.map(i.outEdges(t),function(t){return e(t.w)-i.edge(t).minlen}));return t!==Number.POSITIVE_INFINITY&&null!=t||(t=0),n.rank=t})}function So(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}var _o=function(d){d.graph().dummyChains=[],x.forEach(d.edges(),function(t){var e,n,i,r=d,o=t,s=o.v,a=r.node(s).rank,t=o.w,h=r.node(t).rank,c=o.name,u=r.edge(o),l=u.labelRank;if(h!==a+1){for(r.removeEdge(o),i=0,++a;a<h;++i,++a)u.points=[],e=M.addDummyNode(r,"edge",n={width:0,height:0,edgeLabel:u,edgeObj:o,rank:a},"_d"),a===l&&(n.width=u.width,n.height=u.height,n.dummy="edge-label",n.labelpos=u.labelpos),r.setEdge(s,e,{weight:u.weight},c),0===i&&r.graph().dummyChains.push(e),s=e;r.setEdge(s,t,{weight:u.weight},c)}})},To=function(r){x.forEach(r.graph().dummyChains,function(t){var e,n=r.node(t),i=n.edgeLabel;for(r.setEdge(n.edgeObj,i);n.dummy;)e=r.successors(t)[0],r.removeNode(t),i.points.push({x:n.x,y:n.y}),"edge-label"===n.dummy&&(i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height),n=r.node(t=e)})},Po=d.Graph,Oo=So,Ao=function(t){var e,n=new Po({directed:!1}),i=t.nodes()[0],r=t.nodeCount();for(n.setNode(i,{});function(r,o){return x.forEach(r.nodes(),function n(i){x.forEach(o.nodeEdges(i),function(t){var e=t.v,e=i===e?t.w:e;r.hasNode(e)||Oo(o,t)||(r.setNode(e,{}),r.setEdge(i,e,{}),n(e))})}),r.nodeCount()}(n,t)<r;)e=function(e,n){return x.minBy(n.edges(),function(t){if(e.hasNode(t.v)!==e.hasNode(t.w))return Oo(n,t)})}(n,t),e=n.hasNode(e.v)?Oo(t,e):-Oo(t,e),function(t,e,n){x.forEach(t.nodes(),function(t){e.node(t).rank+=n})}(n,t,e);return n};var Io=So,Do=Lo,Bo=d.alg.preorder,zo=d.alg.postorder,Ro=M.simplify,Vo=jo;function jo(t){t=Ro(t),Do(t);var e,n=Ao(t);for(Yo(n),Fo(n,t);e=Uo(n);)Go(n,t,e,Wo(n,t,e))}function Fo(r,o){var t=(t=zo(r,r.nodes())).slice(0,t.length-1);x.forEach(t,function(t){var e,n,i;n=o,t=t,i=(e=r).node(t).parent,e.edge(t,i).cutvalue=Xo(e,n,t)})}function Xo(i,r,o){var s=i.node(o).parent,a=!0,t=r.edge(o,s),h=0;return t||(a=!1,t=r.edge(s,o)),h=t.weight,x.forEach(r.nodeEdges(o),function(t){var e=t.v===o,n=e?t.w:t.v;n!==s&&(e=e===a,t=r.edge(t).weight,h+=e?t:-t,i.hasEdge(o,n))&&(t=i.edge(o,n).cutvalue,h+=e?-t:t)}),h}function Yo(t,e){arguments.length<2&&(e=t.nodes()[0]),function e(n,i,r,o,t){var s=r,a=n.node(o);return i[o]=!0,x.forEach(n.neighbors(o),function(t){x.has(i,t)||(r=e(n,i,r,t,o))}),a.low=s,a.lim=r++,t?a.parent=t:delete a.parent,r}(t,{},1,e)}function Uo(e){return x.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function Wo(e,n,t){var i=t.v,r=t.w,t=(n.hasEdge(i,r)||(i=t.w,r=t.v),e.node(i)),i=e.node(r),o=t,s=!1,r=(t.lim>i.lim&&(o=i,s=!0),x.filter(n.edges(),function(t){return s===qo(0,e.node(t.v),o)&&s!==qo(0,e.node(t.w),o)}));return x.minBy(r,function(t){return Io(n,t)})}function Go(t,e,n,i){var r,o,s=n.v,n=n.w;t.removeEdge(s,n),t.setEdge(i.v,i.w,{}),Yo(t),Fo(t,e),r=t,o=e,s=x.find(r.nodes(),function(t){return!o.node(t).parent}),s=(s=Bo(r,s)).slice(1),x.forEach(s,function(t){var e=r.node(t).parent,n=o.edge(t,e),i=!1;n||(n=o.edge(e,t),i=!0),o.node(t).rank=o.node(e).rank+(i?n.minlen:-n.minlen)})}function qo(t,e,n){return n.low<=e.lim&&e.lim<=n.lim}jo.initLowLimValues=Yo,jo.initCutValues=Fo,jo.calcCutValue=Xo,jo.leaveEdge=Uo,jo.enterEdge=Wo,jo.exchangeEdges=Go;var Ho=Lo,Jo=Ho;function Ko(t){Vo(t)}function Zo(c){i=c,r={},o=0,x.forEach(i.children(),function t(e){var n=o;x.forEach(i.children(e),t),r[e]={low:n,lim:o++}});var i,r,o,u=r;x.forEach(c.graph().dummyChains,function(t){for(var e,n=c.node(t).edgeObj,i=function(t,e,n,i){for(var r,o=[],s=[],a=Math.min(e[n].low,e[i].low),h=Math.max(e[n].lim,e[i].lim),c=n;c=t.parent(c),o.push(c),c&&(e[c].low>a||h>e[c].lim););for(r=c,c=i;(c=t.parent(c))!==r;)s.push(c);return{path:o.concat(s.reverse()),lca:r}}(c,u,n.v,n.w),r=i.path,o=i.lca,s=0,a=r[s],h=!0;t!==n.w;){if(e=c.node(t),h){for(;(a=r[s])!==o&&c.node(a).maxRank<e.rank;)s++;a===o&&(h=!1)}if(!h){for(;s<r.length-1&&c.node(a=r[s+1]).minRank<=e.rank;)s++;a=r[s]}c.setParent(t,a),t=c.successors(t)[0]}})}var Qo=function(e){var r,o,n,i=M.addDummyNode(e,"root",{},"_root"),s=(r=e,o={},x.forEach(r.children(),function(t){!function e(t,n){var i=r.children(t);i&&i.length&&x.forEach(i,function(t){e(t,n+1)}),o[t]=n}(t,1)}),o),a=x.max(x.values(s))-1,h=2*a+1,c=(e.graph().nestingRoot=i,x.forEach(e.edges(),function(t){e.edge(t).minlen*=h}),n=e,x.reduce(n.edges(),function(t,e){return t+n.edge(e).weight},0)+1);x.forEach(e.children(),function(t){!function r(o,s,a,h,c,u,l){var d,f,t,e=o.children(l);return e.length?(d=M.addBorderNode(o,"_bt"),f=M.addBorderNode(o,"_bb"),t=o.node(l),o.setParent(d,l),t.borderTop=d,o.setParent(f,l),t.borderBottom=f,x.forEach(e,function(t){r(o,s,a,h,c,u,t);var e=o.node(t),n=e.borderTop||t,t=e.borderBottom||t,e=e.borderTop?h:2*h,i=n!==t?1:c-u[l]+1;o.setEdge(d,n,{weight:e,minlen:i,nestingEdge:!0}),o.setEdge(t,f,{weight:e,minlen:i,nestingEdge:!0})}),void(o.parent(l)||o.setEdge(s,d,{weight:0,minlen:c+u[l]}))):(l!==s&&o.setEdge(s,l,{weight:0,minlen:a}),0)}(e,i,h,c,a,s,t)}),e.graph().nodeRankFactor=h},$o=function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,x.forEach(e.edges(),function(t){e.edge(t).nestingEdge&&e.removeEdge(t)})};function ts(t,e,n,i,r,o){var s=r[e][o-1],n=M.addDummyNode(t,"border",{width:0,height:0,rank:o,borderType:e},n);r[e][o]=n,t.setParent(n,i),s&&t.setEdge(s,n,{weight:1})}var es=function(t){var e=t.graph().rankdir.toLowerCase();"lr"!==e&&"rl"!==e||is(t)},ns=function(t){var e,n,i=t.graph().rankdir.toLowerCase();"bt"!==i&&"rl"!==i||(e=t,x.forEach(e.nodes(),function(t){os(e.node(t))}),x.forEach(e.edges(),function(t){t=e.edge(t);x.forEach(t.points,os),x.has(t,"y")&&os(t)})),"lr"!==i&&"rl"!==i||(n=t,x.forEach(n.nodes(),function(t){ss(n.node(t))}),x.forEach(n.edges(),function(t){t=n.edge(t);x.forEach(t.points,ss),x.has(t,"x")&&ss(t)}),is(t))};function is(e){x.forEach(e.nodes(),function(t){rs(e.node(t))}),x.forEach(e.edges(),function(t){rs(e.edge(t))})}function rs(t){var e=t.width;t.width=t.height,t.height=e}function os(t){t.y=-t.y}function ss(t){var e=t.x;t.x=t.y,t.y=e}var as=function(i){var r={},t=x.filter(i.nodes(),function(t){return!i.children(t).length}),e=x.max(x.map(t,function(t){return i.node(t).rank})),o=x.map(x.range(e+1),function(){return[]});e=x.sortBy(t,function(t){return i.node(t).rank});return x.forEach(e,function t(e){var n;x.has(r,e)||(r[e]=!0,n=i.node(e),o[n.rank].push(e),x.forEach(i.successors(e),t))}),o},hs=function(t,e){for(var n=0,i=1;i<e.length;++i)n+=function(e,t,n){for(var i=x.zipObject(n,x.map(n,function(t,e){return e})),t=x.flatten(x.map(t,function(t){return x.sortBy(x.map(e.outEdges(t),function(t){return{pos:i[t.w],weight:e.edge(t).weight}}),"pos")}),!0),r=1;r<n.length;)r<<=1;var o=2*r-1,s=(--r,x.map(new Array(o),function(){return 0})),a=0;return x.forEach(t.forEach(function(t){var e=t.pos+r;s[e]+=t.weight;for(var n=0;0<e;)e%2&&(n+=s[e+1]),s[e=e-1>>1]+=t.weight;a+=t.weight*n})),a}(t,e[i-1],e[i]);return n};var cs=function(i,t){return x.map(t,function(t){var e=i.inEdges(t);return e.length?{v:t,barycenter:(e=x.reduce(e,function(t,e){var n=i.edge(e),e=i.node(e.v);return{sum:t.sum+n.weight*e.order,weight:t.weight+n.weight}},{sum:0,weight:0})).sum/e.weight,weight:e.weight}:{v:t}})},us=function(t,e){var i={},n=(x.forEach(t,function(t,e){e=i[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:e};x.isUndefined(t.barycenter)||(e.barycenter=t.barycenter,e.weight=t.weight)}),x.forEach(e.edges(),function(t){var e=i[t.v],n=i[t.w];x.isUndefined(e)||x.isUndefined(n)||(n.indegree++,e.out.push(i[t.w]))}),x.filter(i,function(t){return!t.indegree})),r=[];function o(r){return function(t){var e,n,i;t.merged||(x.isUndefined(t.barycenter)||x.isUndefined(r.barycenter)||t.barycenter>=r.barycenter)&&(t=t,i=n=0,(e=r).weight&&(n+=e.barycenter*e.weight,i+=e.weight),t.weight&&(n+=t.barycenter*t.weight,i+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/i,e.weight=i,e.i=Math.min(t.i,e.i),t.merged=!0)}}for(;n.length;){var s=n.pop();r.push(s),x.forEach(s.in.reverse(),o(s)),x.forEach(s.out,function(e){return function(t){t.in.push(e),0==--t.indegree&&n.push(t)}}(s))}return x.map(x.filter(r,function(t){return!t.merged}),function(t){return x.pick(t,["vs","i","barycenter","weight"])})},ls=function(t,e){var n,t=M.partition(t,function(t){return x.has(t,"barycenter")}),i=t.lhs,r=x.sortBy(t.rhs,function(t){return-t.i}),o=[],s=0,a=0,h=0,t=(i.sort((n=!!e,function(t,e){return t.barycenter<e.barycenter?-1:t.barycenter>e.barycenter?1:n?e.i-t.i:t.i-e.i})),h=ds(o,r,h),x.forEach(i,function(t){h+=t.vs.length,o.push(t.vs),s+=t.barycenter*t.weight,a+=t.weight,h=ds(o,r,h)}),{vs:x.flatten(o,!0)});return a&&(t.barycenter=s/a,t.weight=a),t};function ds(t,e,n){for(var i;e.length&&(i=x.last(e)).i<=n;)e.pop(),t.push(i.vs),n++;return n}function fs(n,t,i,r){var e,o,s=n.children(t),a=(t=n.node(t))?t.borderLeft:void 0,h=t?t.borderRight:void 0,c={},t=(a&&(s=x.filter(s,function(t){return t!==a&&t!==h})),cs(n,s)),s=(x.forEach(t,function(t){var e;n.children(t.v).length&&(e=fs(n,t.v,i,r),c[t.v]=e,x.has(e,"barycenter"))&&(e=e,x.isUndefined((t=t).barycenter)?(t.barycenter=e.barycenter,t.weight=e.weight):(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight))}),us(t,i)),t=(e=c,x.forEach(s,function(t){t.vs=x.flatten(t.vs.map(function(t){return e[t]?e[t].vs:t}),!0)}),ls(s,r));return a&&(t.vs=x.flatten([a,t.vs,h],!0),n.predecessors(a).length)&&(s=n.node(n.predecessors(a)[0]),o=n.node(n.predecessors(h)[0]),x.has(t,"barycenter")||(t.barycenter=0,t.weight=0),t.barycenter=(t.barycenter*t.weight+s.order+o.order)/(t.weight+2),t.weight+=2),t}function ps(r,n,o){var s=function(t){for(var e;t.hasNode(e=x.uniqueId("_root")););return e}(r),a=new vs({compound:!0}).setGraph({root:s}).setDefaultNodeLabel(function(t){return r.node(t)});return x.forEach(r.nodes(),function(i){var t=r.node(i),e=r.parent(i);(t.rank===n||t.minRank<=n&&n<=t.maxRank)&&(a.setNode(i),a.setParent(i,e||s),x.forEach(r[o](i),function(t){var e=t.v===i?t.w:t.v,n=a.edge(e,i),n=x.isUndefined(n)?0:n.weight;a.setEdge(e,i,{weight:r.edge(t).weight+n})}),x.has(t,"minRank"))&&a.setNode(i,{borderLeft:t.borderLeft[n],borderRight:t.borderRight[n]})}),a}function gs(r,o,t){var s,a={};x.forEach(t,function(t){for(var e,n,i=r.parent(t);i;){if((e=r.parent(i))?(n=a[e],a[e]=i):(n=s,s=i),n&&n!==i)return void o.setEdge(n,i);i=e}})}function ys(t){var e=M.maxRank(t),n=xs(t,x.range(1,e+1),"inEdges"),i=xs(t,x.range(e-1,-1,-1),"outEdges");ws(t,as(t));for(var r,o=Number.POSITIVE_INFINITY,s=0,a=0;a<4;++s,++a){(function(t,e){var i=new ms;x.forEach(t,function(n){var t=n.graph().root,t=fs(n,t,i,e);x.forEach(t.vs,function(t,e){n.node(t).order=e}),gs(n,i,t.vs)})})(s%2?n:i,2<=s%4);var h=M.buildLayerMatrix(t),c=hs(t,h);c<o&&(a=0,r=x.cloneDeep(h),o=c)}ws(t,r)}var vs=d.Graph,ms=d.Graph;function xs(e,t,n){return x.map(t,function(t){return ps(e,t,n)})}function ws(n,t){x.forEach(t,function(t){x.forEach(t,function(t,e){n.node(t).order=e})})}var bs=d.Graph;function ks(t,e,n){n<e&&(i=e,e=n,n=i);var i=t[e];i||(t[e]=i={}),i[n]=!0}var Ms=function(g){var y,a,s,c,u,t=M.buildLayerMatrix(g),v=x.merge((c=g,u={},x.reduce(t,function(t,i){var o=0,s=0,a=t.length,h=x.last(i);return x.forEach(i,function(t,e){var n=function(e,t){if(e.node(t).dummy)return x.find(e.predecessors(t),function(t){return e.node(t).dummy})}(c,t),r=n?c.node(n).order:a;!n&&t!==h||(x.forEach(i.slice(s,e+1),function(i){x.forEach(c.predecessors(i),function(t){var e=c.node(t),n=e.order;!(n<o||r<n)||e.dummy&&c.node(i).dummy||ks(u,t,i)})}),s=e+1,o=r)}),i}),u),(a=g,s={},x.reduce(t,function(n,i){var r,o=-1,s=0;return x.forEach(i,function(t,e){"border"===a.node(t).dummy&&(t=a.predecessors(t)).length&&(r=a.node(t[0]).order,h(i,s,e,o,r),s=e,o=r),h(i,s,i.length,r,n.length)}),i}),s)),m={};function h(e,t,n,i,r){var o;x.forEach(x.range(t,n),function(t){o=e[t],a.node(o).dummy&&x.forEach(a.predecessors(o),function(t){var e=a.node(t);e.dummy&&(e.order<i||e.order>r)&&ks(s,t,o)})})}x.forEach(["u","d"],function(p){y="u"===p?t:x.values(t).reverse(),x.forEach(["l","r"],function(t){"r"===t&&(y=x.map(y,function(t){return x.values(t).reverse()}));var i,e,r,o,s,a,h,c,u,l,n=("u"===p?g.predecessors:g.successors).bind(g),n=(d=y,a=v,h=n,c={},u={},l={},x.forEach(d,function(t){x.forEach(t,function(t,e){l[u[c[t]=t]=t]=e})}),x.forEach(d,function(t){var s=-1;x.forEach(t,function(t){var e=h(t);if(e.length)for(var n=((e=x.sortBy(e,function(t){return l[t]})).length-1)/2,i=Math.floor(n),r=Math.ceil(n);i<=r;++i){var o=e[i];u[t]===t&&s<l[o]&&!function(t,e,n){{var i;n<e&&(i=e,e=n,n=i)}return x.has(t[e],n)}(a,t,o)&&(u[o]=t,u[t]=c[t]=c[o],s=l[o])}})}),{root:c,align:u}),d=(i=g,d=y,e=n.root,n=n.align,r={},o=function(o,t,s,e){var a,h,c,u=new bs,n=o.graph(),l=(a=n.nodesep,h=n.edgesep,c=e,function(t,e,n){var i,r=t.node(e),o=t.node(n),e=0;if(e+=r.width/2,x.has(r,"labelpos"))switch(r.labelpos.toLowerCase()){case"l":i=-r.width/2;break;case"r":i=r.width/2}if(i&&(e+=c?i:-i),i=0,e=(e=(e+=(r.dummy?h:a)/2)+(o.dummy?h:a)/2)+o.width/2,x.has(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":i=o.width/2;break;case"r":i=-o.width/2}return i&&(e+=c?i:-i),i=0,e});return x.forEach(t,function(t){var r;x.forEach(t,function(t){var e,n,i=s[t];u.setNode(i),r&&(e=s[r],n=u.edge(e,i),u.setEdge(e,i,Math.max(l(o,t,r),n||0))),r=t})}),u}(i,d,e,d="r"===t),s=d?"borderLeft":"borderRight",f(function(t){r[t]=o.inEdges(t).reduce(function(t,e){return Math.max(t,r[e.v]+o.edge(e))},0)},o.predecessors.bind(o)),f(function(t){var e=o.outEdges(t).reduce(function(t,e){return Math.min(t,r[e.w]-o.edge(e))},Number.POSITIVE_INFINITY),n=i.node(t);e!==Number.POSITIVE_INFINITY&&n.borderType!==s&&(r[t]=Math.max(r[t],e))},o.successors.bind(o)),x.forEach(n,function(t){r[t]=r[e[t]]}),r);function f(t,e){for(var n=o.nodes(),i=n.pop(),r={};i;)r[i]?t(i):(r[i]=!0,n.push(i),n=n.concat(e(i))),i=n.pop()}"r"===t&&(d=x.mapValues(d,function(t){return-t})),m[p+t]=d})});r=g;var r,n,i,l,d,f,p,e=x.minBy(x.values(m),function(t){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return x.forIn(t,function(t,e){e=r.node(e).width/2;n=Math.max(t+e,n),i=Math.min(t-e,i)}),n-i});return l=m,d=e,e=x.values(d),f=x.min(e),p=x.max(e),x.forEach(["u","d"],function(o){x.forEach(["l","r"],function(t){var e,n,i=o+t,r=l[i];r!==d&&(n=x.values(r),e="l"===t?f-x.min(n):p-x.max(n))&&(l[i]=x.mapValues(r,function(t){return t+e}))})}),n=m,i=g.graph().align,x.mapValues(n.ul,function(t,e){return i?n[i.toLowerCase()][e]:((e=x.sortBy(x.map(n,e)))[1]+e[2])/2})},Es=M.normalizeRanks,Cs=M.removeEmptyRanks,Ns=M,Ls=d.Graph,Ss=["nodesep","edgesep","ranksep","marginx","marginy"],_s={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Ts=["acyclicer","ranker","rankdir","align"],Ps=["width","height"],Os={width:0,height:0},As=["minlen","weight","width","height","labeloffset"],Is={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Ds=["labelpos"];function Bs(t,e){return x.mapValues(x.pick(t,e),Number)}function zs(t){var n={};return x.forEach(t,function(t,e){n[e.toLowerCase()]=t}),n}var Rs=d.Graph,m={graphlib:d,layout:function(o,t){var n=t&&t.debugTiming?Ns.time:Ns.notime;n("layout",function(){var e=n("  buildLayoutGraph",function(){return n=o,i=new Ls({multigraph:!0,compound:!0}),t=zs(n.graph()),i.setGraph(x.merge({},_s,Bs(t,Ss),x.pick(t,Ts))),x.forEach(n.nodes(),function(t){var e=zs(n.node(t));i.setNode(t,x.defaults(Bs(e,Ps),Os)),i.setParent(t,n.parent(t))}),x.forEach(n.edges(),function(t){var e=zs(n.edge(t));i.setEdge(t,x.merge({},Is,Bs(e,As),x.pick(e,Ds)))}),i;var n,i,t});n("  runLayout",function(){var c,t;c=e,(t=n)("    makeSpaceForEdgeLabels",function(){var e,n;(n=(e=c).graph()).ranksep/=2,x.forEach(e.edges(),function(t){t=e.edge(t);t.minlen*=2,"c"!==t.labelpos.toLowerCase()&&("TB"===n.rankdir||"BT"===n.rankdir?t.width+=t.labeloffset:t.height+=t.labeloffset)})}),t("    removeSelfEdges",function(){var n;n=c,x.forEach(n.edges(),function(t){var e;t.v===t.w&&((e=n.node(t.v)).selfEdges||(e.selfEdges=[]),e.selfEdges.push({e:t,label:n.edge(t)}),n.removeEdge(t))})}),t("    acyclic",function(){ko(c)}),t("    nestingGraph.run",function(){Qo(c)}),t("    rank",function(){var t,e=Ns.asNonCompoundGraph(c);switch(e.graph().ranker){case"network-simplex":Ko(e);break;case"tight-tree":Ho(t=e),Ao(t);break;case"longest-path":Jo(e);break;default:Ko(e)}}),t("    injectEdgeLabelProxies",function(){var n;n=c,x.forEach(n.edges(),function(t){var e=n.edge(t);e.width&&e.height&&(e=n.node(t.v),e={rank:(n.node(t.w).rank-e.rank)/2+e.rank,e:t},Ns.addDummyNode(n,"edge-proxy",e,"_ep"))})}),t("    removeEmptyRanks",function(){Cs(c)}),t("    nestingGraph.cleanup",function(){$o(c)}),t("    normalizeRanks",function(){Es(c)}),t("    assignRankMinMax",function(){var e,n;e=c,n=0,x.forEach(e.nodes(),function(t){t=e.node(t);t.borderTop&&(t.minRank=e.node(t.borderTop).rank,t.maxRank=e.node(t.borderBottom).rank,n=x.max(n,t.maxRank))}),e.graph().maxRank=n}),t("    removeEdgeLabelProxies",function(){var n;n=c,x.forEach(n.nodes(),function(t){var e=n.node(t);"edge-proxy"===e.dummy&&(n.edge(e.e).labelRank=e.rank,n.removeNode(t))})}),t("    normalize.run",function(){_o(c)}),t("    parentDummyChains",function(){Zo(c)}),t("    addBorderSegments",function(){var s;s=c,x.forEach(s.children(),function t(e){var n=s.children(e),i=s.node(e);if(n.length&&x.forEach(n,t),x.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var r=i.minRank,o=i.maxRank+1;r<o;++r)ts(s,"borderLeft","_bl",e,i,r),ts(s,"borderRight","_br",e,i,r)}})}),t("    order",function(){ys(c)}),t("    insertSelfEdges",function(){var r,t;r=c,t=Ns.buildLayerMatrix(r),x.forEach(t,function(t){var i=0;x.forEach(t,function(t,e){var n=r.node(t);n.order=e+i,x.forEach(n.selfEdges,function(t){Ns.addDummyNode(r,"selfedge",{width:t.label.width,height:t.label.height,rank:n.rank,order:e+ ++i,e:t.e,label:t.label},"_se")}),delete n.selfEdges})})}),t("    adjustCoordinateSystem",function(){es(c)}),t("    position",function(){var n,i,t,r,o;n=c,i=n=M.asNonCompoundGraph(n),t=M.buildLayerMatrix(i),r=i.graph().ranksep,o=0,x.forEach(t,function(t){var e=x.max(x.map(t,function(t){return i.node(t).height}));x.forEach(t,function(t){i.node(t).y=o+e/2}),o+=e+r}),x.forEach(Ms(n),function(t,e){n.node(e).x=t})}),t("    positionSelfEdges",function(){var s;s=c,x.forEach(s.nodes(),function(t){var e,n,i,r,o=s.node(t);"selfedge"===o.dummy&&(e=(r=s.node(o.e.v)).x+r.width/2,n=r.y,i=o.x-e,r=r.height/2,s.setEdge(o.e,o.label),s.removeNode(t),o.label.points=[{x:e+2*i/3,y:n-r},{x:e+5*i/6,y:n-r},{x:e+i,y:n},{x:e+5*i/6,y:n+r},{x:e+2*i/3,y:n+r}],o.label.x=o.x,o.label.y=o.y)})}),t("    removeBorderNodes",function(){var o;o=c,x.forEach(o.nodes(),function(t){var e,n,i,r;o.children(t).length&&(t=o.node(t),e=o.node(t.borderTop),n=o.node(t.borderBottom),i=o.node(x.last(t.borderLeft)),r=o.node(x.last(t.borderRight)),t.width=Math.abs(r.x-i.x),t.height=Math.abs(n.y-e.y),t.x=i.x+t.width/2,t.y=e.y+t.height/2)}),x.forEach(o.nodes(),function(t){"border"===o.node(t).dummy&&o.removeNode(t)})}),t("    normalize.undo",function(){To(c)}),t("    fixupEdgeLabelCoords",function(){var n;n=c,x.forEach(n.edges(),function(t){var e=n.edge(t);if(x.has(e,"x"))switch("l"!==e.labelpos&&"r"!==e.labelpos||(e.width-=e.labeloffset),e.labelpos){case"l":e.x-=e.width/2+e.labeloffset;break;case"r":e.x+=e.width/2+e.labeloffset}})}),t("    undoCoordinateSystem",function(){ns(c)}),t("    translateGraph",function(){function e(t){var e=t.x,n=t.y,i=t.width,t=t.height;r=Math.min(r,e-i/2),o=Math.max(o,e+i/2),s=Math.min(s,n-t/2),a=Math.max(a,n+t/2)}var n,r,o,s,a,t,i,h;n=c,r=Number.POSITIVE_INFINITY,o=0,s=Number.POSITIVE_INFINITY,a=0,t=n.graph(),i=t.marginx||0,h=t.marginy||0,x.forEach(n.nodes(),function(t){e(n.node(t))}),x.forEach(n.edges(),function(t){t=n.edge(t);x.has(t,"x")&&e(t)}),r-=i,s-=h,x.forEach(n.nodes(),function(t){t=n.node(t);t.x-=r,t.y-=s}),x.forEach(n.edges(),function(t){t=n.edge(t);x.forEach(t.points,function(t){t.x-=r,t.y-=s}),x.has(t,"x")&&(t.x-=r),x.has(t,"y")&&(t.y-=s)}),t.width=o-r+i,t.height=a-s+h}),t("    assignNodeIntersects",function(){var o;o=c,x.forEach(o.edges(),function(t){var e,n=o.edge(t),i=o.node(t.v),t=o.node(t.w),r=n.points?(e=n.points[0],n.points[n.points.length-1]):(n.points=[],e=t,i);n.points.unshift(Ns.intersectRect(i,e)),n.points.push(Ns.intersectRect(t,r))})}),t("    reversePoints",function(){var e;e=c,x.forEach(e.edges(),function(t){t=e.edge(t);t.reversed&&t.points.reverse()})}),t("    acyclic.undo",function(){Mo(c)})}),n("  updateInputGraph",function(){var i,r;i=o,r=e,x.forEach(i.nodes(),function(t){var e=i.node(t),n=r.node(t);e&&(e.x=n.x,e.y=n.y,r.children(t).length)&&(e.width=n.width,e.height=n.height)}),x.forEach(i.edges(),function(t){var e=i.edge(t),t=r.edge(t);e.points=t.points,x.has(t,"x")&&(e.x=t.x,e.y=t.y)}),i.graph().width=r.graph().width,i.graph().height=r.graph().height})})},debug:{debugOrdering:function(e){var t=M.buildLayerMatrix(e),n=new Rs({compound:!0,multigraph:!0}).setGraph({});return x.forEach(e.nodes(),function(t){n.setNode(t,{label:t}),n.setParent(t,"layer"+e.node(t).rank)}),x.forEach(e.edges(),function(t){n.setEdge(t.v,t.w,{},t.name)}),x.forEach(t,function(t,e){n.setNode("layer"+e,{rank:"same"}),x.reduce(t,function(t,e){return n.setEdge(t,e,{style:"invis"}),e})}),n}},util:{time:M.time,notime:M.notime},version:"0.8.5"};function Vs(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e,this.center=[0,0],this.nodeSize=50,this.nodesep=10,this.ranksep=100,this.rankdir="TB",this.boolTransition=!0,this.intSteps=50,this.inited=!1,this.finished=!1,this.finishedCount=0,this.excute=function(){this.inited&&this.run()},this.getConfig=function(){return[{label:"节点大小",nodeSize:50},{label:"节点间距",nodesep:10},{label:"层间距",ranksep:120},{label:"排列方向",rankdir:"TB"}]},this.resetConfig=function(t){t&&(this.center=t.center||[0,0],this.nodeSize=t.nodeSize||50,this.nodesep=t.nodesep||10,this.ranksep=t.ranksep||120,this.rankdir=t.rankdir||"TB"),this.init()},this.addData=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e},this.init=function(){this.inited=!0,this.finished=!1;var e,n,i,r=this,o=new m.graphlib.Graph,s=(o.setDefaultEdgeLabel(function(){return{}}),o.setGraph({rankdir:r.rankdir||"TB",nodesep:r.nodesep||10,ranksep:r.ranksep||50}),new Map),a=(r.nodes.forEach(function(t){var e=t.width+r.nodesep,n=t.height+r.ranksep;o.setNode(t.id,{width:e,height:n}),s.set(String(t.id),t)}),r.links.forEach(function(t){o.setEdge(t.source.id,t.target.id,{weight:1})}),m.layout(o),[]),t=(o.nodes().forEach(function(t){e=o.node(t),a.push({x:e.x,y:e.y})}),r.getNodesCenter(a)),h=t.x-r.center[0],c=t.y-r.center[1],u=null;o.nodes().forEach(function(t){var e=o.node(t),t=(u=s.get(t),n=e.x-h,i=e.y-c,r.newLayoutData());t.finishx=n,t.finishy=i,t.xdistance=1/r.intSteps*(n-u.x),t.ydistance=1/r.intSteps*(i-u.y),u.layoutData=t})},this.newLayoutData=function(){return{finishx:0,finishy:0,xdistance:0,ydistance:0}},this.getNodesCenter=function(t){var e=0,n=0;return t.forEach(function(t){e+=t.x,n+=t.y}),e/=t.length,n/=t.length,{x:e,y:n}},this.run=function(){for(var t,e=this.nodes,n=e.length,i=0;i<n;i++){var r,o=e[i];null!=(t=o.layoutData)&&(this.boolTransition?(r=Math.abs(o.x-t.finishx),Math.abs(o.x+t.xdistance-t.finishx)<r?o.x+=t.xdistance:o.x=t.finishx,r=Math.abs(o.y-t.finishy),Math.abs(o.y+t.ydistance-t.finishy)<r?o.y+=t.ydistance:o.y=t.finishy,o.x==t.finishx&&o.y==t.finishy&&(o.layoutData=null,this.finishedCount++)):(o.x=t.finishx,o.y=t.finishy,o.layoutData=null,this.finishedCount++))}this.finished=this.finishedCount>=n}}function js(t,e){return t.parent===e.parent?1:2}function Fs(t,e){return t+e.x}function Xs(t,e){return Math.max(t,e.y)}function Ys(t){var e=0,n=t.children,i=n&&n.length;if(i)for(;0<=--i;)e+=n[i].value;else e=1;t.value=e}function Us(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=Gs)):void 0===e&&(e=Ws);for(var n,i,r,o,s,t=new Js(t),a=[t];n=a.pop();)if((r=e(n.data))&&(s=(r=Array.from(r)).length))for(n.children=r,o=s-1;0<=o;--o)a.push(i=r[o]=new Js(r[o])),i.parent=n,i.depth=n.depth+1;return t.eachBefore(Hs)}function Ws(t){return t.children}function Gs(t){return Array.isArray(t)?t[1]:null}function qs(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function Hs(t){for(var e=0;t.height=e,(t=t.parent)&&t.height<++e;);}function Js(t){this.data=t,this.depth=this.height=0,this.parent=null}function Ks(t){for(var e,n,i=0,r=(t=function(t){for(var e,n,i=t.length;i;)n=Math.random()*i--|0,e=t[i],t[i]=t[n],t[n]=e;return t}(Array.from(t))).length,o=[];i<r;)e=t[i],n&&Qs(n,e)?++i:(n=function(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return ta(t[0],t[1]);case 3:return ea(t[0],t[1],t[2])}var e}(o=function(t,e){var n,i;if($s(e,t))return[e];for(n=0;n<t.length;++n)if(Zs(e,t[n])&&$s(ta(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(i=n+1;i<t.length;++i)if(Zs(ta(t[n],t[i]),e)&&Zs(ta(t[n],e),t[i])&&Zs(ta(t[i],e),t[n])&&$s(ea(t[n],t[i],e),t))return[t[n],t[i],e];throw new Error}(o,e)),i=0);return n}function Zs(t,e){var n=t.r-e.r,i=e.x-t.x,e=e.y-t.y;return n<0||n*n<i*i+e*e}function Qs(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),i=e.x-t.x,e=e.y-t.y;return 0<n&&i*i+e*e<n*n}function $s(t,e){for(var n=0;n<e.length;++n)if(!Qs(t,e[n]))return;return 1}function ta(t,e){var n=t.x,i=t.y,t=t.r,r=e.x,o=e.y,e=e.r,s=r-n,a=o-i,h=e-t,c=Math.sqrt(s*s+a*a);return{x:(n+r+s/c*h)/2,y:(i+o+a/c*h)/2,r:(c+t+e)/2}}function ea(t,e,n){var i=t.x,r=t.y,t=t.r,o=e.x,s=e.y,e=e.r,a=n.x,h=n.y,n=n.r,c=i-o,u=i-a,l=r-s,d=r-h,f=e-t,p=n-t,g=i*i+r*r-t*t,o=g-o*o-s*s+e*e,s=g-a*a-h*h+n*n,e=u*l-c*d,g=(l*s-d*o)/(2*e)-i,a=(d*f-l*p)/e,h=(u*o-c*s)/(2*e)-r,n=(c*p-u*f)/e,d=a*a+n*n-1,l=2*(t+g*a+h*n),o=g*g+h*h-t*t,s=-(d?(l+Math.sqrt(l*l-4*d*o))/(2*d):o/l);return{x:i+g+a*s,y:r+h+n*s,r:s}}function na(t,e,n){var i,r,o,s,a=t.x-e.x,h=t.y-e.y,c=a*a+h*h;c?(r=e.r+n.r,s=t.r+n.r,(r*=r)>(s*=s)?(i=(c+s-r)/(2*c),o=Math.sqrt(Math.max(0,s/c-i*i)),n.x=t.x-i*a-o*h,n.y=t.y-i*h+o*a):(i=(c+r-s)/(2*c),o=Math.sqrt(Math.max(0,r/c-i*i)),n.x=e.x+i*a-o*h,n.y=e.y+i*h+o*a)):(n.x=e.x+n.r,n.y=e.y)}function ia(t,e){var n=t.r+e.r-1e-6,i=e.x-t.x,e=e.y-t.y;return 0<n&&i*i+e*e<n*n}function ra(t){var e=t._,t=t.next._,n=e.r+t.r,i=(e.x*t.r+t.x*e.r)/n,t=(e.y*t.r+t.y*e.r)/n;return i*i+t*t}function oa(t){this._=t,this.next=null,this.previous=null}function sa(t){if(!(o=(t="object"==typeof(e=t)&&"length"in e?e:Array.from(e)).length))return 0;var e,n,i,r,o,s,a,h,c,u,l,d;if((n=t[0]).x=0,n.y=0,!(1<o))return n.r;if(i=t[1],n.x=-i.r,i.x=n.r,i.y=0,!(2<o))return n.r+i.r;na(i,n,r=t[2]),n=new oa(n),i=new oa(i),r=new oa(r),((n.next=r.previous=i).next=n.previous=r).next=i.previous=n;t:for(h=3;h<o;++h){na(n._,i._,r=t[h]),r=new oa(r),c=i.next,u=n.previous,l=i._.r,d=n._.r;do{if(l<=d){if(ia(c._,r._)){i=c,(n.next=i).previous=n,--h;continue t}l+=c._.r,c=c.next}else{if(ia(u._,r._)){((n=u).next=i).previous=n,--h;continue t}d+=u._.r,u=u.previous}}while(c!==u.next);for(r.previous=n,r.next=i,n.next=i.previous=i=r,s=ra(n);(r=r.next)!==i;)(a=ra(r))<s&&(n=r,s=a);i=n.next}for(n=[i._],r=i;(r=r.next)!==i;)n.push(r._);for(r=Ks(n),h=0;h<o;++h)(n=t[h]).x-=r.x,n.y-=r.y;return r.r}function aa(t){if("function"!=typeof t)throw new Error;return t}function ha(){return 0}function ca(t){return function(){return t}}function ua(t){return Math.sqrt(t.value)}function la(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function da(s,a){return function(t){if(e=t.children){var e,n,i,r=e.length,o=s(t)*a||0;if(o)for(n=0;n<r;++n)e[n].r+=o;if(i=sa(e),o)for(n=0;n<r;++n)e[n].r-=o;t.r=i+o}}}function fa(n){return function(t){var e=t.parent;t.r*=n,e&&(t.x=e.x+n*t.x,t.y=e.y+n*t.y)}}function pa(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function ga(t,e,n,i,r){for(var o,s=t.children,a=-1,h=s.length,c=t.value&&(i-e)/t.value;++a<h;)(o=s[a]).y0=n,o.y1=r,o.x0=e,o.x1=e+=o.value*c}m.graphlib,m.layout,m.debug,m.util,m.version,Js.prototype=Us.prototype={constructor:Js,count:function(){return this.eachAfter(Ys)},each:function(t,e){let n=-1;for(const i of this)t.call(e,i,++n,this);return this},eachAfter:function(t,e){for(var n,i,r,o=this,s=[o],a=[],h=-1;o=s.pop();)if(a.push(o),n=o.children)for(i=0,r=n.length;i<r;++i)s.push(n[i]);for(;o=a.pop();)t.call(e,o,++h,this);return this},eachBefore:function(t,e){for(var n,i,r,o=[this],s=-1;r=o.pop();)if(t.call(e,r,++s,this),n=r.children)for(i=n.length-1;0<=i;--i)o.push(n[i]);return this},find:function(t,e){let n=-1;for(const i of this)if(t.call(e,i,++n,this))return i},sum:function(r){return this.eachAfter(function(t){for(var e=+r(t.data)||0,n=t.children,i=n&&n.length;0<=--i;)e+=n[i].value;t.value=e})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;for(t=n.pop(),e=i.pop();t===e;)r=t,t=n.pop(),e=i.pop();return r}(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,n=[];return e.each(function(t){t!==e&&n.push({source:t.parent,target:t})}),n},copy:function(){return Us(this).eachBefore(qs)},[Symbol.iterator]:function*(){var t,e,n,i,r,o=[this];do{for(t=o.reverse(),o=[];r=t.pop();)if(yield r,e=r.children)for(n=0,i=e.length;n<i;++n)o.push(e[n])}while(o.length)}};var ya={depth:-1},va={};function ma(t){return t.id}function xa(t){return t.parentId}function wa(t,e){return t.parent===e.parent?1:2}function ba(t){var e=t.children;return e?e[0]:t.t}function ka(t){var e=t.children;return e?e[e.length-1]:t.t}function Ma(t,e){this._=t,this.parent=null,this.children=null,this.A=null,(this.a=this).z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function Ea(t,e,n,i,r){for(var o,s=t.children,a=-1,h=s.length,c=t.value&&(r-n)/t.value;++a<h;)(o=s[a]).x0=e,o.x1=i,o.y0=n,o.y1=n+=o.value*c}Ma.prototype=Object.create(Js.prototype);var Ca=(1+Math.sqrt(5))/2;function Na(t,e,n,i,r,o){for(var s,a,h,c,u,l,d,f,p,g,y,v=[],m=e.children,x=0,w=0,b=m.length,k=e.value;x<b;){for(h=r-n,c=o-i;!(u=m[w++].value)&&w<b;);for(y=(l=d=u)*u*(g=Math.max(c/h,h/c)/(k*t)),p=Math.max(d/y,y/l);w<b;++w){if(u+=a=m[w].value,a<l&&(l=a),d<a&&(d=a),y=u*u*g,(f=Math.max(d/y,y/l))>p){u-=a;break}p=f}v.push(s={value:u,dice:h<c,children:m.slice(x,w)}),s.dice?ga(s,n,i,r,k?i+=c*u/k:o):Ea(s,n,i,k?n+=h*u/k:r,o),k-=u,x=w}return v}function La(t,e){var n,i=jt(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.id===e)return!0;if(void 0!==r.subgraph&&La(r.subgraph.nodes,e))return!0}}catch(t){i.e(t)}finally{i.f()}return!1}var Sa=function e(o){function t(t,e,n,i,r){Na(o,t,e,n,i,r)}return t.ratio=function(t){return e(1<(t=+t)?t:1)},t}(Ca),l=function e(f){function t(t,e,n,i,r){if((o=t._squarify)&&o.ratio===f)for(var o,s,a,h,c,u=-1,l=o.length,d=t.value;++u<l;){for(a=(s=o[u]).children,h=s.value=0,c=a.length;h<c;++h)s.value+=a[h].value;s.dice?ga(s,e,n,i,d?n+=(r-n)*s.value/d:r):Ea(s,e,n,d?e+=(i-e)*s.value/d:i,r),d-=s.value}else t._squarify=o=Na(f,t,e,n,i,r),o.ratio=f}return t.ratio=function(t){return e(1<(t=+t)?t:1)},t}(Ca),E=b({},Object.freeze({__proto__:null,cluster:function(){var a=js,h=1,c=1,u=!1;function e(e){var i,r=0,t=(e.eachAfter(function(t){var e,n=t.children;n?(t.x=(e=n).reduce(Fs,0)/e.length,t.y=1+n.reduce(Xs,0)):(t.x=i?r+=a(t,i):0,t.y=0,i=t)}),function(t){for(var e;e=t.children;)t=e[0];return t}(e)),n=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(e),o=t.x-a(t,n)/2,s=n.x+a(n,t)/2;return e.eachAfter(u?function(t){t.x=(t.x-e.x)*h,t.y=(e.y-t.y)*c}:function(t){t.x=(t.x-o)/(s-o)*h,t.y=(1-(e.y?t.y/e.y:1))*c})}return e.separation=function(t){return arguments.length?(a=t,e):a},e.size=function(t){return arguments.length?(u=!1,h=+t[0],c=+t[1],e):u?null:[h,c]},e.nodeSize=function(t){return arguments.length?(u=!0,h=+t[0],c=+t[1],e):u?[h,c]:null},e},hierarchy:Us,pack:function(){var e=null,n=1,i=1,r=ha;function o(t){return t.x=n/2,t.y=i/2,e?t.eachBefore(la(e)).eachAfter(da(r,.5)).eachBefore(fa(1)):t.eachBefore(la(ua)).eachAfter(da(ha,1)).eachAfter(da(r,t.r/Math.min(n,i))).eachBefore(fa(Math.min(n,i)/(2*t.r))),t}return o.radius=function(t){return arguments.length?(e=null==(t=t)?null:aa(t),o):e},o.size=function(t){return arguments.length?(n=+t[0],i=+t[1],o):[n,i]},o.padding=function(t){return arguments.length?(r="function"==typeof t?t:ca(+t),o):r},o},packSiblings:function(t){return sa(t),t},packEnclose:Ks,partition:function(){var n=1,i=1,a=0,r=!1;function e(t){var o,s,e=t.height+1;return t.x0=t.y0=a,t.x1=n,t.y1=i/e,t.eachBefore((o=i,s=e,function(t){t.children&&ga(t,t.x0,o*(t.depth+1)/s,t.x1,o*(t.depth+2)/s);var e=t.x0,n=t.y0,i=t.x1-a,r=t.y1-a;i<e&&(e=i=(e+i)/2),r<n&&(n=r=(n+r)/2),t.x0=e,t.y0=n,t.x1=i,t.y1=r})),r&&t.eachBefore(pa),t}return e.round=function(t){return arguments.length?(r=!!t,e):r},e.size=function(t){return arguments.length?(n=+t[0],i=+t[1],e):[n,i]},e.padding=function(t){return arguments.length?(a=+t,e):a},e},stratify:function(){var l=ma,d=xa;function e(t){for(var e,n,i,r,o,s,a=Array.from(t),h=a.length,c=new Map,u=0;u<h;++u)e=a[u],r=a[u]=new Js(e),null!=(o=l(e,u,t))&&(o+="")&&(s=r.id=o,c.set(s,c.has(s)?va:r)),null!=(o=d(e,u,t))&&(o+="")&&(r.parent=o);for(u=0;u<h;++u)if(o=(r=a[u]).parent){if(!(i=c.get(o)))throw new Error("missing: "+o);if(i===va)throw new Error("ambiguous: "+o);i.children?i.children.push(r):i.children=[r],r.parent=i}else{if(n)throw new Error("multiple roots");n=r}if(!n)throw new Error("no root");if(n.parent=ya,n.eachBefore(function(t){t.depth=t.parent.depth+1,--h}).eachBefore(Hs),n.parent=null,0<h)throw new Error("cycle");return n}return e.id=function(t){return arguments.length?(l=aa(t),e):l},e.parentId=function(t){return arguments.length?(d=aa(t),e):d},e},tree:function(){var y=wa,h=1,c=1,u=null;function e(a){var e,n,i,r,o,s,t=function(){for(var t,e,n,i,r,o=new Ma(a,0),s=[o];t=s.pop();)if(n=t._.children)for(t.children=new Array(r=n.length),i=r-1;0<=i;--i)s.push(e=t.children[i]=new Ma(n[i],i)),e.parent=t;return(o.parent=new Ma(null,0)).children=[o],o}();return t.eachAfter(l),t.parent.m=-t.z,t.eachBefore(d),u?a.eachBefore(f):((i=n=e=a).eachBefore(function(t){t.x<e.x&&(e=t),t.x>n.x&&(n=t),t.depth>i.depth&&(i=t)}),t=e===n?1:y(e,n)/2,r=t-e.x,o=h/(n.x+t+r),s=c/(i.depth||1),a.eachBefore(function(t){t.x=(t.x+r)*o,t.y=t.depth*s})),a}function l(t){var e=t.children,n=t.parent.children,g=t.i?n[t.i-1]:null;if(e){for(var i,r=0,o=0,s=t.children,a=s.length;0<=--a;)(i=s[a]).z+=r,i.m+=r,r+=i.s+(o+=i.c);e=(e[0].z+e[e.length-1].z)/2;g?(t.z=g.z+y(t._,g._),t.m=t.z-e):t.z=e}else g&&(t.z=g.z+y(t._,g._));t.parent.A=function(t,e){if(g){for(var n,i=t,r=t,o=g,s=i.parent.children[0],a=i.m,h=r.m,c=o.m,u=s.m;o=ka(o),i=ba(i),o&&i;)s=ba(s),(r=ka(r)).a=t,0<(n=o.z+c-i.z-a+y(o._,i._))&&(p=e,f=(f=o).a.parent===t.parent?f.a:p,p=void 0,p=(d=n)/((l=t).i-f.i),l.c-=p,l.s+=d,f.c+=p,l.z+=d,l.m+=d,a+=n,h+=n),c+=o.m,a+=i.m,u+=s.m,h+=r.m;o&&!ka(r)&&(r.t=o,r.m+=c-h),i&&!ba(s)&&(s.t=i,s.m+=a-u,e=t)}var l,d,f,p;return e}(t,t.parent.A||n[0])}function d(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function f(t){t.x*=h,t.y=t.depth*c}return e.separation=function(t){return arguments.length?(y=t,e):y},e.size=function(t){return arguments.length?(u=!1,h=+t[0],c=+t[1],e):u?null:[h,c]},e.nodeSize=function(t){return arguments.length?(u=!0,h=+t[0],c=+t[1],e):u?[h,c]:null},e},treemap:function(){var s=Sa,e=!1,n=1,i=1,a=[0],h=ha,c=ha,u=ha,l=ha,d=ha;function r(t){return t.x0=t.y0=0,t.x1=n,t.y1=i,t.eachBefore(o),a=[0],e&&t.eachBefore(pa),t}function o(t){var e=a[t.depth],n=t.x0+e,i=t.y0+e,r=t.x1-e,o=t.y1-e;r<n&&(n=r=(n+r)/2),o<i&&(i=o=(i+o)/2),t.x0=n,t.y0=i,t.x1=r,t.y1=o,t.children&&(e=a[t.depth+1]=h(t)/2,n+=d(t)-e,i+=c(t)-e,(r-=u(t)-e)<n&&(n=r=(n+r)/2),(o-=l(t)-e)<i&&(i=o=(i+o)/2),s(t,n,i,r,o))}return r.round=function(t){return arguments.length?(e=!!t,r):e},r.size=function(t){return arguments.length?(n=+t[0],i=+t[1],r):[n,i]},r.tile=function(t){return arguments.length?(s=aa(t),r):s},r.padding=function(t){return arguments.length?r.paddingInner(t).paddingOuter(t):r.paddingInner()},r.paddingInner=function(t){return arguments.length?(h="function"==typeof t?t:ca(+t),r):h},r.paddingOuter=function(t){return arguments.length?r.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):r.paddingTop()},r.paddingTop=function(t){return arguments.length?(c="function"==typeof t?t:ca(+t),r):c},r.paddingRight=function(t){return arguments.length?(u="function"==typeof t?t:ca(+t),r):u},r.paddingBottom=function(t){return arguments.length?(l="function"==typeof t?t:ca(+t),r):l},r.paddingLeft=function(t){return arguments.length?(d="function"==typeof t?t:ca(+t),r):d},r},treemapBinary:function(t,e,n,i,r){var o,s,g=t.children,a=g.length,y=new Array(a+1);for(y[0]=s=o=0;o<a;++o)y[o+1]=s+=g[o].value;!function t(e,n,i,r,o,s,a){if(n-1<=e)return(h=g[e]).x0=r,h.y0=o,h.x1=s,h.y1=a,0;for(var h=y[e],c=i/2+h,u=e+1,l=n-1;u<l;){var d=u+l>>>1;y[d]<c?u=1+d:l=d}c-y[u-1]<y[u]-c&&e+1<u&&--u;var f,h=y[u]-h,p=i-h;a-o<s-r?(t(e,u,h,r,o,f=i?(r*p+s*h)/i:s,a),t(u,n,p,f,o,s,a)):(t(e,u,h,r,o,s,f=i?(o*p+a*h)/i:a),t(u,n,p,r,f,s,a))}(0,a,t.value,e,n,i,r)},treemapDice:ga,treemapSlice:Ea,treemapSliceDice:function(t,e,n,i,r){(1&t.depth?Ea:ga)(t,e,n,i,r)},treemapSquarify:Sa,treemapResquarify:l})),_a=function(){return function(t,e){var n,i,r,o,s,a=e.links.reduce(function(t,e){return void 0===t[e.source]&&(t[e.source]=[]),t[e.source].push(e.target),void 0===t[e.target]&&(t[e.target]=[]),t[e.target].push(e.source),t},{}),h=(t=t||e.nodes[0].id,void 0===a[t]&&null!=(n=function(t,e){var n,i=jt(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.id===e)return r.id;if(void 0!==r.subgraph&&La(r.subgraph.nodes,e))return r.id}}catch(t){i.e(t)}finally{i.f()}}(e.nodes,t))?n:t);return void 0===a[h]?{nodes:e.nodes,links:e.links}:(t=void 0!==(null==(n=e.options)?void 0:n.size)?E.tree().size(e.options.size):E.tree().nodeSize(null!=(n=null==(t=e.options)?void 0:t.nodeSize)?n:[30,100]),void 0!==(null==(n=e.options)?void 0:n.separation)&&t.separation(e.options.separation),r=function t(e,n){if(void 0!==(n[e.data.id]=e).children){var i,r=jt(e.children);try{for(r.s();!(i=r.n()).done;)t(i.value,n)}catch(t){r.e(t)}finally{r.f()}}return n}(t(E.hierarchy(!1!==(null==(n=e.options)?void 0:n.bfs)?function(t,e){for(var n=[],i=[[e,n]],r=new Set([e]);0<i.length;){var o,s=Xt(i.shift(),2),a=s[0],h=s[1],c=jt(t[a]);try{for(c.s();!(o=c.n()).done;){var u,l=o.value;r.has(l)||(r.add(l),u=[],h.push({id:l,children:u}),i.push([l,u]))}}catch(t){c.e(t)}finally{c.f()}}return{id:e,children:n}}(a,h):function t(e,n,i){i.add(n);var r,o=[],s=jt(e[n]);try{for(s.s();!(r=s.n()).done;){var a=r.value;i.has(a)||o.push(t(e,a,i))}}catch(t){s.e(t)}finally{s.f()}return{id:n,children:o}}(a,h,new Set))),{}),t=(a=null!=(t=e.nodes.find(function(t){return t.id===h}))?t:{x:void 0,y:void 0}).x,a=a.y,o=(null!=(i=null==(i=e.options)?void 0:i.x)?i:0)+(null!=t?t:0),s=(null!=(t=null==(i=e.options)?void 0:i.y)?t:0)-(null!=a?a:0),{links:e.links,nodes:e.nodes.map(function(t){var e=r[t.id];return void 0===e?t:b(b({},t),{},{x:e.x+o,y:e.y-s})})})}},Ta=function(t,e){return t-=Math.PI/2,{x:e*Math.cos(t),y:e*Math.sin(t)}};function Pa(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e,this.center=[0,0],this.rootNodeId=null,this.type="radial",this.bfs=!0,this.nodeSize=30,this.layerDist=100,this.areaRadius=400,this.inited=!1,this.finished=!1,this.finishedCount=0,this.boolTransition=!0,this.intSteps=50,this.excute=function(){this.inited&&this.run()},this.getConfig=function(){return[{label:"根节点ID",rootNodeId:""},{label:"布局类型",type:"radial"},{label:"广度优先遍历",bfs:!0},{label:"节点大小",nodeSize:30},{label:"层间距",layerDist:100},{label:"分布面半径",areaRadius:400}]},this.resetConfig=function(t){t&&(this.center=t.center||[0,0],this.rootNodeId=t.rootNodeId||"",this.type=t.type||"radial",this.bfs=Boolean("false"!=t.bfs),this.nodeSize=Number(t.nodeSize)||30,this.layerDist=Number(t.layerDist)||100,this.areaRadius=Number(t.areaRadius)||400),this.init()},this.addData=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.nodes=t,this.links=e},this.init=function(){this.inited=!0,this.finished=!1,this.rootNodeId||(this.rootNodeId=this.nodes[0].id);var r="radial"==this.type,t={bfs:this.bfs,x:0,y:0,nodeSize:[this.nodeSize,this.layerDist]},e=(r&&(t.size=[2*Math.PI,this.areaRadius],t.separation=function(t,e){return(t.parent==e.parent?1:2)/t.depth}),[]),o={},n=(this.nodes.forEach(function(t){o[t.id]=t,e.push({id:t.id})}),this.links.map(function(t){return{id:t.id,source:t.source.id,target:t.target.id}})),n=(o[this.rootNodeId]||(this.rootNodeId=this.nodes[0].id),_a()(this.rootNodeId,{nodes:e,links:n,options:t})),s=this.center,a=this;n.nodes.forEach(function(t){var e=t.x+s[0],n=t.y+s[1],i=(r&&(e=(i=Ta(t.x,t.y)).x+s[0],n=i.y+s[1]),o[t.id]),t=a.newLayoutData();t.finishx=e,t.finishy=n,t.xdistance=1/a.intSteps*(e-i.x),t.ydistance=1/a.intSteps*(n-i.y),i.layoutData=t})},this.run=function(){for(var t,e=this.nodes,n=e.length,i=0;i<n;i++){var r,o=e[i];null!=(t=o.layoutData)&&(this.boolTransition?(r=Math.abs(o.x-t.finishx),Math.abs(o.x+t.xdistance-t.finishx)<r?o.x+=t.xdistance:o.x=t.finishx,r=Math.abs(o.y-t.finishy),Math.abs(o.y+t.ydistance-t.finishy)<r?o.y+=t.ydistance:o.y=t.finishy,o.x==t.finishx&&o.y==t.finishy&&(o.layoutData=null,this.finishedCount++)):(o.x=t.finishx,o.y=t.finishy,o.layoutData=null,this.finishedCount++))}this.finished=this.finishedCount>=n},this.newLayoutData=function(){return{finishx:0,finishy:0,xdistance:0,ydistance:0}}}function Oa(){var t=null;switch(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"fastLayout"){case"fastForce":t=new Et([],[]);break;case"concentric":t=new Nt([]);break;case"hierarchical":t=new Lt([],[]);break;case"grid":t=new St([]);break;case"circle":t=new Tt([],[]);break;case"kawakai":t=new _t([],[]);break;case"avoidlap":t=new Ct([]);break;case"forceDirected":t=new Pt([],[]);break;case"radialTree":t=new Ot([],[]);break;case"simulation":t=new At([],[]);break;case"arf":t=new It([],[]);break;case"tree":t=new Dt([],[]);break;case"cluster":t=new Bt([],[]);break;case"dagre":t=new Vs([],[]);break;case"radial":t=new Pa([],[]);break;default:t=new Ct([])}return t}function Aa(i,t){var n,e,r,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"fastForce",a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,h=5<arguments.length?arguments[5]:void 0,c=o.x,o=o.y,u=t.nodes||[],t=t.links||[],l=new Map,d=new Map,f=[],p=(u.forEach(function(t,e){n=e+1,d.set(t.id,n),l.set(n,t),f.push({id:n,scale:1,radius:Math.ceil(t.radius*(t.scale||1)),x:t.cx,y:t.cy,type:t.type||"default",selected:t.selected||!1,definedLevel:t.definedLevel})}),{}),g=[],y=(t.forEach(function(t){t.source.id!=t.target.id&&(e="".concat(t.source.id,"-").concat(t.target.id),r="".concat(t.target.id,"-").concat(t.source.id),p[e]&&p[r]||(g.push({source:d.get(t.source.id),target:d.get(t.target.id),weight:t.weight}),p[e]=!0,p[r]=!0))}),Math.round(Math.max(Math.sqrt(f.length)+10,20))),v=(u=function(t){var e="",n="";switch(t){case"fastForce":e=Et.toString(),n=Ct.toString();break;case"kawakai":e=_t.toString(),n=Ct.toString();break;case"hierarchical":e=Lt.toString();break;case"concentric":e=Nt.toString();break;case"circle":e=Tt.toString();break;case"grid":e=St.toString();break;case"forceDirected":e=Pt.toString();break;case"radialTree":e=Ot.toString();break;case"avoidlap":e=Ct.toString();break;case"simulation":e=At.toString();break;case"arf":e=It.toString();break;case"tree":e=Dt.toString();break;case"cluster":e=Bt.toString();break;default:e=Et.toString(),n=Ct.toString()}return t=e.indexOf("("),e="function Layout"+e.substring(t),0<n.length&&(t=n.indexOf("("),n="function AvoidOverlap"+n.substring(t))," ".concat(e," ").concat(n," ").concat("\n\nonmessage = function(event) {\n\t//获取主线程传输的数据\n\tvar array_buffer = new Uint8Array(event.data).buffer;\n\tvar decoder = new TextDecoder(\"utf-8\");\n\tvar view = new DataView(array_buffer, 0, array_buffer.byteLength);\n\tvar eventData = JSON.parse(decoder.decode(view));\n\t\n\tvar layoutType = eventData.layoutType || 'fastForce', //布局类型\n\t\tlayoutConfig = eventData.layoutConfig, //布局参数配置\n\t\tcenter=eventData.center||[0,0],  // 中心位置\n\t\ttotalTimes=eventData.totalTimes || 50; //计算次数\n\t\n\t//构建布局数据格式\n\tlet {nodes,links} = buildLayoutData(eventData.nodes,eventData.links);\n\t\n\t//如果节点数过多，需要布局类型进度调整\n\tif(nodes.length >= 1000 && layoutType=='kawakai'){\n\t\tlayoutType = 'fastForce';\n\t}\n\t\n\t//创建布局对象\n\tlet layout = new Layout(nodes,links);\n\t\n\tif(layoutType == 'fastForce'){\n\t\tif(layoutConfig){\n\t\t\tlayoutConfig['noverlap'] = true;\n\t\t\tlayout.resetConfig(layoutConfig);\n\t\t}else{\n\t\t\tlayout.resetConfig({\n\t\t\t\tfriction:0.8,\n\t\t\t\tlinkDistance:100,\n\t\t\t\tlinkStrength:0.03,\n\t\t\t\tcharge:-200,\n\t\t\t\tgravity:0.01,\n\t\t\t\tnoverlap:true,\n\t\t\t\tcenter:center\n\t\t\t});\n\t\t}\n\t}\n\telse if(layoutType == 'simulation'){\n\t\tif(layoutConfig){\n\t\t\tlayout.resetConfig(layoutConfig);\n\t\t}else{\n\t\t\tlayout.resetConfig({\n\t\t\t\tstrength:-1500,\n\t\t\t\tajustCluster:false,\n\t\t\t\tcenter:center\n\t\t\t});\n\t\t}\n\t}\n\telse if(layoutType == 'kawakai'){\n\t\t if(layoutConfig){\n\t\t \tlayout.resetConfig(layoutConfig);\n\t\t}else{\n\t\t\tlayout.resetConfig({sizeScale:1.5,center:center});\n\t\t}\n\t}\n\telse if(layoutType == 'grid'){\n\t\tif(layoutConfig){\n\t\t\tlayout.resetConfig(layoutConfig);\n\t\t}else{\n\t\t\tlayout.resetConfig({nodeSpace:120,layerSpace:120,splitType:2,center:center});\n\t\t}\n\t\tlayout.boolTransition = false;\n\t\ttotalTimes = 1;\n\t}\n\telse if(layoutType == 'concentric'){\n\t\tif(layoutConfig){\n\t\t\tlayout.resetConfig(layoutConfig);\n\t\t}else{\n\t\t\tlayout.resetConfig({maxNodeSize:80,levelWidth:1,center:center});\n\t\t}\n\t\tlayout.boolTransition = false;\n\t\ttotalTimes = 1;\n\t}\n\telse if(layoutType == 'circle'){\n\t\tif(layoutConfig){\n\t\t\tlayout.resetConfig(layoutConfig);\n\t\t}else{\n\t\t\tlayout.resetConfig({scale:1.2,ordering:'degree',center:center});\n\t\t}\n\t\tlayout.boolTransition = false;\n\t\ttotalTimes = 1;\n\t}\n\telse if(layoutType == 'radialTree'){\n\t\tlayout.resetConfig({center:center});\n\t\tlayout.boolTransition = false;\n\t\ttotalTimes = 1;\n\t}\n\telse if(layoutType == 'forceDirected'){\n\t\tlayout.resetConfig({center:center});\n\t}\n\telse if(layoutType == 'hierarchical'){\n\t\tif(layoutConfig){\n\t\t\tlayout.resetConfig(layoutConfig);\n\t\t}else{\n\t\t\tlayout.resetConfig({nodeSpace:100,layerSpace:160,sortType:'hubsize',direction: 'UD',center:center});\n\t\t}\n\t\tlayout.boolTransition = false;\n\t\ttotalTimes = 1;\n\t}else if(layoutType == 'arf'){\n\t\tif(layoutConfig){\n\t\t\tlayout.resetConfig(layoutConfig);\n\t\t}else{\n\t\t\tlayout.resetConfig({neighberForce:8.0,attraction:0.05,forceScale:8.0,center:center});\n\t\t}\n\t\ttotalTimes += 50;\n\t}else if(layoutType == 'tree'){\n\t\tif(layoutConfig){\n\t\t\tlayout.resetConfig(layoutConfig);\n\t\t}else{\n\t\t\tlayout.resetConfig({nodeSpace:100,layerSpace:160,direction: 'UD',center:center});\n\t\t}\n\t\tlayout.boolTransition = false;\n\t\ttotalTimes = 1;\n\t}else if(layoutType == 'cluster'){\n\t\tif(layoutConfig){\n\t\t\tlayout.resetConfig(layoutConfig);\n\t\t}else{\n\t\t\tlayout.resetConfig({area:5,speed:10,center:center});\n\t\t}\n\t}else{\n\t\tlayout.init();\n\t}\n\t\n\t//布局次数计数器\n\tlet layoutTimes=0;\n\n\t//执行n次布局\n\twhile(layoutTimes++ < totalTimes){\n\t\tvar index = 0;\n\t\twhile(index++ < 10){\n\t\t\tlayout.excute(); //执行布局算法\n\t\t}\n\t\tpostMessage({type: \"ticked\", counter:layoutTimes});\n\t}\n\n\t//对数据进行缩放\n\t// if(['kawakai'].indexOf(layoutType) != -1){\n\t// \tnodes = coordsScale(nodes,1.6);\n\t// }\n\n\t//当节点大于100并且为网络布局时，调整节点尽量避免重叠\n\tif(nodes.length > 100 && ['fastForce','kawakai'].indexOf(layoutType) != -1){\n\t\tpostMessage({type: \"ticked\", counter:layoutTimes-1});\n\t\toverlapLayout(nodes);\n\t}\n\t\n\tvar finishedNodes = nodes.map(function(node){\n\t\treturn {\n\t\t\tid:node.id,\n\t\t\tx: Math.round(node.x),\n\t\t\ty: Math.round(node.y)\n\t\t};\n\t});\n\t\n\tpostMessage({type: \"completed\", nodes:finishedNodes});\n\tself.close();\n\n\t//避免重叠的调整布局\n\tfunction overlapLayout(nodes){\n\t\tvar overlap= new AvoidOverlap({nodes:nodes});\n\t\toverlap.resetConfig({maxPadding:10});\n\n\t\tvar overlapTime = Math.min(Math.round(Math.sqrt(nodes.length)),200);\n\t\tvar index = 0;\n\t\twhile(index++ < overlapTime){\n\t\t\toverlap.excute();\n\t\t}\n\t};\n\n\t//图缩放比例\n\tfunction coordsScale(_nodes,scale){\n\t\tvar nodeCount = nodes.length;\n        var xMean = 0,yMean = 0;\n\t\t_nodes.forEach(function(n) {\n            xMean += n.x;\n            yMean += n.y\n        });\n        xMean /= nodeCount;\n        yMean /= nodeCount;\n        _nodes.forEach(function(node) {\n            node.x = xMean + ((node.x - xMean) * scale);\n            node.y = yMean + ((node.y - yMean) * scale);\n        });\n\t\treturn _nodes;\n\t};\n\t\n\t//构建可视化布局数据\n\tfunction buildLayoutData(_nodes=[],_links=[]){\n\t\tvar nodeIdMapNode= new Map();\n\t\t_nodes.forEach(function(n){\n\t\t\tn.scale = 1;\n\t\t\tn.radius=Math.ceil(n.radius*(n.scale?n.scale:1));\n\t\t\tn.x = n.x || Math.round(Math.random()*1000);\n\t\t\tn.y = n.y || Math.round(Math.random()*1000);\n\t\t\tn.selected = n.selected || false;\n\t\t\tn.cluster = n.cluster;\n\t\t\t\n\t\t\tnodeIdMapNode.set(n.id,n);\n\t\t});\n\t\t\n\t\tvar links=[];\n\t\t_links.forEach(function(l){\n\t\t\tvar sourceNode = nodeIdMapNode.get(l.source),\n\t\t\t\ttargetNode = nodeIdMapNode.get(l.target);\n\t\t\n\t\t\tif(sourceNode){\n\t\t\t\tsourceNode.outLinks=sourceNode.outLinks||[];\n\t\t\t\tsourceNode.outLinks.push({\n\t\t\t\t\tsource:sourceNode,\n\t\t\t\t\ttarget:targetNode\n\t\t\t\t});\n\t\t\t}\n\t\t\n\t\t\tif(targetNode){\n\t\t\t\ttargetNode.inLinks=targetNode.inLinks||[];\n\t\t\t\ttargetNode.inLinks.push({\n\t\t\t\t\tsource:sourceNode,\n\t\t\t\t\ttarget:targetNode\n\t\t\t\t});\n\t\t\t}\n\t\t\n\t\t\tlinks.push({\n\t\t\t\tsource:sourceNode,\n\t\t\t\ttarget:targetNode\n\t\t\t});\n\t\t});\n\t\t\n\t\tvar newNodes = [];\n\t\tnodeIdMapNode.forEach(function(value, key) {\n\t\t\tnewNodes.push(value);\n\t\t});\n\t\t\n\t\treturn {nodes:newNodes,links:links};\n\t}\n};\n\n")}(s),t=window.URL||window.webkitURL,u=new Blob([u],{type:"text/javascript"}),t=t.createObjectURL(u),new Worker(t)),u=new TextEncoder("utf-8").encode(JSON.stringify({totalTimes:y,nodes:f,links:g,center:[c,o],layoutType:s,layoutConfig:a}));function m(t){var e;t.nodes.forEach(function(t){(e=l.get(t.id)).cx=t.x,e.cy=t.y}),v.terminate(),i.hideLoadProcess(),"function"==typeof h&&h()}v.postMessage(u.buffer,[u.buffer]),v.onmessage=function(t){switch(t.data.type){case"ticked":return e=(e=t.data).counter/y,n=Math.floor(100*e)+"%",void i.showLoadProcess("布局进度:(".concat(n,")"),e.toFixed(2));case"completed":return m(t.data)}var e,n}}function C(t,e){this.defaultOption={nodeRadius:30,minCircleRadius:150,graphMargin:100,animate:!0},this.option=this.deepExtend(this.defaultOption,e,!0,!0),this.graphVis=t,this.sourceData={nodes:[],links:[]}}C.prototype.activeAddData=function(y,t,e,n){var v=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,i=5<arguments.length?arguments[5]:void 0,m=this,r={nodes:t.nodes.map(function(t){return{id:t.id}}),links:t.links.map(function(t){return{id:t.id,source:t.source,target:t.target}})},r=(this.sourceData=t,m.validateData(y,r)),x=r.nodes.filter(function(t){return 1==t.increamFlag});if(x.length<=1)return w([],m.addLinks(t.links)),!1;var h=m.graphVis.buildVisualGraphData(r.nodes,r.links);function o(t){var e,n,i,r=t.nodes.filter(function(t){return 1==t.increamFlag}),o=0<(y.inLinks||[]).length||0<(y.outLinks||[]).length,s=0===(y.inLinks||[]).length&&0===(y.outLinks||[]).length&&1<v,o=((o||s)&&(o=m.getBounds(r),s=m.option.minCircleRadius,3<r.length&&(s=Math.round(Math.max(o.width/2,o.height/2))+m.option.graphMargin,s=Math.max(m.option.minCircleRadius,s)),i=o.centerX,o=o.centerY,e=y.cx-i,n=y.cy-o,r.forEach(function(t){t.cx-=e,t.cy-=n,t.x-=e,t.y-=n}),3<r.length)&&(i=m.findAngleParent(y).node,m.autoMoveChildNode(y,i,s,!0)),t.nodes.filter(function(t){return t.id==y.id})[0]),a=o.cx-y.cx,h=o.cy-y.cy,c=new Map,u=(m.sourceData.nodes.forEach(function(t){c.set(t.id,t)}),1),l=(m.option.animate&&(u=.1),[]),l=(x.forEach(function(t){var e;y.id!=t.id&&((e=c.get(t.id)).style=b(b({},e.style),{},{cx:t.cx-a,cy:t.cy-h,alpha:u,scale:u}),l.push(e))}),m.graphVis.addNodes(l)),d=(d=x.map(function(t){return t.id})).filter(function(t){return t!=y.id}),f=m.graphVis.nodes.filter(function(t){return-1!=d.indexOf(t.id)});if(0==f.length)return w([],[]);var p=y.cx,g=y.cy;m.option.animate?m.graphVis.createBaseAnimate({targets:l,duration:800,easing:"easeOutQuad",scale:1,alpha:1,begin:function(t){m.graphVis.switchAnimate(!0),m.graphVis.moveNodeToCenter({x:p,y:g},700)}}).finished.then(function(){m.graphVis.switchAnimate(!1);var t=m.addLinks(m.sourceData.links);w(f,t)}):(m.graphVis.moveNodeToCenter({x:p,y:g}),r=m.addLinks(m.sourceData.links),w(f,r))}function w(t,e){i&&"function"==typeof i&&i(t,e)}null!=y?(y.oldX=Math.round(y.cx),y.oldY=Math.round(y.cy),!(x.length<=10)&&e?(n?(n.center=[y.cx,y.cy],n.noverlap=!0):n={center:[y.cx,y.cy],friction:.9,linkDistance:100,linkStrength:.1,charge:-300,gravity:.01,noverlap:!0},m.graphVis.excuteWorkerLayout({nodes:h.nodes,links:h.links},e,n,!1,function(){o(h)})):(m.runStarLayout(y,h.nodes),o(h))):(e=e||"fastForce",t=m.graphVis.getViewCenter(),(n=n||{center:[t.x,t.y],friction:.9,linkDistance:100,linkStrength:.1,charge:-300,gravity:.01,noverlap:!0}).center=[t.x,t.y],n.noverlap=!0,m.graphVis.excuteWorkerLayout({nodes:h.nodes,links:h.links},e,n,!1,function(){var t=(t=h).nodes.filter(function(t){return t.x=t.cx,t.y=t.cy,1==t.increamFlag}),e={centerX:(e=m.graphVis.getViewCenter()).x,centerY:e.y,width:10,height:10,left:e.x,right:e.y+10,top:e.y,bottom:e.y+10},t=(0<m.graphVis.nodes.length&&(e=m.getBounds(m.graphVis.nodes)),m.getBounds(t)),n=e.centerY,e={x:e.right+t.width/2+m.option.graphMargin,y:n},i=t.centerX-e.x,r=t.centerY-e.y,o=new Map,s=(m.sourceData.nodes.forEach(function(t){o.set(t.id,t)}),[]),a=(x.forEach(function(t){var e=o.get(t.id);e.x=t.cx-i,e.y=t.cy-r,s.push(e)}),s=m.graphVis.addNodes(s),x.map(function(t){return t.id}));0==(n=m.graphVis.nodes.filter(function(t){return-1!=a.indexOf(t.id)})).length?w([],[]):(m.option.animate?m.graphVis.moveNodeToCenter({x:e.x,y:e.y},600):m.graphVis.moveNodeToCenter({x:e.x,y:e.y}),w(n,m.addLinks(m.sourceData.links)))}))},C.prototype.addLinks=function(t){var e,n=this.graphVis.links.map(function(t){return t.id||t.source.id+"@"+t.target.id}),i=[];return t.forEach(function(t){e=t.id||t.source+"@"+t.target,-1==n.indexOf(e)&&i.push(t)}),this.graphVis.addEdges(i)},C.prototype.findAngleParent=function(t){var n={relations:0,node:null};return 0<(t.inLinks||[]).length?t.inLinks.forEach(function(t){var t=t.source,e=(t.inLinks||[]).length+(t.outLinks||[]).length;n.relations<e&&(n.relations=e,n.node=t)}):(t.outLinks||[]).forEach(function(t){var t=t.target,e=(t.inLinks||[]).length+(t.outLinks||[]).length;n.relations<e&&(n.relations=e,n.node=t)}),n},C.prototype.validateData=function(t,e){var n,i={nodes:[],links:[]},r=[];return null!=t&&(i.nodes.push({id:t.id,increamFlag:!0}),r.push(t.id)),null!=e&&(n=this.graphVis.nodes.map(function(t){return t.id}),e.nodes.forEach(function(t){-1==n.indexOf(t.id)&&(t.increamFlag=!0,i.nodes.push(t),r.push(t.id))}),e.links.forEach(function(t){-1!=r.indexOf(t.source)&&-1!=r.indexOf(t.target)&&i.links.push(t)})),i},C.prototype.autoMoveChildNode=function(t,e){var n,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:200,r=3<arguments.length?arguments[3]:void 0,o=t.cx,s=t.cy,a=Math.PI,h=(e&&(n=e.cx,e=e.cy,a=Math.atan2(s-e,o-n)),this.graphVis.nodes),c=h.length,u=o,l=s,d=null;if(r)for(var f=!0,p=0;f;)for(var g=0;g<c;g++)if((d=h[g]).id!=t.id&&(f=this.checkNodeInCircle(d,u,l,i))){for(var u=Math.round(o+80*p*Math.cos(a)),l=Math.round(s+80*p*Math.sin(a)),y=a,v=a,m=1;m++<=12;)for(var x=0;x<c;x++)if((d=h[x]).id!=t.id&&this.checkNodeInCircle(d,u,l,i)){if(y+=Math.PI/18,u=Math.round(o+80*p*Math.cos(y)),l=Math.round(s+80*p*Math.sin(y)),this.checkNodeInCircle(d,u,l,i)){v-=Math.PI/18,u=Math.round(o+80*p*Math.cos(v)),l=Math.round(s+80*p*Math.sin(v));break}break}p+=.1;break}t.cx=u,t.cy=l},C.prototype.checkNodeInCircle=function(t,e,n,i){return(e-t.cx)*(e-t.cx)+(n-t.cy)*(n-t.cy)<i*i},C.prototype.getBounds=function(t){var e={left:Number.MAX_VALUE,right:-Number.MIN_VALUE,top:Number.MAX_VALUE,bottom:-Number.MIN_VALUE},n=0,i=0;return t.forEach(function(t){e.left=Math.ceil(Math.min(t.x,e.left)),e.right=Math.ceil(Math.max(t.x,e.right)),e.top=Math.ceil(Math.min(t.y,e.top)),e.bottom=Math.ceil(Math.max(t.y,e.bottom)),n+=t.x,i+=t.y}),n/=t.length,i/=t.length,n=Math.round(n),i=Math.round(i),e.width=Math.round(e.right-e.left),e.height=Math.round(e.bottom-e.top),e.centerX=n,e.centerY=i,e},C.prototype.computeRadius=function(t){for(var e=this.option.minCircleRadius||150,n=t.length,i=0,r=0;r<n;r++)i+=2*t[r].radius*2;var o=Math.round(i/(2*Math.PI));return o<e?e:o},C.prototype.findAngle=function(t,e,n,i){i=Math.atan((i-e)/(n-t));return 0<=n-t?i+Math.PI:i},C.prototype.runStarLayout=function(e,t){var n,i=e.cx,r=e.cy,o=this.computeRadius(t),s=0;(0<(e.inLinks||[]).length||0<(e.outLinks||[]).length)&&(n=this.findAngleParent(e).node,s=this.findAngle(i,r,n.cx,n.cy));for(var a=t.filter(function(t){return e.id==t.id&&(t.cx=0,t.cy=0),1==t.increamFlag&&e.id!=t.id}),h=a.length,c=s,u=0;u<h;u++){var l,d,f=a[u];null!=f&&(d=l=0,d=2==h?(c=0==u?s-Math.PI/8:s+Math.PI/8,l=o*Math.cos(2*Math.PI+c),o*Math.sin(2*Math.PI+c)):(l=o*Math.cos(2*Math.PI/h*u+c),o*Math.sin(2*Math.PI/h*u+c)),f.cx=l,f.cy=d)}},C.prototype.deepExtend=function(t,e,n,i){for(var r in e)if(e.hasOwnProperty(r)||!0===n)if(e[r]&&e[r].constructor===Object)void 0===t[r]&&(t[r]={}),t[r].constructor===Object?this.deepExtend(t[r],e[r],n):null===e[r]&&void 0!==t[r]&&!0===i?delete t[r]:t[r]=e[r];else if(Array.isArray(e[r])){t[r]=[];for(var o=0;o<e[r].length;o++)t[r].push(e[r][o])}else null===e[r]&&void 0!==t[r]&&!0===i?delete t[r]:t[r]=e[r];return t};function Ia(t,n){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],r=3<arguments.length?arguments[3]:void 0,o=t.nodes,s={},a={},h={};o.forEach(function(t,e){t=t.id;a[t]=1/0,t===n&&(a[t]=0)});for(var c,e=o.length,u=function(t){var n=function(){for(var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=1/0,o=0;o<n.length;o++){var s=n[o].id;!i[s]&&e[s]<=r&&(r=e[s],t=n[o])}return t}(a,o,s),e=n.id;if(s[e]=!0,a[e]===1/0)return"continue";e=n.outLinks||[];i||(c=(n.inLinks||[]).map(function(t){return{source:t.target,target:t.source}}),e=e.concat(c)),e.forEach(function(t){var e=t.target.id,t=t[""+r]||1;a[e]>a[n.id]+t&&(a[e]=a[n.id]+t,h[e]=n.id)})},l=0;l<e;l++)u();var d,f={};for(d in a){f[d]=[d];for(var p=h[d];void 0!==p;)f[d].unshift(p),p=h[p]}return{length:a,path:f}}function Da(e,t){var n=[];return n="target"==t?(e.outLinks||[]).map(function(t){return t.target}).filter(function(t){return t.id!=e.id}):(n=(e.outLinks||[]).map(function(t){return t.target}).filter(function(t){return t.id!=e.id}),t=(e.inLinks||[]).map(function(t){return t.source}).filter(function(t){return t.id!=e.id}),n.concat(t))}function Ba(t,e){return t.nodes.filter(function(t){return t.id==e})}function za(t,e){var n=[];return n="target"==e?(t.outLinks||[]).map(function(t){return t.target}):(n=(t.outLinks||[]).map(function(t){return t.target}),e=(t.inLinks||[]).map(function(t){return t.source}),n.concat(e))}function Ra(t,e){return(e?function(s){function a(t){u[t.id]=f,l[t.id]=f,f+=1,h.push(t),c[t.id]=!0;for(var e=za(t,"target").filter(function(t){return-1<s.indexOf(t)}),n=0;n<e.length;n++){var i=e[n];u[i.id]||0===u[i.id]?c[i.id]&&(l[t.id]=Math.min(l[t.id],u[i.id])):(a(i),l[t.id]=Math.min(l[t.id],l[i.id]))}if(l[t.id]===u[t.id]){for(var r=[];0<h.length;){var o=h.pop();if(c[o.id]=!1,r.push(o),o===t)break}0<r.length&&d.push(r)}}var t,h=[],c={},u={},l={},d=[],f=0,e=jt(s);try{for(e.s();!(t=e.n()).done;){var n=t.value;u[n.id]||0===u[n.id]||a(n)}}catch(s){e.e(s)}finally{e.f()}return d}:function(t){for(var e=[],o={},s=[],n=function t(e){s.push(e),o[e.id]=!0;for(var n=za(e),i=0;i<n.length;++i){var r=n[i];o[r.id]||t(r)}},i=0;i<t.length;i++){var r=t[i];if(!o[r.id]){n(r);for(var a=[];0<s.length;)a.push(s.pop());e.push(a)}}return e})(t)}function Va(t,e,n,i,r){for(var o=new Array(t.length),s=0;s<e.length;s++){var a=i[e[s]],h=i[n[s]];o[a]=o[a]||[],o[a].push(h),r&&(o[h]=o[h]||[],o[h].push(a))}return o}function ja(t,e){return-1===t[e]?e:ja(t,t[e])}function Fa(t,e,n){for(var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3],r=new Int32Array(t.length),o={},s=0;s<t.length;s++)r[s]=-1,o[t[s]]=s;for(var a,h=0;h<e.length;h++){var c=o[e[h]],u=o[n[h]];if(i&&c===u)return!0;var c=ja(r,c),u=ja(r,u);if(c===u)return!0;u=u,c=ja(a=r,c=c),u=ja(a,u),a[c]=u}return!1}function Xa(t,e,n){for(var i=t.length,r=new Uint8Array(i),o=new Uint8Array(i),s=new Int32Array(i),a={},h=0;h<i;h++)a[t[h]]=h;for(var c=Va(t,e,n,a,!1),u=0;u<i;u++){var l=[];if(function t(e,n,i,r,o,s,a,h){if(r[e]=o,i[e])return 1;if(!n[e]){if(n[e]=1,i[e]=1,o=s[e]){var c,u=jt(o);try{for(u.s();!(c=u.n()).done;){var l=c.value;if(t(l,n,i,r,e,s,a,h))return a.push(h[l]),1}}catch(e){u.e(e)}finally{u.f()}}return i[e]=0}}(u,r,o,s,-1,c,l,t)&&1<l.length){for(var d=l[0],f=1;f<l.length;f++)if(l[f]===d){l.length=f;break}return l.push(d),!0}}return!1}B((n=Ua).prototype,[{key:"getCycles",value:function(){this.visited=new Uint8Array(this.nodes.length),this.visitedStack=[];for(var t=0;t<this.nodes.length;t++)for(this.backtrack(t,t);0!==this.visitedLength;){var e=this.visitedStack.pop();void 0!==e&&this.visited[e]&&(this.visited[e]=0,this.visitedLength--)}return this.cycles}},{key:"backtrack",value:function(t,e){var n=!1;this.stack.push(e),this.visited[e]||(this.visited[e]=1,this.visitedLength++),this.visitedStack.push(e);var i,r,o=jt(this.adjacency[e]||[]);try{for(o.s();!(i=o.n()).done;){var s,a=i.value;if(this.removed[e]=this.removed[e]||{},!this.removed[e][a])if(a<t)this.removed[e][a]=!0;else if(a===t){for(var n=!0,h=[],c=0,u=!1;c<this.stack.length;c++){var l=this.stack[c];(u=t===l?!0:u)&&h.push(this.nodes[l])}this.cycles.push(h)}else this.visited[a]||(s=this.backtrack(t,a),n=n||s)}}catch(t){o.e(t)}finally{o.f()}if(n)for(;r=this.visitedStack.pop(),this.visited[r]&&(this.visited[r]=0,this.visitedLength--),r!==e;);return this.stack.pop(),n}}]),Object.defineProperty(n,"prototype",{writable:!1});var Ya=Ua;function Ua(t,e,n){if(!(this instanceof Ua))throw new TypeError("Cannot call a class as a function");this.cycles=[],this.visitedLength=0,this.visitedStack=[],this.stack=[],this.idToIndex={},this.removed={},this.nodes=t,this.visited=new Uint8Array(this.nodes.length);for(var i=0;i<t.length;i++)this.idToIndex[t[i]]=i;this.adjacency=Va(t,e,n,this.idToIndex)}function Wa(t){if("uniqueLinkId"in(t=t||{})&&(t.multigraph=t.uniqueLinkId),void 0===t.multigraph&&(t.multigraph=!1),"function"!=typeof Map)throw new Error("graph requires `Map` to be defined");var a=new Map,o=new Map,s={},h=t.multigraph?function(t,e,n){var i=Ja(t,e),r=s.hasOwnProperty(i);return(r||l(t,e))&&(r||(s[i]=0),i=Ja(t+(r="@"+ ++s[i]),e+r)),new Ha(t,e,n,i)}:function(t,e,n){var i=Ja(t,e),r=o.get(i);return r?(r.data=n,r):new Ha(t,e,n,i)};return{addNode:c,addLink:function(t,e,n){var i=u(t)||c(t),r=u(e)||c(e),n=h(t,e,n);return o.set(n.id,n),qa(i,n),t!==e&&qa(r,n),n},removeLink:function(t,e){return r(t=void 0!==e?l(t,e):t)},removeNode:e,getNode:u,getNodeCount:n,getLinkCount:i,getEdgeCount:i,getLinksCount:i,getNodesCount:n,getLinks:function(t){t=u(t);return t?t.links:null},forEachNode:d,forEachLinkedNode:function(t,e,n){var i=u(t);if(i&&i.links&&"function"==typeof e)return(n?function(t,e,n){for(var i=t.values(),r=i.next();!r.done;){var o=r.value;if(o.fromId===e&&n(a.get(o.toId),o))return!0;r=i.next()}}:function(t,e,n){for(var i=t.values(),r=i.next();!r.done;){var o=r.value,s=o.fromId===e?o.toId:o.fromId;if(n(a.get(s),o))return!0;r=i.next()}})(i.links,t,e)},forEachLink:function(t){if("function"==typeof t)for(var e=o.values(),n=e.next();!n.done;){if(t(n.value))return!0;n=e.next()}},clear:function(){d(function(t){e(t.id)})},hasLink:l,hasNode:u,getLink:l};function c(t,e){if(void 0===t)throw new Error("Invalid node identifier");var n=u(t);return n?n.data=e:n=new Ga(t,e),a.set(t,n),n}function u(t){return a.get(t)}function e(t){var e,n=u(t);return!!n&&((e=n.links)&&(e.forEach(r),n.links=null),a.delete(t),!0)}function n(){return a.size}function i(){return o.size}function r(t){if(!t)return!1;if(!o.get(t.id))return!1;o.delete(t.id);var e=u(t.fromId),n=u(t.toId);return e&&e.links.delete(t),n&&n.links.delete(t),!0}function l(t,e){if(void 0!==t&&void 0!==e)return o.get(Ja(t,e))}function d(t){if("function"!=typeof t)throw new Error("Function is expected to iterate over graph nodes. You passed "+t);for(var e=a.values(),n=e.next();!n.done;){if(t(n.value))return!0;n=e.next()}}}function Ga(t,e){this.id=t,this.links=null,this.data=e}function qa(t,e){t.links?t.links.add(e):t.links=new Set([e])}function Ha(t,e,n,i){this.fromId=t,this.toId=e,this.data=n,this.id=i}function Ja(t,e){return t.toString()+"-"+e.toString()}function Ka(t,e){"number"!=typeof e&&(e=.005),this.internalJumpProbability=t="number"!=typeof t?.85:t,this.epsilon=e,this.elementsPerNode=5}function Za(t,e){var n=Wa();t.forEach(function(t){n.addNode(t.id)}),e.forEach(function(t){n.addLink(t.source.id,t.target.id)}),this.graph=n}Ka.prototype.compute=function(t){var e=t.getNodesCount(),t=this.initializeAsmGraph(t),n=t.nodes,i=t.edges;return this.computePageRank(n,i,e,this.internalJumpProbability,this.epsilon),this.finalResultsFromAsm(n,t.numberToId)},Ka.prototype.computePageRank=function(t,e,n,i,r){var o,s=0,a=0;do{for(var a=0,h=0;h<n;++h){var c=0,u=t[3+(o=h*this.elementsPerNode)];if(0===u)t[o]=0;else{for(var l=t[o+4],d=l;d<l+u;++d){var f=e[d];c+=t[f+1]/t[f+2]}t[o]=i*c,a+=t[o]}}for(a=(1-a)/n,h=s=0;h<n;++h)c=t[o=h*this.elementsPerNode]+a,s+=Math.abs(c-t[o+1]),t[o+1]=c}while(!(s<r))},Ka.prototype.finalResultsFromAsm=function(t,e){for(var n=Object.create(null),i=t.length/this.elementsPerNode,r=0;r<i;++r){var o=r*this.elementsPerNode;n[e[r]]=t[1+o]}return n},Ka.prototype.initializeAsmGraph=function(o){var s=this,n=0,a=0,t=o.getNodesCount(),e=o.getLinksCount(),i=1/t,h=new Float64Array(t*s.elementsPerNode),c=new Float64Array(e),r=new Array(t),u=Object.create(null);return o.forEachNode(function(t){var e=n*s.elementsPerNode;h[e]=i,h[1+e]=i,h[2+e]=0,h[3+e]=0,h[4+e]=-1,u[t.id]=n,r[n]=t.id,n+=1}),o.forEachNode(function(n){var t=u[n.id]*s.elementsPerNode,i=0,r=0,e=a;o.forEachLinkedNode(n.id,function(t,e){e.fromId===n.id&&(r+=1),e.toId===n.id&&(i+=1,c[a++]=u[t.id]*s.elementsPerNode)}),h[2+t]=r,h[3+t]=i,e!==a&&(h[4+t]=e)}),{nodes:h,edges:c,numberToId:r}},Za.prototype.betweennes=function(h){var c,u=this.graph,l=[],d=[],f=Object.create(null),p=Object.create(null),g=Object.create(null),y=Object.create(null),v=Object.create(null);return u.forEachNode(function(t){v[t.id]=0}),u.forEachNode(function(t){t=c=t.id;for(u.forEachNode(function(t){t=t.id;f[t]=[],p[t]=-1,g[t]=0}),p[t]=0,g[t]=1,l.push(t);l.length;){var e=l.shift();d.push(e),u.forEachLinkedNode(e,n,h)}function n(t){t=t.id,-1===p[t]&&(p[t]=p[e]+1,l.push(t)),p[t]===p[e]+1&&(g[t]+=g[e],f[t].push(e))}for(u.forEachNode(function(t){y[t.id]=0});d.length;){for(var i=d.pop(),r=(1+y[i])/g[i],o=f[i],s=0;s<o.length;++s){var a=o[s];y[a]+=g[a]*r}i!==c&&(v[i]+=y[i])}}),h||Object.keys(v).forEach(function(t){v[t]/=2}),v},Za.prototype.closeness=function(r){var o,s=this.graph,a=[],h=Object.create(null),c=Object.create(null);return s.forEachNode(function(t){c[t.id]=0}),s.forEachNode(function(t){var e,t=o=t.id;for(s.forEachNode(function(t){t=t.id;h[t]=-1}),h[t]=0,a.push(t);a.length;){var n=a.shift();s.forEachLinkedNode(n,i,r)}function i(t){t=t.id;-1===h[t]&&(h[t]=h[n]+1,a.push(t))}e=(t=Object.keys(h).map(function(t){return h[t]}).filter(function(t){return-1!==t})).length,t=t.reduce(function(t,e){return t+e},0),c[o]=0<t?(e-1)/t:0}),c},Za.prototype.eccentricity=function(r){var o,s=this.graph,a=[],h=Object.create(null),c=Object.create(null);return s.forEachNode(function(t){c[t.id]=0}),s.forEachNode(function(t){var e,t=o=t.id;for(s.forEachNode(function(t){t=t.id;h[t]=-1}),h[t]=0,a.push(t);a.length;){var n=a.shift();s.forEachLinkedNode(n,i,r)}function i(t){t=t.id;-1===h[t]&&(h[t]=h[n]+1,a.push(t))}e=0,Object.keys(h).forEach(function(t){t=h[t];e<t&&(e=t)}),c[o]=e}),c},Za.prototype.degree=function(t){var n,i=this.graph,r=Object.create(null);return t=(t||"both").toLowerCase(),n="in"===t?function(t,e){var n=0;return t&&t.forEach(function(t){n+=t.toId===e?1:0}),n}:"out"===t?function(t,e){var n=0;return t&&t.forEach(function(t){n+=t.fromId===e?1:0}),n}:function(t){return t?t.size||t.length:0},i.forEachNode(function(t){var e=i.getLinks(t.id);r[t.id]=n(e,t.id)}),r},Za.prototype.pageRank=function(t,e){return new Ka(t,e).compute(this.graph)};var Qa=function(t){return new $a("number"==typeof t?t:+new Date)};function $a(t){this.seed=t}function th(t){return Math.sqrt(2*Math.PI/t)*Math.pow(1/Math.E*(t+1/(12*t-1/(10*t))),t)}function eh(){var t=4294967295&(3042594569^(t=4251993797+(t=4294967295&(3550635116+(t=374761393+(t=4294967295&(3345072700^(t=(t=this.seed)+2127912214+(t<<12)&4294967295)^t>>>19))+(t<<5)&4294967295)^t<<9))+(t<<3)&4294967295)^t>>>16);return(268435455&(this.seed=t))/268435456}$a.prototype.next=function(t){return Math.floor(this.nextDouble()*t)},$a.prototype.nextDouble=eh,$a.prototype.uniform=eh,$a.prototype.gaussian=function(){for(var t,e,n;1<=(t=(e=2*this.nextDouble()-1)*e+(n=2*this.nextDouble()-1)*n)||0===t;);return e*Math.sqrt(-2*Math.log(t)/t)},$a.prototype.levy=function(){var t=Math.pow(th(2.5)*Math.sin(1.5*Math.PI/2)/(1.5*th(1.25)*Math.pow(2,.25)),1/1.5);return this.gaussian()*t/Math.pow(Math.abs(this.gaussian()),1/1.5)};var nh=function(r,t){var o=t||random();if("function"!=typeof o.next)throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:function(t){for(var e,n,i=r.length-1;0<i;--i)e=o.next(i+1),n=r[e],r[e]=r[i],t(r[i]=n);r.length&&t(r[0])},shuffle:function(){for(var t,e,n=r.length-1;0<n;--n)t=o.next(n+1),e=r[t],r[t]=r[n],r[n]=e;return r}}};function ih(t,e,n){var i,t=0<arguments.length&&void 0!==t?t:[],e=1<arguments.length&&void 0!==e?e:[],s=2<arguments.length?n:void 0,n={step:function(){a=0,i.forEach(d),r=a/c.length},getClass:l,getChangeRate:function(){return r},forEachCluster:function(n){f().forEach(function(t,e){n({class:e,nodes:t})})},createClusterMap:f},r=1,a=0,o=Qa(42),h=new Map,c=[],u=Wa();return t.forEach(function(t){u.addNode(t.id)}),e.forEach(function(t){u.addLink(t.source.id,t.target.id)}),u.forEachNode(function(t){h.set(t.id,c.length),c.push(t.id)}),i=nh(c,o),n;function l(t){return h.get(t)}function d(t){n=t,i=new Map,r=0,o=-1,u.forEachLinkedNode(n,function(t,e){e=e.toId===n,("in"===s?e:"out"!==s||!e)&&(e=h.get(t.id),t=i.get(e)||0,(t+=1)>r&&(r=t,o=e),i.set(e,t))});var n,i,r,o,e=-1===o?h.get(n):o;e!==h.get(t)&&(h.set(t,e),a+=1)}function f(){for(var t=new Map,e=0;e<c.length;++e){var n=c[e],i=l(n),r=t.get(i);r?r.push(n):t.set(i,[n])}return t}}function rh(){var C=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];function N(t,e){var n=null;return(t.outLinks||[]).forEach(function(t){if(t.target.id==e.id)return n=e}),n}this.nodes=C,this.links=t,this.applay=function(){if(0!=this.nodes.length){for(var t=this.nodes.length,e=this.links.length,n=new Array(t),i=new Array(t*t),r=new Array(t),o=new Array(t),s=new Map,a=0;a<t;++a){var h=this.nodes[a];n[o[a]=a]=(h.inLinks||[]).length+(h.outLinks||[]).length,r[a]=!1;for(var c=0;c<t;++c){var u=this.nodes[c];i[a*t+c]=N(u,h)||N(h,u)?1:0}}for(var l=-1/0,d=0,f=t;1<f;--f){for(var p,g=-1/0,y=void 0,v=void 0,m=0;m<t;++m)if(!r[m])for(var x=m+1;x<t;++x)r[x]||g<(p=(i[m*t+x]-n[m]*n[x]/2/e)/e)&&(g=p,v=m,y=x);n[v]+=n[y]+i[v*t+y];for(var w=0;w<t;++w)i[v*t+w]+=i[y*t+w],i[w*t+v]+=i[w*t+y],o[w]===y&&(o[w]=v);if(r[y]=!0,(d+=g)>l)for(var l=d,b=0;b<t;++b){var k=C[b],M=(k.cluster=o[b],o[b]),E=s.get(M);null!=E&&-1==E.indexOf(k)?(E.push(k),s.set(M,E)):s.set(M,[k])}}return s}}}function oh(t,e){this.nodes=t,this.links=e,this.nodeIds=[],this.nodeNeighbers=[],this.applay=function(){var e=this,n=[];e.nodes.forEach(function(t){n.push(t),e.nodeIds.push(t.id);t=e.initNodeNeighbers(t);e.nodeNeighbers.push(t)});for(var t=[];0<n.length;){var i=[],r=n[0],o=(n.splice(0,1),i.push(r),[]);for(o.push(r);0<o.length;){var s=o.splice(0,1)[0];e.initNodeNeighbers(s).forEach(function(t){var e=n.indexOf(t);-1!=e&&(o.push(t),n.splice(e,1),i.push(t))})}t.push(i)}var a=new Map;return t.forEach(function(t,e){a.set(e+1,t)}),a},this.initNodeNeighbers=function(i){var r=this,o=[];return(i.outLinks||[]).forEach(function(t){var e,n=t.target;t.source.id!=n.id&&(t=r.nodeIds.indexOf(n.id),t=r.nodeNeighbers[t]||[],e=[],t.forEach(function(t){e.push(t.id)}),-1==e.indexOf(i.id))&&o.push(n)}),o}}function sh(t,e){this.nodes=t,this.links=e,this.nodeIds=[],this.nodeNeighbers=[],this.dfs_num={},this.high={},this.parents={},this.stack=[],this.converse_depth=0,this.applay=function(){var e,n,i=this;if(0!=i.nodes.length)return e=[],i.nodes.forEach(function(t){i.dfs_num[t.id]=0}),i.converse_depth=this.nodes.length,i.nodes.forEach(function(t){0==i.dfs_num[t.id]&&(i.converse_depth=i.nodes.length,i.findBiconnectedComponents(t,e),i.nodes.length-i.converse_depth==1)&&e.push([t])}),n=new Map,e.forEach(function(t,e){n.set(e+1,t)}),n},this.findBiconnectedComponents=function(h,c){var u=this,l=u.converse_depth;u.dfs_num[h.id]=l,u.converse_depth--,u.high[h.id]=l,(u.getNeighbors(h)||[]).forEach(function(t){var e,n,i=u.dfs_num[t.id],r=(e=t,(h.outLinks||[]).forEach(function(t){if(t.target.id==e.id)return n=t}),n);if(0==i){u.parents[t.id]=h.id,u.stack.push(r),u.findBiconnectedComponents(t,c);var o=u.high[t.id]||0;if(o<=l){for(var s,a=[];s=u.stack.pop(),a.push(s.source),a.push(s.target),s!=r;);c.push(a)}u.high[h.id]=Math.max(o,u.high[h.id]||0)}else t.id!=u.parents[h.id]&&(u.high[h.id]=Math.max(i,u.high[h.id]||0))})},this.getNeighbors=function(i){var r=this,o=[];return(i.outLinks||[]).forEach(function(t){var e,n=t.target;t.source.id!=n.id&&(t=r.nodeIds.indexOf(n.id),t=r.nodeNeighbers[t]||[],e=[],t.forEach(function(t){e.push(t.id)}),-1==e.indexOf(i.id))&&o.push(n)}),o}}function ah(t){function s(t,e){var n=e.x-t.x,e=e.y-t.y;return n*n+e*e}this.nodes=t,this.centroids=[],this.numClusters=5,this.colors=[],this.applay=function(t){t&&(this.numClusters=Number(t.clusterNum||10)),this.init(),this.clustering(),this.centroids=this.updateCentroids(),this.clustering();var i=new Map;return this.nodes.forEach(function(t){var e,n=t.clusterId;0<=n&&((e=i.get(n))?e.push(t):e=[t],i.set(n,e))}),i},this.init=function(){this.centroids=[],this.colors=[];for(var t=Number.MAX_VALUE,e=Number.MIN_VALUE,n=Number.MAX_VALUE,i=Number.MIN_VALUE,r=0;r<this.nodes.length;r++){var o=this.nodes[r];o.clusterId=null,t=Math.min(t,o.x),e=Math.max(t,o.x),n=Math.min(n,o.y),i=Math.max(i,o.y)}var s,a,r,h=Math.abs(e-t),c=Math.abs(i-n);for(r=0;r<this.numClusters;r++)s=Math.floor(Math.random()*h),a=Math.floor(Math.random()*c),this.centroids.push({x:s,y:a,clusterId:r})},this.clustering=function(){var t;for(r=0;r<this.centroids.length;r++)this.centroids[r].bestMatches=[];for(t=0;t<this.nodes.length;t++){for(var e=this.nodes[t],n=0,i=s(e,this.centroids[n]),r=1;r<this.centroids.length;r++){var o=s(e,this.centroids[r]);o<i&&(n=r,i=o)}this.centroids[n].bestMatches.push(t),this.nodes[t].clusterId=n}},this.updateCentroids=function(){for(var t=[],e=0;e<this.centroids.length;e++)if(0<this.centroids[e].bestMatches.length){for(var n=0,i=0,r=this.centroids[e].bestMatches,o=0;o<r.length;o++){var s=this.nodes[r[o]];n+=s.x,i+=s.y}n/=r.length,i/=r.length,t.push({x:n,y:i,clusterId:e})}else t.push(this.centroids[e]);return t}}function hh(){var e,i,n,c={},u={},l=[];function d(t){var n={};return t.forEach(function(t,e){n[t]=!0}),Object.keys(n)}function f(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(t[e]);return n}function p(i,r){var t=i._assoc_mat[r]?Object.keys(i._assoc_mat[r]):[],o=0;return t.forEach(function(t,e){var n=i._assoc_mat[r][t]||1;r===t&&(n*=2),o+=n}),o}function m(t,e){return void 0===t._assoc_mat[e]?[]:Object.keys(t._assoc_mat[e])}function g(t,e,n){return t._assoc_mat[e]?t._assoc_mat[e][n]:void 0}function y(t){if(null===t||"object"!==Ft(t))return t;var e,n=t.constructor();for(e in t)n[e]=y(t[e]);return n}function v(s,a,h){var e;a.nodes_to_com={},a.total_weight=0,a.internals={},a.degrees={},a.gdegrees={},a.loops={},a.total_weight=(e=0,s.edges.forEach(function(t){e+=t.weight}),e),void 0===h?s.nodes.forEach(function(t,e){a.nodes_to_com[t]=e;var n=p(s,t);if(n<0)throw"Bad graph type, use positive weights!";a.degrees[e]=n,a.gdegrees[t]=n,a.loops[t]=g(s,t,t)||0,a.internals[e]=a.loops[t]}):s.nodes.forEach(function(i,t){var r=h[i],e=(a.nodes_to_com[i]=r,p(s,i)),o=(a.degrees[r]=(a.degrees[r]||0)+e,a.gdegrees[i]=e,0);m(s,i).forEach(function(t,e){var n=s._assoc_mat[i][t];if(n<=0)throw"Bad graph type, use positive weights";h[t]===r&&(o+=t===i?n:n/2)}),a.internals[r]=(a.internals[r]||0)+o})}function x(i){var r=i.total_weight,o=0;return d(f(i.nodes_to_com)).forEach(function(t,e){var n=i.internals[t]||0,t=i.degrees[t]||0;0<r&&(o=o+n/r-Math.pow(t/(2*r),2))}),o}function w(i){var r=0,o=y(i),s={};return Object.keys(i).forEach(function(t){var e=i[t],n=void 0===s[e]?-1:s[e];-1===n&&(n=s[e]=r,r+=1),o[t]=n,l.push([y(o)])}),o}function b(g,y){for(var t,v=!0,e=0,n=x(y);v&&-1!==e&&(t=n,v=!1,e+=1,g.nodes.forEach(function(t,e){var i,r,o,s,n,a,h,c,u=y.nodes_to_com[t],l=(y.gdegrees[t]||0)/(2*y.total_weight),d=(o=y,s={},m(r=g,i=t).forEach(function(t,e){var n;t!==i&&(n=r._assoc_mat[i][t]||1,t=o.nodes_to_com[t],s[t]=(s[t]||0)+n)}),s),f=(c=t,a=d[n=u]||0,(h=y).degrees[n]=(h.degrees[n]||0)-(h.gdegrees[c]||0),h.internals[n]=(h.internals[n]||0)-a-(h.loops[c]||0),h.nodes_to_com[c]=-1,u),p=0;Object.keys(d).forEach(function(t,e){var n=d[t]-(y.degrees[t]||0)*l;p<n&&(p=n,f=t)}),n=t,h=d[a=f]||0,(c=y).nodes_to_com[n]=+a,c.degrees[a]=(c.degrees[a]||0)+(c.gdegrees[n]||0),c.internals[a]=(c.internals[a]||0)+h+(c.loops[n]||0),f!==u&&(v=!0)}),!((n=x(y))-t<1e-7)););}function k(o,t){var s,a,h={nodes:[],edges:[],_assoc_mat:{}},e=f(o);return h.nodes=h.nodes.concat(d(e)),t.edges.forEach(function(t,e){a=t.weight||1;var n,i,r=o[t.source],t=o[t.target];s=g(h,r,t)||0,t=r={source:r,target:t,weight:s+a},(i=n=h)._assoc_mat[t.source]=i._assoc_mat[t.source]||{},i._assoc_mat[t.source][t.target]=t.weight,i._assoc_mat[t.target]=i._assoc_mat[t.target]||{},i._assoc_mat[t.target][t.source]=t.weight,u[r.source+"_"+r.target]?n.edges[u[r.source+"_"+r.target]].weight=r.weight:(n.edges.push(r),u[r.source+"_"+r.target]=n.edges.length-1)}),u={},h}function r(i,t){for(var r=y(i[0]),o=1;o<t+1;o++)Object.keys(r).forEach(function(t,e){var n=r[t];r[t]=i[o][n]});return r}function o(t,e){var n;if(0===t.edges.length)return n={},t.nodes.forEach(function(t,e){n[t]=t}),n;var i={},r=(v(c,i,e),x(i)),o=[],s=(b(c,i),x(i)),a=w(i.nodes_to_com),h=(o.push(a),r=s,k(a,c));for(v(h,i);b(h,i),s=x(i),l.push(y(o)),!(s-r<1e-7);)a=w(i.nodes_to_com),o.push(a),r=s,v(h=k(a,h),i);return o}function s(){var t=o(c,n);return r(t,t.length-1)}var t=-1;return s.resetAll=function(){t=-1,l=[]},s.nextStep=function(){return-1==t&&y(o(c,n)),t<l.length?null==l[t+=1]?r(l[t-1],l[t-1].length-1):r(l[t],l[t].length-1):void 0},s.nodes=function(t){return 0<arguments.length&&(e=t),s},s.edges=function(t){if(void 0===e)throw"Please provide the graph nodes first!";var n;return 0<arguments.length&&(n={},(i=t).forEach(function(t,e){n[t.source]=n[t.source]||{},n[t.source][t.target]=t.weight,n[t.target]=n[t.target]||{},n[t.target][t.source]=t.weight}),c={nodes:e,edges:i,_assoc_mat:n}),s},s.partition_init=function(t){return 0<arguments.length&&(n=t),s},s}function ch(t,e){this.nodes=t,this.links=e,this.applay=function(){var e={},n=[],i=[];this.nodes.forEach(function(t){n.push(t.id),e[t.id]=t}),this.links.forEach(function(t){i.push({source:t.source.id,target:t.target.id,weight:t.weight})});for(var r,t,o=hh().nodes(n).edges(i),s=!0;s;)null==(t=o.nextStep())?s=!1:r=t;var a,h={},c=(Object.keys(r).forEach(function(t){r[t]in h?h[r[t]].push(t):h[r[t]]=[t]}),1),u=new Map;for(a in h){var l=[];(h[a]||[]).forEach(function(t){l.push(e[t])}),u.set(c++,l)}return u}}var uh={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},lh={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},dh={springs:{}};function N(t,e,n){return Math.min(Math.max(t,e),n)}function fh(t,e){return t.apply(null,e)}var L={arr:function(t){return Array.isArray(t)},obj:function(t){return-1<Object.prototype.toString.call(t).indexOf("Object")},str:function(t){return"string"==typeof t},fnc:function(t){return"function"==typeof t},und:function(t){return void 0===t},nil:function(t){return L.und(t)||null===t},key:function(t){return!uh.hasOwnProperty(t)&&!lh.hasOwnProperty(t)&&"targets"!==t&&"keyframes"!==t}};function ph(t){t=/\(([^)]+)\)/.exec(t);return t?t[1].split(",").map(function(t){return parseFloat(t)}):[]}function gh(i,n){var t=ph(i),e=N(L.und(t[0])?1:t[0],.1,100),r=N(L.und(t[1])?100:t[1],.1,100),o=N(L.und(t[2])?10:t[2],.1,100),t=N(L.und(t[3])?0:t[3],.1,100),s=Math.sqrt(r/e),a=o/(2*Math.sqrt(r*e)),h=a<1?s*Math.sqrt(1-a*a):0,c=a<1?(a*s-t)/h:-t+s;function u(t){var e=n?n*t/1e3:t,e=a<1?Math.exp(-e*a*s)*(+Math.cos(h*e)+c*Math.sin(h*e)):(1+c*e)*Math.exp(-e*s);return 0===t||1===t?t:1-e}return n?u:function(){var t=dh.springs[i];if(t)return t;for(var e=0,n=0;;)if(1===u(e+=1/6)){if(16<=++n)break}else n=0;t=e*(1/6)*1e3;return dh.springs[i]=t}}function yh(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10;return function(t){return Math.ceil(N(t,1e-6,1)*e)*(1/e)}}function vh(x,e,w,n){if(0<=x&&x<=1&&0<=w&&w<=1){var b=new Float32Array(11);if(x!==e||w!==n)for(var t=0;t<11;++t)b[t]=kh(.1*t,x,w);return function(t){return x===e&&w===n||0===t||1===t?t:kh(function(t){for(var e=0,n=1;10!==n&&b[n]<=t;++n)e+=.1;var i=e+(t-b[--n])/(b[n+1]-b[n])*.1,r=Mh(i,x,w);if(.001<=r){for(var o=t,s=i,a=x,h=w,c=0;c<4;++c){var u=Mh(s,a,h);if(0===u)return s;s-=(kh(s,a,h)-o)/u}return s}if(0===r)return i;for(var l,d,f=t,p=e,g=e+.1,y=x,v=w,m=0;0<(l=kh(d=p+(g-p)/2,y,v)-f)?g=d:p=d,1e-7<Math.abs(l)&&++m<10;);return d}(t),e,n)}}}mh={linear:function(){return function(t){return t}}},xh={Sine:function(){return function(t){return 1-Math.cos(t*Math.PI/2)}},Circ:function(){return function(t){return 1-Math.sqrt(1-t*t)}},Back:function(){return function(t){return t*t*(3*t-2)}},Bounce:function(){return function(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*e-2)/22-t,2)}},Elastic:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.5,n=N(t,1,10),i=N(e,.1,2);return function(t){return 0===t||1===t?t:-n*Math.pow(2,10*(t-1))*Math.sin((t-1-i/(2*Math.PI)*Math.asin(1/n))*(2*Math.PI)/i)}}},["Quad","Cubic","Quart","Quint","Expo"].forEach(function(t,e){xh[t]=function(){return function(t){return Math.pow(t,e+2)}}}),Object.keys(xh).forEach(function(t){var i=xh[t];mh["easeIn"+t]=i,mh["easeOut"+t]=function(e,n){return function(t){return 1-i(e,n)(1-t)}},mh["easeInOut"+t]=function(e,n){return function(t){return t<.5?i(e,n)(2*t)/2:1-i(e,n)(-2*t+2)/2}},mh["easeOutIn"+t]=function(e,n){return function(t){return t<.5?(1-i(e,n)(1-2*t))/2:(i(e,n)(2*t-1)+1)/2}}});var mh,xh,wh=mh;function bh(t,e){return 1-3*e+3*t}function kh(t,e,n){return((bh(e,n)*t+(3*n-6*e))*t+3*e)*t}function Mh(t,e,n){return 3*bh(e,n)*t*t+2*(3*n-6*e)*t+3*e}function Eh(t,e){if(L.fnc(t))return t;var n=t.split("(")[0],i=wh[n],r=ph(t);switch(n){case"spring":return gh(t,e);case"cubicBezier":return fh(vh,r);case"steps":return fh(yh,r);default:return fh(i,r)}}function Ch(t,e){for(var n,i=t.length,r=2<=arguments.length?e:void 0,o=[],s=0;s<i;s++)s in t&&(n=t[s],e.call(r,n,s,t))&&o.push(n);return o}function Nh(t){return t.reduce(function(t,e){return t.concat(L.arr(e)?Nh(e):e)},[])}function Lh(t){return L.arr(t)?t:t instanceof NodeList||t instanceof HTMLCollection?[].slice.call(t):[t]}function Sh(t){var e,n={};for(e in t)n[e]=t[e];return n}function _h(t,e){var n,i=Sh(t);for(n in t)i[n]=(e.hasOwnProperty(n)?e:t)[n];return i}function Th(t,e){var n,i=Sh(t);for(n in e)i[n]=(L.und(t[n])?e:t)[n];return i}function Ph(t){t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(t);if(t)return t[1]}function Oh(t,e){return L.fnc(t)?t(e.target,e.id,e.total):t}function Ah(t,e){if(null!=t[e])return"object"}function Ih(t,e,n,i){return"attribute"!==Ah(t,e)?t[e]||0:t.getAttribute(e)}function Dh(t,e){var n=/^(\*=|\+=|-=)/.exec(t);if(!n)return t;var i=Ph(t)||0,r=parseFloat(e),o=parseFloat(t.replace(n[0],""));switch(n[0][0]){case"+":return r+o+i;case"-":return r-o+i;case"*":return r*o+i}}function Bh(t,e){var n;return/\s/g.test(t)?t:(n=(n=Ph(t))?t.substr(0,t.length-n.length):t,e?n+e:n)}function zh(t,e){var n=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=Bh(t,e)+"";return{original:i,numbers:i.match(n)?i.match(n).map(Number):[0],strings:L.str(t)||e?i.split(n):[]}}function Rh(t){return Ch(t?Nh(L.arr(t)?t.map(Lh):Lh(t)):[],function(t,e,n){return n.indexOf(t)===e})}function Vh(t){var n=Rh(t);return n.map(function(t,e){return{target:t,id:e,total:n.length,transforms:{list:[]}}})}function jh(t,e){var n,i=[],r=e.keyframes;for(n in e=r?Th(function(e){for(var n=Ch(Nh(e.map(function(t){return Object.keys(t)})),function(t){return L.key(t)}).reduce(function(t,e){return t.indexOf(e)<0&&t.push(e),t},[]),r={},t=0;t<n.length;t++)!function(t){var i=n[t];r[i]=e.map(function(t){var e,n={};for(e in t)L.key(e)?e==i&&(n.value=t[e]):n[e]=t[e];return n})}(t);return r}(r),e):e)L.key(n)&&i.push({name:n,tweens:function(t,n){var e,i=Sh(n),r=(/^spring/.test(i.easing)&&(i.duration=gh(i.easing)),L.arr(t)&&(2!==(e=t.length)||L.obj(t[0])?L.fnc(n.duration)||(i.duration=n.duration/e):t={value:t}),L.arr(t)?t:[t]);return r.map(function(t,e){t=L.obj(t)?t:{value:t};return L.und(t.delay)&&(t.delay=e?0:n.delay),L.und(t.endDelay)&&(t.endDelay=e===r.length-1?n.endDelay:0),t}).map(function(t){return Th(t,i)})}(e[n],t)});return i}var Fh={css:function(t,e,n){return t.style[e]=n},attribute:function(t,e,n){return t.setAttribute(e,n)},object:function(t,e,n){return t[e]=n},transform:function(t,e,n,i,r){var o;i.list.set(e,n),e!==i.last&&!r||(o="",i.list.forEach(function(t,e){o+="".concat(e,"(").concat(t,") ")}),t.style.transform=o)}};function Xh(t,s){Vh(t).forEach(function(t){for(var e in s){var n=Oh(s[e],t),i=t.target,r=Ph(n),o=Ih(i,e),n=Dh(Bh(n,r||Ph(o)),o),r=Ah(i,e);Fh[r](i,e,n,t.transforms,!0)}})}function Yh(t,e){return Ch(Nh(t.map(function(o){return e.map(function(t){var e,n,s,a,h,i=o,r=Ah(i.target,t.name);if(r)return a=i,n=(e=(s=t).tweens.map(function(t){var t=function(t,e){var n,i={};for(n in t){var r=Oh(t[n],e);L.arr(r)&&1===(r=r.map(function(t){return Oh(t,e)})).length&&(r=r[0]),i[n]=r}return i.duration=parseFloat(i.duration),i.delay=parseFloat(i.delay),i}(t,a),e=t.value,n=L.arr(e)?e[1]:e,i=Ph(n),r=Ih(a.target,s.name),o=h?h.to.original:r,e=L.arr(e)?e[0]:o,r=Ph(e)||Ph(r),i=i||r;return L.und(n)&&(n=o),t.from=zh(e,i),t.to=zh(Dh(n,e),i),t.start=h?h.end:0,t.end=t.start+t.delay+t.duration+t.endDelay,t.easing=Eh(t.easing,t.duration),t.isColor=!1,t.isColor&&(t.round=1),h=t}))[e.length-1],{type:r,property:t.name,animatable:i,tweens:e,duration:n.end,delay:e[0].delay,endDelay:n.endDelay}})})),function(t){return!L.und(t)})}function Uh(t,e){function n(t){return t.timelineOffset||0}var i=t.length,r={};return r.duration=i?Math.max.apply(Math,t.map(function(t){return n(t)+t.duration})):e.duration,r.delay=i?Math.min.apply(Math,t.map(function(t){return n(t)+t.delay})):e.delay,r.endDelay=i?r.duration-Math.max.apply(Math,t.map(function(t){return n(t)+t.duration-t.endDelay})):e.endDelay,r}var Wh=0;var Gh,S=[],qh=("undefined"!=typeof document&&document.addEventListener("visibilitychange",function(){_.suspendWhenDocumentHidden&&(Jh()?Gh=cancelAnimationFrame(Gh):(S.forEach(function(t){return t._onDocumentVisibility()}),qh()))}),function(){!(Gh||Jh()&&_.suspendWhenDocumentHidden)&&0<S.length&&(Gh=requestAnimationFrame(Hh))});function Hh(t){for(var e=S.length,n=0;n<e;){var i=S[n];i.paused?(S.splice(n,1),e--):(i.tick(t),n++)}Gh=0<n?requestAnimationFrame(Hh):void 0}function Jh(){return document&&document.hidden}function _(){var h,c=0,u=0,l=0,d=0,f=null;function p(t){var e=window.Promise&&new Promise(function(t){return f=t});t.finished=e}e=_h(uh,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),n=jh(i=_h(lh,t),t),t=Vh(t.targets),i=Uh(n=Yh(t,n),i),r=Wh,Wh++;var t,e,n,i,r,M=Th(e,{id:r,children:[],animatables:t,animations:n,duration:i.duration,delay:i.delay,endDelay:i.endDelay});function g(){var t=M.direction;"alternate"!==t&&(M.direction="normal"!==t?"normal":"reverse"),M.reversed=!M.reversed,h.forEach(function(t){return t.reversed=M.reversed})}function y(t){return M.reversed?M.duration-t:t}function o(){c=0,u=y(M.currentTime)*(1/_.speed)}function v(t,e){e&&e.seek(t-e.timelineOffset)}function m(e){for(var t=0,n=M.animations,i=n.length;t<i;){var r=n[t],o=r.animatable,s=r.tweens,a=s.length-1,h=s[a];a&&(h=Ch(s,function(t){return e<t.end})[0]||h);for(var a=N(e-h.start-h.delay,0,h.duration)/h.duration,c=isNaN(a)?1:h.easing(a),u=h.to.strings,l=h.round,d=[],f=h.to.numbers.length,p=void 0,g=0;g<f;g++){var y=void 0,v=h.to.numbers[g],m=h.from.numbers[g]||0;h.isPath||(y=m+c*(v-m)),!l||h.isColor&&2<g||(y=Math.round(y*l)/l),d.push(y)}var x=u.length;if(x)for(var p=u[0],w=0;w<x;w++){u[w];var b=u[w+1],k=d[w];isNaN(k)||(p+=b?k+b:k+" ")}else p=d[0];Fh[r.type](o.target,r.property,p,o.transforms),r.currentValue=p,t++}}function x(t){M[t]&&!M.passThrough&&M[t](M)}function s(t){var e=M.duration,n=M.delay,i=e-M.endDelay,r=y(t);if(M.progress=N(r/e*100,0,100),M.reversePlayback=r<M.currentTime,h){var o=r;if(M.reversePlayback)for(var s=d;s--;)v(o,h[s]);else for(var a=0;a<d;a++)v(o,h[a])}!M.began&&0<M.currentTime&&(M.began=!0,x("begin")),!M.loopBegan&&0<M.currentTime&&(M.loopBegan=!0,x("loopBegin")),r<=n&&0!==M.currentTime&&m(0),(i<=r&&M.currentTime!==e||!e)&&m(e),n<r&&r<i?(M.changeBegan||(M.changeBegan=!0,M.changeCompleted=!1,x("changeBegin")),x("change"),m(r)):M.changeBegan&&(M.changeCompleted=!0,M.changeBegan=!1,x("changeComplete")),M.currentTime=N(r,0,e),M.began&&x("update"),e<=t&&(u=0,M.remaining&&!0!==M.remaining&&M.remaining--,M.remaining?(c=l,x("loopComplete"),M.loopBegan=!1,"alternate"===M.direction&&g()):(M.paused=!0,M.completed||(M.completed=!0,x("loopComplete"),x("complete"),!M.passThrough&&"Promise"in window&&(f(),p(M)))))}return p(M),M.reset=function(){var t=M.direction;M.passThrough=!1,M.currentTime=0,M.progress=0,M.paused=!0,M.began=!1,M.loopBegan=!1,M.changeBegan=!1,M.completed=!1,M.changeCompleted=!1,M.reversePlayback=!1,M.reversed="reverse"===t,M.remaining=M.loop,h=M.children;for(var e=d=h.length;e--;)M.children[e].reset();(M.reversed&&!0!==M.loop||"alternate"===t&&1===M.loop)&&M.remaining++,m(M.reversed?M.duration:0)},M._onDocumentVisibility=o,M.set=function(t,e){return Xh(t,e),M},M.tick=function(t){s(((l=t)+(u-(c=c||l)))*_.speed)},M.seek=function(t){s(y(t))},M.pause=function(){M.paused=!0,o()},M.play=function(){M.paused&&(M.completed&&M.reset(),M.paused=!1,S.push(M),o(),qh())},M.reverse=function(){g(),M.completed=!M.reversed,o()},M.restart=function(){M.reset(),M.play()},M.remove=function(t){Zh(Rh(t),M)},M.reset(),M.autoplay&&M.play(),M}function Kh(t,e){for(var n=e.length;n--;)!function(t,e){return t.some(function(t){return t===e})}(t,e[n].animatable.target)||e.splice(n,1)}function Zh(t,e){var n=e.animations,i=e.children;Kh(t,n);for(var r=i.length;r--;){var o=i[r],s=o.animations;Kh(t,s),s.length||o.children.length||i.splice(r,1)}n.length||i.length||e.pause()}_.version="3.2.1",_.speed=1,_.suspendWhenDocumentHidden=!0,_.running=S,_.remove=function(t){for(var e=Rh(t),n=S.length;n--;)Zh(e,S[n])},_.get=Ih,_.set=Xh,_.timeline=function(){var s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=_(s);return a.duration=0,a.add=function(t,e){var n=S.indexOf(a),i=a.children;function r(t){t.passThrough=!0}-1<n&&S.splice(n,1);for(var o=0;o<i.length;o++)r(i[o]);n=Th(t,_h(lh,s)),n.targets=n.targets||s.targets,t=a.duration,n.autoplay=!1,n.direction=a.direction,n.timelineOffset=L.und(e)?t:Dh(e,t),r(a),a.seek(n.timelineOffset),e=_(n),r(e),i.push(e),t=Uh(i,s);return a.delay=t.delay,a.endDelay=t.endDelay,a.duration=t.duration,a.seek(0),a.reset(),a.autoplay&&a.play(),a},a},_.easing=Eh,_.penner=wh,_.random=function(t,e){return Math.floor(Math.random()*(e-t+1))+t};function Qh(){this.actionStack=[],this.todo=function(t,e){10<this.actionStack.length&&this.actionStack.shift(),this.actionStack.push({action:t,elements:e})},this.clearAll=function(){this.actionStack=null,this.actionStack=[]},this.undo=function(t){var e,n;0!=this.actionStack.length&&(e=(n=this.actionStack.pop()).action,n=n.elements,this.do(e,n,t))},this.do=function(t,e,i){var r,n;"node:add"!=t&&("node:remove"==t?(r=new Map,n=[],e.forEach(function(t){"node"==t.elementType?(i.scene.add(t),i.nodes.push(t),r.set(t.id,t)):"link"==t.elementType&&n.push(t)}),n.forEach(function(t){var e=t.source.id,n=t.target.id,e=r.get(e),e=(e&&e.outLinks.push(t),r.get(n));e&&e.inLinks.push(t),i.scene.add(t),i.links.push(t)})):"link:remove"==t&&(r=new Map,i.nodes.forEach(function(t){r.set(t.id,t)}),e.forEach(function(t){var e=t.source.id,n=t.target.id,e=r.get(e),e=(e&&e.outLinks.push(t),r.get(n));e&&e.inLinks.push(t),i.scene.add(t),i.links.push(t)}))),i.refreshView()}}var $h={node:{click:"onClick",dblClick:"ondblClick",mouseUp:"onMouseUp",mouseDown:"onMouseDown",mouseOver:"onMouseOver",mouseOut:"onMouseOut",mousedrag:"onMousedrag"},link:{click:"onClick",dblClick:"ondblClick",mouseUp:"onMouseUp",mouseDown:"onMouseDown",mouseOver:"onMouseOver",mouseOut:"onMouseOut"},group:{click:"onClick",dblClick:"ondblClick"},scene:{whiteSpaceClick:"noElementClick",keyUp:"keyUp",keyDown:"keyDown",mouseWheel:"mouseWheel",mouseDraging:"mouseDraging",mouseDragEnd:"mouseDragEnd",boxSelectEnd:"onBoxSelectEndEvent"}};function tc(t){this.payload=t,(this.parent=this).rank=0,this.find=function(){var t=this.parent;return t!==this&&(this.parent=t.find()),this.parent},this.union=function(t){var e=this.find(),t=t.find();t!==e&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank+=1)}}function ec(t,e){this._rows=t,this._columns=e,this._matrix=new Float64Array(t*e),this._n=t*e,this.set=function(t,e,n){var i=t*this._columns+e;if(i>=this._n)throw new Error("Index out of range "+t+","+e);this._matrix[i]=n},this.get=function(t,e){var n=t*this._columns+e;if(n>=this._n)throw new Error("Index out of range "+t+","+e);return this._matrix[n]},this.centerMatrix=function(){if(!this.isCentered){for(var t=0;t<this._rows;++t){var e=this.getMean(t);this.translateRow(t,-e)}this.isCentered=!0}return this},this.translateRow=function(t,e){if(t<0||t>this._rows)throw new Error("Row is out of range "+t);for(var n=t*this._columns,i=0;i<this._columns;++i)this._matrix[i+n]+=e},this.getMean=function(t){var e=0;if(t<0||t>this._rows)throw new Error("Row is out of range "+t);for(var n=t*this._columns,i=0;i<this._columns;++i)e+=this._matrix[i+n];return e/this._columns},this.applyVectorToColumn=function(t,e){var n=0;if(e.length!==this._rows)throw new Error("Invalid vector dimensions");for(var i=0;i<this._rows;++i)n+=this._matrix[i*this._columns+t]*e[i];return n},this.print=function(){for(var t=[],e=0;e<this._rows;++e){for(var n=[],i=e*this._columns,r=0;r<this._columns;++r)n.push(this._matrix[i+r].toFixed(2));t.push(n.join(" "))}console.log(t.join("\n"))},this.toArray=function(){for(var t=[],e=0;e<this._rows;++e){for(var n=[],i=e*this._columns,r=0;r<this._columns;++r)n.push(this._matrix[i+r]);t.push(n)}return t},this.columnDistance=function(t,e){for(var n=0,i=0;i<this._rows;++i){var r=this.get(i,t)-this.get(i,e);n+=r*r}return Math.sqrt(n)},this.getCovariant=function(){for(var t=new ec(this._rows,this._rows),e=0;e<this._rows;++e)for(var n=0;n<this._rows;++n){for(var i=0,r=e*this._columns,o=n*this._columns,s=0;s<this._columns;++s)i+=this._matrix[r+s]*this._matrix[o+s];t.set(n,e,i)}return t}}function nc(t,e,n,i,r){var n=2<arguments.length&&void 0!==n?n:1e-40,o=3<arguments.length&&void 0!==i?i:1e4,i=4<arguments.length&&void 0!==r?r:42;if(e>t.length)throw new Error("Matrix ain't that big");for(var s,a=Qa(i),h=[],c=(1-n)*(1-n),u=0;u<e;++u){s=t.length;for(var l=Array(s).fill(1).map(function(){return a.nextDouble()}),d=(p=f=d=void 0,l),f=Math.sqrt(C(d,d)),p=0;p<d.length;++p)d[p]/=f;for(var g=0,y=void 0;g<c;){for(var y=l,v=0;v<u;++v)for(var m=h[v],x=C(y,m),w=0;w<y.length;++w)y[w]=y[w]-x*m[w];for(var b=C(l=function(t,e){if(t.length!==e.length)throw new Error("Matrix * Vector dimension mismatch");for(var n=[],i=0;i<t.length;++i){for(var r=0,o=0;o<t.length;++o)r+=t[i][o]*e[o];n[i]=r}return n}(t,y),l),k=(0===b&&(b=C(l=y,l)),E=M=k=void 0,l),M=Math.sqrt(b),E=0;E<k.length;++E)k[E]/=M;if(g=C(l,y),g*=g,--o<0)break}h.push(l)}return h;function C(t,e){var n=0;if(t.length!==e.length)throw new Error("Vector length mismatch");for(var i=0;i<t.length;++i)n+=t[i]*e[i];return n}}function ic(){var o,t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],a=Wa(),h=(e.forEach(function(t){a.addNode(t.id)}),n.forEach(function(t){a.addLink(t.source.id,t.target.id)}),new Map),c=[],e=(a.forEachNode(function(t){h.set(t.id,c.length),c.push(t.id)}),o=Math.min(100,c.length),t=Math.min(2,o),function(t){for(var s=Array(c.length).fill(1/0),e=new ec(o,c.length),n=[],i=0;i<o;++i){n.push(t),function(n,i,t){for(var r=[{node:t,d:0}],o=new Set([t]);r.length;)!function(){var e=r.shift(),t=h.get(e.node);n.set(i,t,e.d),s[t]=Math.min(s[t],e.d),a.forEachLinkedNode(e.node,function(t){o.has(t.id)||(r.push({node:t.id,d:e.d+1}),o.add(t.id))})}()}(e,i,t);var r=s.reduce(function(t,e,n,i){return e>i[t]?n:t},0);t=c[r]}return{matrix:e,pivotNodes:n}}(c[0])),i=e.matrix,r=e.pivotNodes,s=(n=t,nc(i.centerMatrix().getCovariant().toArray(),n));return{getNodePosition:function(t){var e=h.get(t);return s.map(function(t){return i.applyVectorToColumn(e,t)})},getPivotNodes:function(){return r},getLayoutDimensionsCount:function(){return t}}}function T(t,e,n){this.defaultOption={nodeHeight:40,nodeWidth:140,nodeSpace:20,levelSpace:120,animate:!1,type:"umd"},this.option=s(this.defaultOption,n,!0,!0),this.treeData=e,this.visNodes=[],this.idMapChildNode={},this.idMapNode={},this.rootVisNode=null,this.currentNode=null,this.newChildren=[],this.graphVis=t,this.rootVisNode=this.buildXmindNode(this.treeData),this.graphVis.setZoom()}function P(t,e,n){this.defaultOption={nodePadding:20,levelSpace:120,nodeSpace:10,maxWidth:100,animate:!1,type:"lcr"},this.option=s(this.defaultOption,n,!0,!0),this.treeData=e,this.visNodes=[],this.idMapChildNode={},this.idMapNode={},this.graphVis=t,this.rootVisNode=null,this.currentNode=null,this.newChildren=[],this.rootVisNode=this.buildXmindNode(this.treeData),this.graphVis.zoomFit()}function rc(){var ft,pt,gt=0,yt=0,vt=1,mt=1,xt=24,wt=8,bt=0,kt=function(t){return t.index},Mt=a,Et=function(t){return t.nodes},Ct=function(t){return t.links},Nt=6;function e(){var D,t={nodes:Et.apply(null,arguments),links:Ct.apply(null,arguments)},e=t,n=e.nodes,i=e.links,r=jt(n.entries());try{for(r.s();!(D=r.n()).done;){var B=Xt(D.value,2),z=B[0],o=B[1];o.index=z,o.sourceLinks=[],o.targetLinks=[]}}catch(e){r.e(e)}finally{r.f()}var R,V=new Map(n.map(function(t,e){return[kt(t,e,n),t]})),s=jt(i.entries());try{for(s.s();!(R=s.n()).done;){var j=Xt(R.value,2),F=j[0],a=j[1],h=(a.index=F,a.source),c=a.target;"object"!==Ft(h)&&null==(h=a.source=Bt(V,h))||"object"!==Ft(c)&&null==(c=a.target=Bt(V,c))||(h.sourceLinks.push(a),c.targetLinks.push(a))}}catch(e){s.e(e)}finally{s.f()}if(null!=pt){var X,u=jt(n);try{for(u.s();!(X=u.n()).done;){var Y=X.value,U=Y.sourceLinks,W=Y.targetLinks;U.sort(pt),W.sort(pt)}}catch(e){u.e(e)}finally{u.f()}}var G,l=t,d=jt(l.nodes);try{for(d.s();!(G=d.n()).done;){var f=G.value;f.value=void 0===f.fixedValue?Math.max(_t(f.sourceLinks,Dt),_t(f.targetLinks,Dt)):f.fixedValue}}catch(l){d.e(l)}finally{d.f()}for(var p=t,i=p.nodes,q=i.length,g=new Set(i),y=new Set,H=0;g.size;){var J,v=jt(g);try{for(v.s();!(J=v.n()).done;){var K=J.value;K.depth=H;var Z,m=jt(K.sourceLinks);try{for(m.s();!(Z=m.n()).done;){var Q=Z.value.target;y.add(Q)}}catch(p){m.e(p)}finally{m.f()}}}catch(p){v.e(p)}finally{v.f()}if(++H>q)throw new Error("circular link");g=y,y=new Set}for(var x=t,i=x.nodes,$=i.length,w=new Set(i),b=new Set,tt=0;w.size;){var et,k=jt(w);try{for(k.s();!(et=k.n()).done;){var nt=et.value;nt.height=tt;var it,M=jt(nt.targetLinks);try{for(M.s();!(it=M.n()).done;){var rt=it.value.source;b.add(rt)}}catch(x){M.e(x)}finally{M.f()}}}catch(x){k.e(x)}finally{k.f()}if(++tt>$)throw new Error("circular link");w=b,b=new Set}var ot,st=t,E=function(){var t,e=st.nodes,n=Pt(e,function(t){return t.depth})+1,i=(vt-gt-xt)/(n-1),r=new Array(n),o=jt(e);try{for(o.s();!(t=o.n()).done;){var s=t.value,a=Math.max(0,Math.min(n-1,Math.floor(Mt.call(null,s,n))));s.layer=a,s.x0=gt+a*i,s.x1=s.x0+xt,r[a]?r[a].push(s):r[a]=[s]}}catch(t){o.e(t)}finally{o.f()}if(ft){var h,c=jt(r);try{for(c.s();!(h=c.n()).done;)h.value.sort(ft)}catch(t){c.e(t)}finally{c.f()}}return r}(),C=(bt=Math.min(wt,(mt-yt)/(Pt(E,function(t){return t.length})-1)),E),at=Tt(C,function(t){return(mt-yt-(t.length-1)*bt)/_t(t,Dt)}),N=jt(C);try{for(N.s();!(ot=N.n()).done;){var ht,L=ot.value,S=yt,_=jt(L);try{for(_.s();!(ht=_.n()).done;){var T=ht.value;T.y0=S,T.y1=S+T.value*at,S=T.y1+bt;var ct,P=jt(T.sourceLinks);try{for(P.s();!(ct=P.n()).done;){var ut=ct.value;ut.width=ut.value*at}}catch(C){P.e(C)}finally{P.f()}}}catch(C){_.e(C)}finally{_.f()}S=(mt-S+bt)/(L.length+1);for(var O=0;O<L.length;++O){var lt=L[O];lt.y0+=S*(O+1),lt.y1+=S*(O+1)}!function(t){if(void 0===pt){var e,n=jt(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=i.sourceLinks,o=i.targetLinks;r.sort(At),o.sort(Ot)}}catch(t){n.e(t)}finally{n.f()}}}(L)}}catch(C){N.e(C)}finally{N.f()}for(var A=0;A<Nt;++A){var I=Math.pow(.99,A),dt=Math.max(1-I,(A+1)/Nt);(function(t,e,n){for(var i=t.length-2;0<=i;--i){var r,o=t[i],s=jt(o);try{for(s.s();!(r=s.n()).done;){var a,h,c=r.value,u=0,l=0,d=jt(c.sourceLinks);try{for(d.s();!(a=d.n()).done;){var f=a.value,p=f.target,g=f.value*(p.layer-c.layer);u+=function(t,e){var n,i=e.y0-(e.targetLinks.length-1)*bt/2,r=jt(e.targetLinks);try{for(r.s();!(n=r.n()).done;){var o=n.value,s=o.source,a=o.width;if(s===t)break;i+=a+bt}}catch(t){r.e(t)}finally{r.f()}var h,c=jt(t.sourceLinks);try{for(c.s();!(h=c.n()).done;){var u=h.value,l=u.target,d=u.width;if(l===e)break;i-=d}}catch(t){c.e(t)}finally{c.f()}return i}(c,p)*g,l+=g}}catch(t){d.e(t)}finally{d.f()}0<l&&(h=(u/l-c.y0)*e,c.y0+=h,c.y1+=h,St(c))}}catch(t){s.e(t)}finally{s.f()}void 0===ft&&o.sort(It),Lt(o,n)}})(E,I,dt),function(t,e,n){for(var i=1,r=t.length;i<r;++i){var o,s=t[i],a=jt(s);try{for(a.s();!(o=a.n()).done;){var h,c,u=o.value,l=0,d=0,f=jt(u.targetLinks);try{for(f.s();!(h=f.n()).done;){var p=h.value,g=p.source,y=p.value*(u.layer-g.layer);l+=function(t,e){var n,i=t.y0-(t.sourceLinks.length-1)*bt/2,r=jt(t.sourceLinks);try{for(r.s();!(n=r.n()).done;){var o=n.value,s=o.target,a=o.width;if(s===e)break;i+=a+bt}}catch(t){r.e(t)}finally{r.f()}var h,c=jt(e.targetLinks);try{for(c.s();!(h=c.n()).done;){var u=h.value,l=u.source,d=u.width;if(l===t)break;i-=d}}catch(t){c.e(t)}finally{c.f()}return i}(g,u)*y,d+=y}}catch(t){f.e(t)}finally{f.f()}0<d&&(c=(l/d-u.y0)*e,u.y0+=c,u.y1+=c,St(u))}}catch(t){a.e(t)}finally{a.f()}void 0===ft&&s.sort(It),Lt(s,n)}}(E,I,dt)}return zt(t),Rt(t),Vt(t),t}function Lt(t,e){var n=t.length>>1,i=t[n];o(t,i.y0-bt,n-1,e),r(t,i.y1+bt,1+n,e),o(t,mt,t.length-1,e),r(t,yt,0,e)}function r(t,e,n,i){for(;n<t.length;++n){var r=t[n],o=(e-r.y0)*i;1e-6<o&&(r.y0+=o,r.y1+=o),e=r.y1+bt}}function o(t,e,n,i){for(;0<=n;--n){var r=t[n],o=(r.y1-e)*i;1e-6<o&&(r.y0-=o,r.y1-=o),e=r.y0-bt}}function St(t){var e=t.sourceLinks,n=t.targetLinks;if(void 0===pt){var i,r=jt(n);try{for(r.s();!(i=r.n()).done;)i.value.source.sourceLinks.sort(At)}catch(t){r.e(t)}finally{r.f()}var o,s=jt(e);try{for(s.s();!(o=s.n()).done;)o.value.target.targetLinks.sort(Ot)}catch(t){s.e(t)}finally{s.f()}}}function _t(t,e){var n,i=0,r=t.length,o=-1;if(1===arguments.length)for(;++o<r;)isNaN(n=+t[o])||(i+=n);else for(;++o<r;)isNaN(n=+e.call(t,t[o],o))||(i+=n);return i}function Tt(t,e){var n,i,r=-1,o=t.length;if(1===arguments.length){for(;++r<o;)if(null!=(i=t[r])&&i<=i){n=i;break}for(;++r<o;)null!=(i=t[r])&&i<n&&(n=i)}else{for(;++r<o;)if(null!=(i=e.call(t,t[r],r))&&i<=i){n=i;break}for(;++r<o;)null!=(i=e.call(t,t[r],r))&&i<n&&(n=i)}return n}function Pt(t,e){var n,i,r=-1,o=t.length;if(1===arguments.length){for(;++r<o;)if(null!=(i=t[r])&&i<=i){n=i;break}for(;++r<o;)null!=(i=t[r])&&n<i&&(n=i)}else{for(;++r<o;)if(null!=(i=e.call(t,t[r],r))&&i<=i){n=i;break}for(;++r<o;)null!=(i=e.call(t,t[r],r))&&n<i&&(n=i)}return n}function n(t){return t.target.depth}function i(t){return t.depth}function s(t,e){return e-1-t.height}function a(t,e){return t.sourceLinks.length?t.depth:e-1}function u(t){return t.targetLinks.length?t.depth:t.sourceLinks.length?Tt(t.sourceLinks,n)-1:0}function h(t){return function(){return t}}function Ot(t,e){return It(t.source,e.source)||t.index-e.index}function At(t,e){return It(t.target,e.target)||t.index-e.index}function It(t,e){return t.y0-e.y0}function Dt(t){return t.value||2}function Bt(t,e){return t.get(e)||null}function zt(t){var e,n=jt(t.nodes);try{for(n.s();!(e=n.n()).done;){var i,r=e.value,o=r.y0,s=o,a=jt(r.sourceLinks);try{for(a.s();!(i=a.n()).done;){var h=i.value;h.y0=o+h.width/2,o+=h.width}}catch(t){a.e(t)}finally{a.f()}var c,u=jt(r.targetLinks);try{for(u.s();!(c=u.n()).done;){var l=c.value;l.y1=s+l.width/2,s+=l.width}}catch(t){u.e(t)}finally{u.f()}}}catch(t){n.e(t)}finally{n.f()}}function c(t){return Math.round(10*t)/10}function Rt(t){var e,n=jt(t.nodes);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.x=c(i.x0),i.dx=c(i.x1-i.x0),i.y=c(i.y0),i.dy=c(i.y1-i.y0)}}catch(t){n.e(t)}finally{n.f()}}function Vt(t){var e,n=jt(t.links);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.source&&i.target&&(i.dy=c(i.width),i.sy=c(i.y0-i.source.y0-i.width/2),i.ty=c(i.y1-i.target.y0-i.width/2))}}catch(t){n.e(t)}finally{n.f()}}return e.update=function(t){return zt(t),Rt(t),Vt(t),t},e.nodeId=function(t){return arguments.length?(kt="function"==typeof t?t:h(t),e):kt},e.nodeAlign=function(t){return arguments.length?(Mt="left"===t?i:"right"===t?s:"center"===t?u:a,e):Mt},e.nodeSort=function(t){return arguments.length?(ft=t,e):ft},e.nodeWidth=function(t){return arguments.length?(xt=+t,e):xt},e.nodePadding=function(t){return arguments.length?(wt=bt=+t,e):wt},e.nodes=function(t){return arguments.length?(Et="function"==typeof t?t:h(t),e):Et},e.links=function(t){return arguments.length?(Ct="function"==typeof t?t:h(t),e):Ct},e.linkSort=function(t){return arguments.length?(pt=t,e):pt},e.size=function(t){return arguments.length?(gt=yt=0,vt=+t[0],mt=+t[1],e):[vt-gt,mt-yt]},e.extent=function(t){return arguments.length?(gt=+t[0][0],vt=+t[1][0],yt=+t[0][1],mt=+t[1][1],e):[[gt,yt],[vt,mt]]},e.iterations=function(t){return arguments.length?(Nt=+t,e):Nt},e.link=function(){var c=.5;function e(t){function e(t){return n*(1-t)+i*t}var n,i,r=t.source.x+t.source.dx,o=t.target.x,s=(n=+r,i=+o,e(c)),a=e(1-c),h=t.source.y+t.sy+t.dy/2,t=t.target.y+t.ty+t.dy/2;return"M"+r+","+h+"C"+s+","+h+" "+a+","+t+" "+o+","+t}return e.curvature=function(t){return arguments.length?(c=+t,e):c},e},e}function oc(t,e,n){this.defaultOption={nodeWidth:50,nodePadding:10,nodeColor:"default",lineColor:"both",lineAlpha:.4,alignType:"justify",dragable:!0},this.option=s(this.defaultOption,n,!0,!0),this.graphVis=t,this.snakeyData=e,this.update()}function A(t,e,n){this.defaultOption={arrangeType:"cluster",areaRadius:300,lineCurvature:.5,lineColor:"defined",lineType:"radial",center:[0,0],animate:!1,levelBack:{show:!1,alpha:.1,color:"120,180,120",lineDash:[0]}},this.option=s(this.defaultOption,n,!0,!0),this.levels=[],this.levelBackNodes=[],this.graphVis=t,this.treeData=e,this.init()}function sc(t,e,n){this.defaultOption={nodeSize:10,levelDistance:150,lineColor:"defined",lineType:"curve",direction:"LR"},this.option=s(this.defaultOption,n,!0,!0),this.graphVis=t,this.treeData=e,this.update()}function ac(t,e,n){this.defaultOption={nodeSize:0,nodePadding:5,packAlpha:.1,packThemeColor:"120,120,230",borderDash:[0]},this.option=s(this.defaultOption,n,!0,!0),this.graphVis=t,this.treeData=e,this.init()}function hc(t,e,n){this.defaultOption={layerSpace:45,nodePadding:12,alignType:"center"},this.option=s(this.defaultOption,n,!0,!0),this.graphVis=t,this.treeData=e,this.init()}T.prototype.reloadData=function(t){this.treeData=t,this.graphVis.clearAll(),this.visNodes=[],this.idMapChildNode={},this.idMapNode={},this.rootVisNode=null,this.currentNode=null,this.rootVisNode=this.buildXmindNode(this.treeData),this.graphVis.setZoom()},T.prototype.resetOption=function(t){this.option=s(this.defaultOption,t,!0,!0),this.reloadData(this.treeData)},T.prototype.buildXmindNode=function(t){var e=this,n=e.createVisNode(t,null,"down"),i=this.graphVis.getViewCenter(),i=(n.cx=i.x,n.cy=i.y,n.finishX=n.x,n.finishY=n.y,n.isRootNode=!0,this.rootVisNode=n,this.visNodes.push(n),e.splitSubTree(t.children||[])),t=(this.buildVisTreeNode({children:i.rightNodes},n,"down"),this.layout(n,this.option.nodeSpace,this.option.levelSpace,"down"),n.finishX),i=(this.buildVisTreeNode({children:i.leftNodes},n,"up"),this.layout(n,this.option.nodeSpace,this.option.levelSpace,"up"),n.finishX-t);return this.shiftLeftTreeNode(n.leftSubNodes,i),n.finishX=t,e.option.animate?(e.visNodes.forEach(function(t){t.x=n.finishX,t.y=n.finishY}),e.graphVis.createBaseAnimate({targets:e.visNodes,duration:800,easing:"easeInQuad",x:function(t){return t.finishX},y:function(t){return t.finishY},begin:function(t){e.graphVis.switchAnimate(!0)}}).finished.then(function(){e.graphVis.switchAnimate(!1)})):e.visNodes.forEach(function(t){t.x=t.finishX,t.y=t.finishY}),this.drawLine(n),n},T.prototype.switchNodeExpand=function(t){var e;(this.currentNode=t).hasChild&&(0==(t.outLinks||[]).length?this.option.hasOwnProperty("appendChildNode")?"function"==typeof(e=this.option.appendChildNode)&&e(t):this.expendChild(t,this.idMapChildNode[t.id]):this.contractChild(t))},T.prototype.highLightParent=function(t){var e=this,n=[t];e.findAllPreLevelNodes(t,n),n.forEach(function(t){e.selectedElement(t),(t.outLinks||[]).forEach(function(t){-1!=n.indexOf(t.target)&&e.selectedElement(t)})})},T.prototype.findAllPreLevelNodes=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=this;(t.inLinks||[]).forEach(function(t){e.push(t.source),n.findAllPreLevelNodes(t.source,e)})},T.prototype.selectedElement=function(t){this.graphVis.addToSelectedElements([t])},T.prototype.buildVisTreeNode=function(t,i){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"down",o=this;(t.children||[]).forEach(function(t,e){var n=o.createVisNode(t,i,r);o.buildVisTreeNode(t,n,r)})},T.prototype.createVisNode=function(t,e,n){var i=this.graphVis.addNode({id:t.id,label:t.label||t.name});return i.leftSubNodes=[],i.rightSubNodes=[],i.directType=n,i.hasChild=!!t.children,i.width=this.option.nodeWidth,i.height=this.option.nodeHeight,e&&("down"==n?e.rightSubNodes:e.leftSubNodes).push(i),this.visNodes.push(i),i},T.prototype.reloadLayout=function(t,e){var n=this;this.treeData=t,this.idMapNode={},this.buildVirtualXmind(this.treeData),e&&(this.currentNode.isRootNode?(t=this.splitSubTree(this.newChildren),this.buildVisTreeNode({children:t.rightNodes},this.currentNode,"down"),this.buildVisTreeNode({children:t.leftNodes},this.currentNode,"up")):this.buildVisTreeNode({children:this.newChildren},this.currentNode,this.currentNode.directType),this.drawLine(this.currentNode)),this.visNodes.forEach(function(t){var e=n.idMapNode[t.id];e&&(t.x=e.finishX,t.y=e.finishY)}),this.graphVis.setZoom()},T.prototype.buildVirtualXmind=function(t){var e=this.splitSubTree(t.children||[]),n={id:t.id,label:t.name,leftSubNodes:[],rightSubNodes:[],width:0,cwidth:0},i=this.graphVis.getViewCenter(),i=(n.finishX=i.x,n.finishY=i.y,this.buildVirtualSubNode({children:e.rightNodes},n,"down"),this.layout(n,this.option.nodeSpace,this.option.levelSpace,"down"),n.finishX),e=(this.buildVirtualSubNode({children:e.leftNodes},n,"up"),this.layout(n,this.option.nodeSpace,this.option.levelSpace,"up"),n.finishX-i);return this.shiftLeftTreeNode(n.leftSubNodes,e),n.finishX=i,this.idMapNode[t.id]=n},T.prototype.splitSubTree=function(t){var n=Math.ceil(t.length/2),i=[],r=[];return"umd"==this.option.type?t.forEach(function(t,e){(e<n?i:r).push(t)}):"ud"==this.option.type?t.forEach(function(t,e){i.push(t)}):"du"==this.option.type&&t.forEach(function(t,e){r.push(t)}),{leftNodes:r,rightNodes:i}},T.prototype.buildVirtualSubNode=function(t,i){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"down",o=this;(t.children||[]).forEach(function(t,e){var n={id:t.id,label:t.name,leftSubNodes:[],rightSubNodes:[]};n.directType=r,n.height=o.option.nodeHeight,n.width=o.option.nodeWidth,("down"==r?i.rightSubNodes:i.leftSubNodes).push(n),o.idMapNode[n.id]=n,o.buildVirtualSubNode(t,n,r)})},T.prototype.drawLine=function(n){var i=this;n.leftSubNodes.concat(n.rightSubNodes).forEach(function(e,t){i.graphVis.links.filter(function(t){return t.source.id==n.id&&t.target.id==e.id})[0]||i.graphVis.addEdge({source:n.id,target:e.id}),i.drawLine(e)})},T.prototype.shiftLeftTreeNode=function(t,e){var n=this;t.forEach(function(t){t.finishX-=e,n.shiftLeftTreeNode(t.leftSubNodes||[],e)})},T.prototype.layout=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:20,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:50,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"down",r=1/0,o=-1/0,s="down"==i?t.rightSubNodes:t.leftSubNodes;t.cwidth=t.width;for(var a=0,h=s.length,c=0;c<h;c++){var u=s[c];u.finishY="down"==i?t.finishY+n:t.finishY-n,u.finishX=t.finishX+a,this.layout(u,e,n,i),t.cwidth+=u.cwidth+e,0==c&&(t.cwidth-=this.option.nodeWidth+e),a+=u.cwidth+e,r=Math.min(r,u.finishX),o=Math.max(o,u.finishX)}0<s.length&&(t.finishX=r+Math.abs(o-r)/2)},T.prototype.deepFindChildNode=function(t,e){var n=this,t=(t.outLinks||[]).map(function(t){return t.target});t.forEach(function(t){e.push(t)}),t.forEach(function(t){t.contract||n.deepFindChildNode(t,e)})},T.prototype.contractChild=function(t){var e=this,n=[];e.deepFindChildNode(t,n),e.option.animate?(n.forEach(function(t){(t.inLinks||[]).forEach(function(t){t.visible=!1})}),e.graphVis.createBaseAnimate({targets:n,x:t.x,y:t.y,alpha:0,duration:600,easing:"easeInQuad",begin:function(t){e.graphVis.switchAnimate(!0)}}).finished.then(function(){e.graphVis.deleteNodes(n),e.removeChild(e.treeData,t.id),e.reloadLayout(e.treeData,!1),e.graphVis.switchAnimate(!1)})):(e.graphVis.deleteNodes(n),e.removeChild(e.treeData,t.id),e.reloadLayout(e.treeData,!1))},T.prototype.expendChild=function(e,t){var n,i=this;i.appendChild(i.treeData,e.id,t),i.reloadLayout(i.treeData,!0),i.option.animate&&(n=[],i.deepFindChildNode(e,n),n.forEach(function(t){t.x=e.x,t.y=e.y,t.alpha=0,(t.inLinks||[]).forEach(function(t){t.visible=!1})}),i.graphVis.createBaseAnimate({targets:n,x:function(t){return i.idMapNode[t.id].finishX},y:function(t){return i.idMapNode[t.id].finishY},alpha:1,duration:600,easing:"easeOutQuad",begin:function(t){i.graphVis.switchAnimate(!0)}}).finished.then(function(){n.forEach(function(t){(t.inLinks||[]).forEach(function(t){t.visible=!0})}),i.graphVis.switchAnimate(!1)}))},T.prototype.removeChild=function(t,n){var i=this;t.id===n?(i.idMapChildNode[t.id]=t.children,t.children=null):(t.children||[]).forEach(function(t,e){i.removeChild(t,n)})},T.prototype.appendChild=function(t,n,i){var r=this;t.id===n?(t.children=i||[],r.newChildren=t.children):(t.children||[]).forEach(function(t,e){r.appendChild(t,n,i)})},P.prototype.reloadData=function(t){this.treeData=t,this.graphVis.clearAll(),this.visNodes=[],this.idMapChildNode={},this.idMapNode={},this.rootVisNode=null,this.currentNode=null,this.rootVisNode=this.buildXmindNode(this.treeData),this.graphVis.zoomFit()},P.prototype.resetOption=function(t){this.option=s(this.defaultOption,t,!0,!0),this.reloadData(this.treeData)},P.prototype.buildXmindNode=function(t){var e=this,n=e.createVisNode(t,null,"right"),i=this.graphVis.getViewCenter(),i=(n.cx=i.x,n.cy=i.y,n.finishX=n.cx,n.finishY=n.cy,n.maxChildW=0,n.isRootNode=!0,this.rootVisNode=n,this.visNodes.push(n),e.splitSubTree(t.children||[])),t=(this.buildVisTreeNode({children:i.rightNodes},n,"right"),this.layout(n,this.option.levelSpace,this.option.nodeSpace,"right"),n.finishY),i=(this.buildVisTreeNode({children:i.leftNodes},n,"left"),this.layout(n,this.option.levelSpace,this.option.nodeSpace,"left"),n.finishY-t);return this.shiftLeftTreeNode(n.leftSubNodes,i),n.finishY=t,e.option.animate?(e.visNodes.forEach(function(t){t.x=n.finishX,t.y=n.finishY}),e.graphVis.createBaseAnimate({targets:e.visNodes,duration:800,easing:"easeInQuad",x:function(t){return t.finishX},cy:function(t){return t.finishY},begin:function(t){e.graphVis.switchAnimate(!0)}}).finished.then(function(){e.graphVis.switchAnimate(!1)})):e.visNodes.forEach(function(t){t.x=t.finishX,t.cy=t.finishY}),this.drawLine(n),n},P.prototype.highLightParent=function(t){var e=this,n=[t];e.findAllPreLevelNodes(t,n),n.forEach(function(t){e.selectedElement(t),(t.outLinks||[]).forEach(function(t){-1!=n.indexOf(t.target)&&e.selectedElement(t)})})},P.prototype.findAllPreLevelNodes=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=this;(t.inLinks||[]).forEach(function(t){e.push(t.source),n.findAllPreLevelNodes(t.source,e)})},P.prototype.selectedElement=function(t){this.graphVis.addToSelectedElements([t])},P.prototype.buildVisTreeNode=function(t,i){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"right",o=this;(t.children||[]).forEach(function(t,e){var n=o.createVisNode(t,i,r);o.buildVisTreeNode(t,n,r)})},P.prototype.createVisNode=function(t,e,n){t=this.graphVis.addNode({id:t.id,label:t.label||t.name});return t.leftSubNodes=[],t.rightSubNodes=[],t.directType=n,t.nodePadding=this.option.nodePadding/2,t.hasChild=!!t.children,t.width=this.getTextWidth(t),e&&("right"==n?e.rightSubNodes:e.leftSubNodes).push(t),this.visNodes.push(t),t},P.prototype.reloadLayout=function(t,e){var n=this;this.treeData=t,this.idMapNode={},this.buildVirtualXmind(this.treeData),e&&(this.currentNode.isRootNode?(t=this.splitSubTree(this.newChildren),this.buildVisTreeNode({children:t.rightNodes},this.currentNode,"right"),this.buildVisTreeNode({children:t.leftNodes},this.currentNode,"left")):this.buildVisTreeNode({children:this.newChildren},this.currentNode,this.currentNode.directType),this.drawLine(this.currentNode)),this.visNodes.forEach(function(t){var e=n.idMapNode[t.id];e&&(t.x=e.finishX,t.cy=e.finishY)}),this.graphVis.zoomFit()},P.prototype.buildVirtualXmind=function(t){var e=this.splitSubTree(t.children||[]),n={id:t.id,label:t.name,leftSubNodes:[],rightSubNodes:[],maxChildW:0,height:0},i=(n.cheight=n.height,n.width=this.getTextWidth(n),this.graphVis.getViewCenter()),i=(n.finishX=i.x,n.finishY=i.y,this.buildVirtualSubNode({children:e.rightNodes},n,"right"),this.layout(n,this.option.levelSpace,this.option.nodeSpace,"right"),n.finishY),e=(this.buildVirtualSubNode({children:e.leftNodes},n,"left"),this.layout(n,this.option.levelSpace,this.option.nodeSpace,"left"),n.finishY-i);return this.shiftLeftTreeNode(n.leftSubNodes,e),n.finishY=i,this.idMapNode[t.id]=n},P.prototype.splitSubTree=function(t){var n=Math.ceil(t.length/2),i=[],r=[];return"lcr"==this.option.type?t.forEach(function(t,e){(e<n?i:r).push(t)}):"lr"==this.option.type?t.forEach(function(t,e){i.push(t)}):"rl"==this.option.type&&t.forEach(function(t,e){r.push(t)}),{leftNodes:r,rightNodes:i}},P.prototype.buildVirtualSubNode=function(t,i){var r=this,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"right",s=this;(t.children||[]).forEach(function(t,e){var n={id:t.id,label:t.name,leftSubNodes:[],rightSubNodes:[],maxChildW:0};n.directType=o,n.width=r.getTextWidth(n),("right"==o?i.rightSubNodes:i.leftSubNodes).push(n),s.idMapNode[n.id]=n,s.buildVirtualSubNode(t,n,o)})},P.prototype.drawLine=function(n){var i=this;n.leftSubNodes.concat(n.rightSubNodes).forEach(function(e,t){i.graphVis.links.filter(function(t){return t.source.id==n.id&&t.target.id==e.id})[0]||i.graphVis.addEdge({source:n.id,target:e.id}),i.drawLine(e)})},P.prototype.shiftLeftTreeNode=function(t,e){var n=this;t.forEach(function(t){t.finishY=t.finishY-e,n.shiftLeftTreeNode(t.leftSubNodes||[],e)})},P.prototype.getTextWidth=function(n){var t=this.graphVis.customStyle(function(t){t.save(),t.font=n.font;var e=t.measureText(n.label).width;return t.restore(),e}),t=Math.ceil(t)+this.option.nodePadding;return Math.max(t,this.option.maxWidth)},P.prototype.layout=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:140,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:10,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"right",r=0,o=1/0,s=-1/0,a="right"==i?t.rightSubNodes:t.leftSubNodes;t.cheight=t.height;for(var h=a.length,c=0;c<h;c++){var u=a[c];u.finishX="right"==i?t.finishX+t.width+e:t.finishX-e-u.width,u.finishY=t.finishY+r,this.layout(u,e,n,i),u.width>t.maxChildW&&(t.maxChildW=u.width),t.cheight+=u.cheight,r+=u.cheight+n,o=Math.min(o,u.finishY),s=Math.max(s,u.finishY)}0<a.length&&(t.finishY=o+Math.abs(s-o)/2)},P.prototype.deepFindChildNode=function(t,e){var n=this,t=(t.outLinks||[]).map(function(t){return t.target});t.forEach(function(t){e.push(t)}),t.forEach(function(t){t.contract||n.deepFindChildNode(t,e)})},P.prototype.contractChild=function(t){var e=this,n=[];e.deepFindChildNode(t,n),e.option.animate?(n.forEach(function(t){(t.inLinks||[]).forEach(function(t){t.visible=!1})}),e.graphVis.createBaseAnimate({targets:n,x:t.x,y:t.y,alpha:0,duration:600,easing:"easeInQuad",begin:function(t){e.graphVis.switchAnimate(!0)}}).finished.then(function(){e.graphVis.deleteNodes(n),e.removeChild(e.treeData,t.id),e.reloadLayout(e.treeData,!1),e.graphVis.switchAnimate(!1)})):(e.graphVis.deleteNodes(n),e.removeChild(e.treeData,t.id),e.reloadLayout(e.treeData,!1))},P.prototype.expendChild=function(e,t){var n,i=this;i.appendChild(i.treeData,e.id,t),i.reloadLayout(i.treeData,!0),i.option.animate&&(n=[],i.deepFindChildNode(e,n),n.forEach(function(t){t.x=e.x,t.y=e.y,t.alpha=0,(t.inLinks||[]).forEach(function(t){t.visible=!1})}),i.graphVis.createBaseAnimate({targets:n,x:function(t){return i.idMapNode[t.id].finishX},cy:function(t){return i.idMapNode[t.id].finishY},alpha:1,duration:600,easing:"easeOutQuad",begin:function(t){i.graphVis.switchAnimate(!0)}}).finished.then(function(){n.forEach(function(t){(t.inLinks||[]).forEach(function(t){t.visible=!0})}),i.graphVis.switchAnimate(!1)}))},P.prototype.removeChild=function(t,n){var i=this;t.id===n?(i.idMapChildNode[t.id]=t.children,t.children=null):(t.children||[]).forEach(function(t,e){i.removeChild(t,n)})},P.prototype.appendChild=function(t,n,i){var r=this;t.id===n?(t.children=i||[],r.newChildren=t.children):(t.children||[]).forEach(function(t,e){r.appendChild(t,n,i)})},oc.prototype.resetOption=function(t){this.option=s(this.option,t,!0,!0),this.update()},oc.prototype.update=function(){this.graphVis.clearAll(),this.drawSankey(this.snakeyData),this.graphVis.zoomFit()},oc.prototype.regiestLineShape=function(){this.graphVis.definedLinkPaintFunc(function(t,e){function n(t){return i*(1-t)+r*t}var i,r,o=this.source.x+this.source.dx,s=this.target.x,a=(i=+o,r=+s,n(.5)),h=n(.5),c=this.source.y+this.sy+this.dy/2,u=this.target.y+this.ty+this.dy/2;this.lineType="hbezier",this.pathDefine="M ".concat(o," ").concat(c," C ").concat(a," ").concat(c," ").concat(h," ").concat(u," ").concat(s," ").concat(u),this.path=[],this.bezierPoints=[o,c,a,c,h,u,s,u],this.setLineStyle(t),t.lineCap="butt",t.stroke(new Path2D(this.pathDefine))})},oc.prototype.drawSankey=function(t){var e=Math.round(.9*this.graphVis.stage.width),n=Math.round(.9*this.graphVis.stage.height),e=(new rc).nodeId(function(t){return t.id}).nodeAlign(this.option.alignType).nodeWidth(this.option.nodeWidth).nodePadding(this.option.nodePadding).size([e,n])(t),i=this.option.dragable,r=[],o=1/0,s=-1/0,a=(e.nodes.forEach(function(t,e){o=Math.min(t.x,o),s=Math.max(t.x,s)}),Math.round((o+s)/2)),h=this.option.nodeColor,c=this,u=(e.nodes.forEach(function(t,e){var n={x:t.x,y:t.y,height:t.dy,width:t.dx,shape:"rect",dx:t.dx,dragable:i,textOffsetX:t.x<a?5:-5,textPosition:t.x<a?"Middle_Right":"Middle_Left"};"random"==h?n.fillColor=c.graphVis.randomColor():t.style&&t.style.fillColor&&(n.fillColor=t.style.fillColor),r.push({id:t.id||"10000"+e,label:t.label||t.id,type:t.type||"default",style:n,properties:t.properties})}),this.option.lineColor),l=this.option.lineAlpha,d=["both","source","target"].includes(u),f=[];e.links.forEach(function(t,e){var n={sy:t.sy,ty:t.ty,dy:t.dy,lineWidth:Math.max(t.width,1),alpha:l};d?n.colorType=u:t.style&&t.style.strokeColor&&(n.strokeColor=t.style.strokeColor),t.source&&t.target&&f.push({id:t.id||"link-".concat(e),source:t.source.id,target:t.target.id,label:t.value,type:t.type||"default",style:n,properties:t.properties})}),this.regiestLineShape(),this.graphVis.addGraph({nodes:r,links:f}),this.graphVis.zoomFit()},oc.prototype.deepExtend=function(t,e,n,i){for(var r in e)if(e.hasOwnProperty(r)||!0===n)if(e[r]&&e[r].constructor===Object)void 0===t[r]&&(t[r]={}),t[r].constructor===Object?this.deepExtend(t[r],e[r],n):null===e[r]&&void 0!==t[r]&&!0===i?delete t[r]:t[r]=e[r];else if(Array.isArray(e[r])){t[r]=[];for(var o=0;o<e[r].length;o++)t[r].push(e[r][o])}else null===e[r]&&void 0!==t[r]&&!0===i?delete t[r]:t[r]=e[r];return t},A.prototype.resetOption=function(t){this.option=s(this.option,t,!0,!0),this.update();var e=this.option.lineCurvature,n=this.option.lineType;this.graphVis.links.forEach(function(t){t.curvature=e,t.customLineType=n}),this.graphVis.refreshView()},A.prototype.update=function(){var e,t=this.raidalLayout(this.treeData),n=this.graphVis.nodes,i=new Map,r=(n.forEach(function(t){i.set(t.id,t)}),this.option.animate);t.forEach(function(t){var e=t.data.id,e=i.get(e);e&&(t=t.data.style,e.rotate=t.rotate,e.textPosition=t.textPosition,e.textOffsetX=t.textOffsetX,e.rawX=t.rawX,e.rawY=t.rawY,e.nodeDepth=t.nodeDepth,r?(e.targetX=t.cx,e.targetY=t.cy):(e.cx=t.cx,e.cy=t.cy))}),r&&(e=this).graphVis.createBaseAnimate({targets:n,duration:1500,easing:"easeInOutExpo",cx:function(t){return t.targetX},cy:function(t){return t.targetY},begin:function(t){e.graphVis.switchAnimate(!0)}}).finished.then(function(){e.graphVis.switchAnimate(!1)})},A.prototype.init=function(){this.graphVis.clearAll(),this.drawRadialTree(this.treeData)},A.prototype.regiestLineShape=function(){var a=this;this.graphVis.definedLinkPaintFunc(function(t){var e=this.source.rawX,n=this.source.rawY,i=this.target.rawX,r=this.target.rawY,o=a.radialCoordinate(e,n+(r-n)*this.curvature),s=a.radialCoordinate(i,r+(n-r)*this.curvature);switch(this.customLineType){case"polygonal":this.lineType="straight",this.path=[{x:this.source.cx,y:this.source.cy},{x:s.x,y:s.y},{x:this.target.cx,y:this.target.cy}],this.pathDefine="M".concat(this.source.cx," ").concat(this.source.cy," L").concat(s.x," ").concat(s.y," ").concat(this.target.cx," ").concat(this.target.cy);break;case"fold":this.lineType="straight",this.path=[{x:this.source.cx,y:this.source.cy},{x:o.x,y:o.y},{x:this.target.cx,y:this.target.cy}],this.pathDefine="M".concat(this.source.cx," ").concat(this.source.cy," L").concat(o.x," ").concat(o.y," ").concat(this.target.cx," ").concat(this.target.cy);break;case"radial":this.lineType="bezier",this.pathDefine="M ".concat(this.source.cx," ").concat(this.source.cy," C ").concat(o.x," ").concat(o.y," ").concat(s.x," ").concat(s.y," ").concat(this.target.cx," ").concat(this.target.cy),this.path=[],this.bezierPoints=[this.source.cx,this.source.cy,o.x,o.y,s.x,s.y,this.target.cx,this.target.cy];break;default:this.lineType="straight",this.path=[{x:this.source.cx,y:this.source.cy},{x:this.target.cx,y:this.target.cy}],this.pathDefine="M".concat(this.source.cx," ").concat(this.source.cy," L").concat(this.target.cx," ").concat(this.target.cy)}this.setLineStyle(t),t.stroke(new Path2D(this.pathDefine))})},A.prototype.raidalLayout=function(t){var t=E.hierarchy(t),t=(this.option.areaRadius||(this.option.areaRadius=Math.max(Math.round(this.graphVis.getViewSize().width/2),150)),("tree"==this.option.arrangeType?E.tree():E.cluster()).size([2*Math.PI,this.option.areaRadius]).separation(function(t,e){return(t.parent==e.parent?1:2)/t.depth})(t).descendants()),s=this,a=this.option.center[0],h=new Set;return t.forEach(function(t){var e=s.radialCoordinate(t.x,t.y),n=0,i="Bottom_Center",r=0,o=0<(t.children||[]).length;0<t.depth&&(r=e.x>=a?(n=180*t.x/Math.PI-90,i=o?"Middle_Left":"Middle_Right",o?-2:2):(n=180*t.x/Math.PI+90,i=o?"Middle_Right":"Middle_Left",o?2:-2)),h.add(t.depth),t.data.style=b(b({},t.data.style),{},{cx:e.x,cy:e.y,textPosition:i,textOffsetX:r,rotate:n,rawX:t.x,rawY:t.y,nodeDepth:t.depth})}),this.levels=Array.from(h),this.option.levelBack.show&&this.drawBackGroundNodes(),t},A.prototype.drawBackGroundNodes=function(){var t=this.levels.sort(function(t,e){return e-t}),e=this.graphVis.randomColor(),n=this.option.center,i=this.option.areaRadius/2,r=this.option.levelBack.color,o=this.option.levelBack.lineDash,s=this.option.levelBack.alpha,a=(this.graphVis.deleteNodes(this.levelBackNodes),[]);t.forEach(function(t){a.push({id:"depyh-"+t,style:{mouseInteractive:!1,showlabel:!1,shape:"circle",size:t*i+i/2,cx:n[0],cy:n[1],alpha:s,fillColor:r,borderColor:r||e,borderWidth:2,lineDash:o}})}),this.levelBackNodes=this.graphVis.addNodes(a)},A.prototype.drawRadialTree=function(t){var s=this,t=this.raidalLayout(t),a={nodes:[],links:[]};t.forEach(function(t,e){var n=t.data.id,i=(a.nodes.push({id:n,label:t.data.name||"".concat(n),type:t.data.type||"default",style:b({},t.data.style),properties:b({},t.data.properties)}),s.option.lineColor),r=s.option.lineCurvature,o=s.option.lineType;(t.children||[]).forEach(function(t){a.links.push({id:"e-".concat(n,"-").concat(t.data.id),source:n,target:t.data.id,style:{colorType:i,customLineType:o,curvature:r}})})}),-1!=["radial","polygonal","fold"].indexOf(this.option.lineType)&&this.regiestLineShape(),this.graphVis.addGraph(a)},A.prototype.highLightParent=function(t){var e=this,n=[t];e.findAllPreLevelNodes(t,n),n.forEach(function(t){e.selectedElement(t),(t.outLinks||[]).forEach(function(t){-1!=n.indexOf(t.target)&&e.selectedElement(t)})})},A.prototype.findAllPreLevelNodes=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=this;(t.inLinks||[]).forEach(function(t){e.push(t.source),n.findAllPreLevelNodes(t.source,e)})},A.prototype.selectedElement=function(t){this.graphVis.addToSelectedElements([t])},A.prototype.radialCoordinate=function(t,e){return t-=Math.PI/2,{x:e*Math.cos(t)+this.option.center[0],y:e*Math.sin(t)+this.option.center[1]}},sc.prototype.resetOption=function(t){this.option=s(this.option,t,!0,!0),this.update()},sc.prototype.update=function(){this.graphVis.clearAll(),this.drawComparctTree(this.treeData),this.graphVis.zoomFit()},sc.prototype.regiestLineShape=function(){var i=this.option.direction;this.graphVis.definedLinkPaintFunc(function(t){var e=this.source,n=this.target;this.path=[],"LR"==i||"RL"==i?(this.pathDefine="M".concat(n.cx," ").concat(n.cy," C").concat(e.cx," ").concat(n.cy," ").concat(e.cx," ").concat(e.cy," ").concat(e.cx," ").concat(e.cy),this.bezierPoints=[n.cx,n.cy,e.cx,n.cy,e.cx,e.cy,e.cx,e.cy]):(this.pathDefine="M".concat(e.cx," ").concat(e.cy," C").concat(n.cx," ").concat(e.cy," ").concat(n.cx," ").concat(n.cy," ").concat(n.cx," ").concat(n.cy),this.bezierPoints=[e.cx,e.cy,n.cx,e.cy,n.cx,n.cy,n.cx,n.cy]),this.lineType="bezier",this.setLineStyle(t),t.stroke(new Path2D(this.pathDefine))})},sc.prototype.drawComparctTree=function(t){var h=this,c=this,t=E.hierarchy(t),t=E.tree().nodeSize([c.option.nodeSize||10,c.option.levelDistance||150])(t).descendants(),u={nodes:[],links:[]};t.forEach(function(t){var e=c.adapterCoodi(t),n=e.x,i=e.y,r=e.rotate,o=e.textPosition,e=e.textOffsetX,s=(0==t.depth&&(o="Bottom_Center",r=e=0),t.data.id),a=(u.nodes.push({id:s,label:t.data.id||"".concat(s),style:b({cx:n,cy:i,textPosition:o,textOffsetX:e,rotate:r},t.data.style),properties:b({},t.data.properties)}),h.option.lineColor);(t.children||[]).forEach(function(t){u.links.push({source:s,target:t.data.id,style:{colorType:a}})})}),"curve"==this.option.lineType&&this.regiestLineShape(),this.graphVis.addGraph(u)},sc.prototype.adapterCoodi=function(t){var e=0,n=0,i=0,r="Middle_Right",o=0,s=0<(t.children||[]).length;switch(this.option.direction){case"LR":e=t.y,n=t.x,i=0,r=s?"Middle_Left":"Middle_Right",o=s?-2:2;break;case"RL":e=-t.y,n=t.x,i=0,r=s?"Middle_Right":"Middle_Left",o=s?2:-2;break;case"TB":e=t.x,n=t.y,i=90,r=s?"Middle_Left":"Middle_Right",o=s?-2:2;break;case"BT":e=t.x,n=-t.y,i=-90,r=s?"Middle_Left":"Middle_Right",o=s?-2:2}return{x:e,y:n,rotate:i,textPosition:r,textOffsetX:o}},sc.prototype.highLightParent=function(t){var e=this,n=[t];e.findAllPreLevelNodes(t,n),n.forEach(function(t){e.selectedElement(t),(t.outLinks||[]).forEach(function(t){-1!=n.indexOf(t.target)&&e.selectedElement(t)})})},sc.prototype.findAllPreLevelNodes=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=this;(t.inLinks||[]).forEach(function(t){e.push(t.source),n.findAllPreLevelNodes(t.source,e)})},sc.prototype.selectedElement=function(t){this.graphVis.addToSelectedElements([t])},ac.prototype.init=function(){this.graphVis.clearAll();var t=this.packLayout(this.treeData);this.graphVis.addNodes(t),this.graphVis.zoomFit()},ac.prototype.resetOption=function(t){this.option=s(this.option,t,!0,!0),this.init()},ac.prototype.packLayout=function(t){var f=this,e=this.graphVis.getViewSize(),n=this.option.nodeSize,t=E.hierarchy(t).sum(function(t){return t.children?0:isNaN(t.value)?1:t.value}).sort(function(t,e){return(isNaN(e.value)?1:e.value)-(isNaN(t.value)?1:t.value)}),e=E.pack().size([e.width-10,e.height-10]).padding(this.option.nodePadding),e=(n&&e.radius(function(t){return n}),e(t)),p=this.option.packThemeColor,g=this.option.packAlpha,y=this.option.borderDash,t=[];return function t(e,n,i){var r=e.children,o=e.x,s=e.y,a=e.r,h=e.data.id,c=e.data.name,u=e.data.type||"default";if(r){var l=f.graphVis.randomColor();0<r.length&&i.push({id:h,label:c,type:u,style:{shape:"circle",x:o-a,y:s-a,radius:a,dragable:!1,fillColor:p,alpha:g,borderWidth:1,borderColor:l,textPosition:"Bottom_Center",textOffsetY:-Math.round(a/4),font:"normal ".concat(Math.max(Math.round(a/5),6),"px YaHei"),lineDash:y},properties:b({},e.data.properties)});for(var d=0;d<r.length;d++)t(r[d],l,i)}else i.push({id:h,label:c,type:u,style:b(b({fillColor:n},e.data.style),{},{x:o-a,y:s-a,radius:a,dragable:!1}),properties:b({},e.data.properties)})}(e,this.graphVis.randomColor(),t),t},hc.prototype.init=function(){this.graphVis.clearAll(),this.regiestLineShape();var n,i,r,t,e,o=this.treeData;"center"==this.option.alignType?(t=o.children||[],n=Math.ceil(t.length/2),i=[],r=[],t.forEach(function(t,e){(e<n?r:i).push(t)}),t={id:o.id,name:o.name,style:b({},o.style),children:r},e={id:o.id,children:i},this.layout(t,"left"),this.layout(e,"right")):"left"==this.option.alignType?this.layout(o,"left"):this.layout(o,"right"),this.graphVis.zoomFit()},hc.prototype.resetOption=function(t){this.option=s(this.option,t,!0,!0),this.init()},hc.prototype.layout=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"left",n=0,t=E.hierarchy(t).eachBefore(function(t){return t.index=n++}).descendants(),i="right"==e?-this.option.layerSpace:this.option.layerSpace,r=this.option.nodePadding,o={nodes:[],links:[]};t.forEach(function(t){var e=t.data.id;o.nodes.push({id:e,label:t.data.name||e,style:b(b({},t.data.style),{},{cx:t.depth*i,cy:t.index*r,textOffsetX:0==t.depth?0:i<0?-3:3,textPosition:0==t.depth?"Top_Center":i<0?"Middle_Left":"Middle_Right"}),properties:b({},t.data.properties)}),(t.children||[]).forEach(function(t){o.links.push({id:"e-".concat(e,"-").concat(t.data.id),source:e,target:t.data.id})})}),this.graphVis.addGraph(o)},hc.prototype.regiestLineShape=function(){this.graphVis.definedLinkPaintFunc(function(t){var e=this.source,n=this.target,e=(this.lineType="straight",this.path=[{x:e.cx,y:e.cy},{x:e.cx,y:n.cy},{x:n.cx,y:n.cy}],"M".concat(e.cx," ").concat(e.cy," L").concat(e.cx," ").concat(n.cy," L").concat(n.cx," ").concat(n.cy));this.setLineStyle(t),t.stroke(new Path2D(e))})};var cc=function(t,e,n,i,r){var o=e+Math.cos(i)*t,s=n+Math.sin(i)*t,a=e+Math.cos(r)*t,t=n+Math.sin(r)*t,r=4*Math.tan((r-i)/4)/3;return{x0:o,y0:s,x1:o-r*(s-n),y1:s+r*(o-e),x2:a+r*(t-n),y2:t-r*(a-e),x3:a,y3:t}};function uc(t,e,n){this.defaultOption={type:"cicular",radius:300,nodePadding:50,textAngle:45},this.option=s(this.defaultOption,n,!0,!0),this.graphVis=t,this.graphData=e,this.init()}function lc(t,e,n){this.defaultOption={multigraph:!1,rankdir:"TB",align:void 0,nodesep:50,ranksep:50,edgesep:10,ranker:"longest-path",pathType:"flod",pathRoundRadius:20},this.option=s(this.defaultOption,n,!0,!0),this.graphVis=t,this.graphData=e,this.init()}function I(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.container;if(!(e&&e instanceof HTMLElement))throw new Error("not find html container,can not init");var n=t.licenseKey;if(!n)throw new Error("please config license key!");t=t.config,this.defaultConfig={node:{label:{show:!0,color:"50,50,50",font:"normal 14px Arial",wrapText:!1,textPosition:"Bottom_Center",textOffsetX:0,textOffsetY:0,background:null,borderWidth:0,borderColor:null},shape:"circle",color:"30,160,250",borderColor:"30,100,250",borderWidth:0,tagColor:"230,30,30",size:60,alpha:1,borderRadius:0,padding:0,selected:{borderColor:"50,50,230",borderAlpha:1,borderWidth:5,showShadow:!1,shadowColor:"80,160,240",shadowBlur:10}},link:{label:{show:!0,color:"20,20,20",font:"normal 13px Arial"},lineType:"straight",colorType:"defined",color:"120,110,110",alpha:1,lineWidth:2,lineDash:[0],showArrow:!0,arrowType:"triangle",selected:{color:"50,50,230"}},scene:{},group:{},highLightNeiber:!1,wheelZoom:.9,selectBox:{color:"10,10,225",alpha:.1}},t=t||this.defaultConfig,this.config=null,this.resetConfig(t),t=s({container:"default",width:200,height:160,viewColor:"#3ca9f1"},this.config.miniMap||{},!0,!0);this.stage=new Q(e,t,!1),this.canvas=this.stage.canvas,this.scene=null,this.nodes=[],this.links=[],this.currentNode=null,this.currentLink=null,this.currentGroup=null,this.showLinkFlag=!0,this.clusterGroups=[],this.currentCluster=null,this.currentLayout=null,this.undoManager=null,this.validChar="1_Z3JhcGh2aXMuY24=_1688922665312",this.licenseKey=n,this.drawLinkFlag=!1,this.virNode=null,this.drawLineCallback=function(t){return t},this.sceneEvent=null,this.defindPaintFuncCache={nodePaintFunc:null,linePaintFunc:null,nodeInBoundFunc:null,linkInBoundFunc:null},this.iconImageCache={},this.nodeTemplates={},this.init=function(){if(null==this.stage)throw new Error("graph can not init");h(this.validChar,"_",0,1,this.licenseKey),this.stage.wheelZoom=this.config.wheelZoom,this.stage.selectBoxColor=this.config.selectBox.color,this.stage.selectBoxAlpha=this.config.selectBox.alpha,null!=this.scene&&(this.scene.childs=null,this.stage.remove(this.scene)),this.scene=new tt(this.stage),this.nodes=[],this.links=[],this.initDrawLinkBase(),this.undoManager=new Qh},this.init()}return uc.prototype.init=function(){this.graphVis.clearAll(),this.layout(),this.graphVis.zoomFit()},uc.prototype.resetOption=function(t){this.option=s(this.option,t,!0,!0),this.init()},uc.prototype.layout=function(){var t={nodes:[],links:[]};"linear"==this.option.type?(t=this.genrateLinear(this.graphData),this.regiestLinearLine()):(t=this.genrateCicular(this.graphData),this.regiestCicularLine()),this.graphVis.addGraph(t)},uc.prototype.genrateCicular=function(t){var a=this.graphVis.getViewCenter(),h=this.option.radius,e=(t.nodes||[]).length,c=2*Math.PI/e,u=[];return(t.nodes||[]).forEach(function(t,e){var e=e*c,n=0,i="Middle_Right",r=0,o=h*Math.cos(e)+a.x,s=h*Math.sin(e)+a.y,r=o>=a.x?(n=180*e/Math.PI,i="Middle_Right",5):(n=180*e/Math.PI-180,i="Middle_Left",-5);u.push(b(b({},t),{},{style:{cx:o,cy:s,rotate:n,textPosition:i,textOffsetX:r,dragable:!1}}))}),{nodes:u,links:t.links}},uc.prototype.genrateLinear=function(t){var n=this.graphVis.getViewSize().height-20,i=this.option.nodePadding,r=this.option.textAngle,o=[];return(t.nodes||[]).forEach(function(t,e){e*=i;o.push(b(b({},t),{},{style:{cx:e,cy:n,rotate:r,textPosition:"Middle_Right",textOffsetX:5,dragable:!1}}))}),{nodes:o,links:t.links}},uc.prototype.regiestCicularLine=function(){var s=this.graphVis.getViewCenter();this.graphVis.definedLinkPaintFunc(function(t){var e=this.source.cx,n=this.source.cy,i=this.target.cx,r=this.target.cy,o={x:s.x,y:s.y};this.path=[],this.quadraticPoints=[e,n,o.x,o.y,i,r],this.pathDefine="M".concat(e," ").concat(n," Q").concat(o.x," ").concat(o.y," ").concat(i," ").concat(r),this.setLineStyle(t),t.stroke(new Path2D(this.pathDefine))})},uc.prototype.regiestLinearLine=function(){this.graphVis.definedLinkPaintFunc(function(t){var e=this.source.cx,n=this.source.cy,i=this.target.cx,r=(this.target.cy,Math.abs(i-e)/2),e=cc(r,{x:(e+i)/2,y:-r}.x,n,Math.PI,2*Math.PI);this.path=[],this.bezierPoints=[e.x0,e.y0,e.x1,e.y1,e.x2,e.y2,e.x3,e.y3],t.beginPath(),t.moveTo(e.x0,e.y0),t.bezierCurveTo(e.x1,e.y1,e.x2,e.y2,e.x3,e.y3),this.setLineStyle(t),t.stroke()})},lc.prototype.init=function(){this.graphVis.clearAll(),this.layout(),this.graphVis.zoomFit()},lc.prototype.resetOption=function(t){this.option=s(this.option,t,!0,!0),this.init()},lc.prototype.layout=function(){var n=(new m.graphlib.Graph).setGraph(this.option).setDefaultEdgeLabel(function(){return{}}),t=("flod"==this.option.pathType?this.regiestFoldLine():this.regiestRoundedPath(),this.graphVis.addNodes(this.graphData.nodes),this.graphVis.nodes||[]),i=new Map,r=(t.forEach(function(t){i.set("".concat(t.id),t),n.setNode("".concat(t.id),{shape:t.shape,width:t.width,height:t.height})}),new Map),t=(this.graphData.links.forEach(function(t){r.set("".concat(t.source,"-").concat(t.target),t),n.setEdge("".concat(t.source),"".concat(t.target),{label:t.label,weight:isNaN(t.weight)?1:t.weight})}),m.layout(n),n.nodes().forEach(function(t){var e=n.node(t),t=i.get(t);t&&(t.cx=e.x,t.cy=e.y)}),n.edges().map(function(t){var e=n.edge(t),t=r.get("".concat(t.v,"-").concat(t.w));return t.style=b(b({},t.style),{},{edgePoints:e.points}),t}));this.graphVis.addEdges(t)},lc.prototype.regiestRoundedPath=function(){var u=this.option.rankdir,l=isNaN(this.option.pathRoundRadius)?10:this.option.pathRoundRadius;this.graphVis.definedLinkPaintFunc(function(t){h=this.source.cx,c=this.source.cy,e=this.target.cx,n=this.target.cy,i=u,r=l,o="M".concat(h," ").concat(c),s={x:h+(e-h)/2,y:c},a={x:h+(e-h)/2,y:n},c!==n&&("TB"==i|"BT"==i&&(s={x:h,y:c+(n-c)/2},a={x:e,y:c+(n-c)/2}),o=(o=o.concat("",pt(h,c,s.x,s.y,a.x,a.y,i,r))).concat("",pt(s.x,s.y,a.x,a.y,e,n,i,r)));var e,n,i,r,o,s,a,h={middlePoint1:s,middlePoint2:a,path:o.concat("","L".concat(e," ").concat(n))},c=h.path;this.path=[{x:this.source.cx,y:this.source.cy},h.middlePoint1,h.middlePoint2,{x:this.target.cx,y:this.target.cy}],this.setLineStyle(t),t.stroke(new Path2D(c))})},lc.prototype.regiestFoldLine=function(){this.graphVis.definedLinkPaintFunc(function(t){this.path=this.edgePoints||[{x:this.source.cx,y:this.source.cy},{x:this.target.cx,y:this.target.cy}];var e,n,i,r,o=this.path.length,o={x:this.path[o-2].x,y:this.path[o-2].y},s={x:this.target.cx,y:this.target.cy},a=s,h=s;this.showArrow&&(e=Math.atan2(o.y-s.y,o.x-s.x),null==(a="rect"==this.target.shape?this.findInsertPoint(this.target,{cx:o.x,cy:o.y}):(i=(this.target.radius+this.target.borderWidth/2)*this.target.scale,n=s.y,r=e,{x:s.x+(i=i)*Math.cos(r),y:n+i*Math.sin(r)}))&&(a=s),n=this.getArrowRadius(),h.x=a.x+n*Math.cos(e),h.y=a.y+n*Math.sin(e)),t.beginPath(),t.moveTo(this.source.cx,this.source.cy);for(var c=1;c<this.path.length-1;c++)t.lineTo(this.path[c].x,this.path[c].y);t.lineTo(h.x,h.y),this.setLineStyle(t),t.stroke(),this.showArrow&&this.paintSpecialArrow(t,{x:o.x,y:o.y},a)})},I.prototype.resetConfig=function(t){this.config=s(this.defaultConfig,t||{},!0,!0),this.defaultNodeColor=this.config.node.color,this.highLightNeiber=this.config.highLightNeiber},I.prototype.initDrawLinkBase=function(){var r=this,t=new kt;t.shape="circle",t.radius=1,t.show=!1,t.alpha=0,r.virNode=t,r.scene.mousemove(function(t){var e,n;r.drawLinkFlag&&(r.virNode.show||(r.virNode.show=!0,r.scene.add(r.virNode)),null==r.virLink&&(e=r.config.link,(n=new wt(r.currentNode,r.virNode)).lineWidth=e.lineWidth,n.showArrow=e.showArrow,n.strokeColor=e.color,n.selectedColor=n.strokeColor,n.lineDash=[3,5,5],r.virLink=n,r.scene.add(r.virLink)),r.virNode.cx=t.x-2,r.virNode.cy=t.y+2)}),r.scene.dbclick(function(t){r.drawLinkFlag=!1,r.virNode.show&&(r.virNode.show=!1,r.scene.remove(r.virNode)),r.virLink&&(r.scene.remove(r.virLink),r.virLink=null)}),r.scene.click(function(t){var e;r.hideAllRightMenu(),null==t.target&&(r.highLightNeiber&&r.restoreHightLight(),e=r.config.scene.noElementClick)&&"function"==typeof e&&e(t,r)}),r.scene.mousewheel(function(t){var e=r.config.scene.mouseWheel;e&&"function"==typeof e&&e(t,r)}),r.scene.keyup(function(t){r.setMouseModel("normal");var e=r.config.scene.keyUp;e&&"function"==typeof e&&e(t,r)}),r.scene.keydown(function(t){"Control"===t.key&&r.setMouseModel("select");var e=r.config.scene.keyDown;e&&"function"==typeof e&&e(t,r)}),r.scene.mousedrag(function(t){var e=r.config.scene.mouseDraging;e&&"function"==typeof e&&e(t,r)}),r.scene.mouseup(function(t){var e,n,i;null==t.target?(r.hideAllRightMenu(),r.currentNode=null,r.currentLink=null,r.currentGroup=null,r.highLightNeiber&&r.restoreHightLight()):"node"==t.target.elementType?(r.currentLink=null,r.currentGroup=null):"group"==t.target.elementType?(r.currentNode=null,r.currentLink=null):(r.currentNode=null,r.currentGroup=null),2==t.button&&null==t.target&&setTimeout(function(){r.showSceneRightMenu(t)},200),this.areaSelect&&((e=r.config.scene.onBoxSelectEndEvent)&&"function"==typeof e?(n=this,setTimeout(function(){e(t,r,n.boxSelectedNodes),n.boxSelectedNodes=null},350)):this.boxSelectedNodes=null),this.dragging&&(this.dragging=!1,i=r.config.scene.mouseDragEnd)&&"function"==typeof i&&i(t,r)})},I.prototype.hideAllRightMenu=function(){this.config.hasOwnProperty("rightMenu")&&(this.config.rightMenu.hasOwnProperty("nodeMenu")&&"function"==typeof this.config.rightMenu.nodeMenu.hide&&this.config.rightMenu.nodeMenu.hide(),this.config.rightMenu.hasOwnProperty("linkMenu")&&"function"==typeof this.config.rightMenu.linkMenu.hide&&this.config.rightMenu.linkMenu.hide(),this.config.rightMenu.hasOwnProperty("groupMenu")&&"function"==typeof this.config.rightMenu.groupMenu.hide&&this.config.rightMenu.groupMenu.hide(),this.config.rightMenu.hasOwnProperty("sceneMenu"))&&"function"==typeof this.config.rightMenu.sceneMenu.hide&&this.config.rightMenu.sceneMenu.hide()},I.prototype.addGraph=function(t){var n,i;null!=t&&(null==this.scene&&this.init(),this.addNodes(t.nodes||[]),this.addEdges(t.links||[]),null!=t.groups)&&(n=new Map,this.nodes.forEach(function(t){n.set(t.id,t)}),i=this,t.groups.forEach(function(t){var e=[];t.childs.forEach(function(t){e.push(n.get(t))}),i.addNodesInGroup(e,{shape:t.shape,padding:t.padding,color:t.fillColor,alpha:t.alpha,smoothPath:t.smoothPath}).id=t.id}))},I.prototype.customStyle=function(t){return t&&"function"==typeof t?t(this.stage.graphics):null},I.prototype.addNodesInGroup=function(t,e){var n=this.createGroup(e);return Array.isArray(t)?t.forEach(function(t){"node"==t.elementType&&n.add(t)}):"node"==t.elementType&&n.add(t),this.refreshView(),n},I.prototype.createGroup=function(t){var n=this,t=t||{},e=new lt(t.label,t.fixed||!1);return e.id=v(12),e.shape=t.shape||"rect",e.x=t.x||10,e.y=t.y||10,e.width=t.width||100,e.height=t.height||100,e.padding=Number(t.padding)||40,e.fillColor=t.color||"10,10,225",e.alpha=t.alpha||.1,e.showHeader=t.showHeader||!1,e.headerHeight=t.headerHeight||40,e.textAlign=t.textAlign||"center",e.headerColor=t.headerColor||"10,10,225",e.headerAlpha=t.headerAlpha||.8,e.borderColor=t.borderColor||"10,10,225",e.borderWidth=Number(t.borderWidth)||1,e.font=t.font||"normal 14px Arial",e.fontColor=t.fontColor||"255,255,255",e.smoothPath=t.smoothPath,e.mouseup(function(t){n.currentGroup=this,2==t.button&&(n.hideAllRightMenu(),n.showGroupRightMenu(t,this))}),e.click(function(t){var e;n.currentGroup=this,n.config.group.hasOwnProperty("onClick")&&"function"==typeof(e=n.config.group.onClick)&&e(t,this)}),e.dbclick(function(t){var e;n.currentGroup=this,n.config.group.hasOwnProperty("ondblClick")&&"function"==typeof(e=n.config.group.ondblClick)&&e(t,this)}),this.scene.add(e),this.clusterGroups.push(e),this.refreshView(),e},I.prototype.removeGroup=function(e){var t,n;"string"==typeof e?0<(t=this.clusterGroups.filter(function(t){return t.id==e})).length&&(e=t[0],-1<(n=this.clusterGroups.indexOf(e)))&&(this.clusterGroups.splice(n,1),this.scene.remove(e)):-1<(n=this.clusterGroups.indexOf(e))&&(this.clusterGroups.splice(n,1),this.scene.remove(e)),e=null,this.refreshView()},I.prototype.removeAllGroup=function(){var e=this;e.clusterGroups.forEach(function(t){e.scene.remove(t)}),e.clusterGroups=[],e.refreshView()},I.prototype.configNodeAttributes=function(t,e){var n,i,r,o,s=this;n=t,r=e,i=s.config.node,n.id=r.id||n.id,n.type=r.type||"default",n.scale=r.scale||Number(1),n.label=r.label||r.id,n.alpha=r.alpha||i.alpha,n.fontColor=r.fontColor||i.label.color,n.textPosition=r.textPosition||i.label.textPosition,n.font=r.font||i.label.font,n.borderColor=r.borderColor||i.borderColor,n.borderWidth=r.borderWidth||i.borderWidth,n.borderRadius=r.borderRadius||i.borderRadius,n.showlabel=r.showlabel||i.label.show,n.nodeWrapText=i.label.nodeWrapText,n.showShadow=r.showShadow||i.selected.showShadow,n.shadowColor=r.shadowColor||i.selected.shadowColor,n.shadowBlur=r.shadowBlur||i.selected.shadowBlur,n.selectedBorderColor=r.selectedBorderColor||i.selected.borderColor,n.selectedBorderWidth=r.selectedBorderWidth||i.selected.borderWidth,n.lineDash=r.lineDash||i.lineDash,n.labelBackGround=r.labelBackGround||i.label.background,n.labelBorderWidth=r.labelBorderWidth||i.label.borderWidth,n.labelBorderColor=r.labelBorderColor||i.label.borderColor,n.textOffsetX=r.textOffsetX||i.label.textOffsetX,n.textOffsetY=r.textOffsetY||i.label.textOffsetY,n.padding=r.padding||i.padding,n.tagColor=r.tagColor||i.tagColor,n.tags=r.tags,n.properties=r.properties||{},r.x&&(n.x=r.x),r.y&&(n.y=r.y),t.weight=1,t.px=t.x,t.py=t.y,s.config.nodeClusters&&s.config.nodeClusters[t.type]?(i=s.config.nodeClusters[t.type],t.fillColor=i.color||s.config.node.color,t.shape=i.shape||s.config.node.shape,t.size=i.size||s.config.node.size,t.font=i.font||s.config.node.label.font,t.fontColor=i.fontColor||s.config.node.label.color,t.borderWidth=i.borderWidth||s.config.node.borderWidth,t.borderColor=i.borderColor||s.config.node.borderColor,t.selectedBorderWidth=i.selectedBorderWidth||s.config.node.selected.borderWidth,t.selectedBorderColor=i.selectedBorderColor||s.config.node.selected.borderColor,t.shadowColor=i.shadowColor||s.config.node.selected.shadowColor,t.textPosition=i.textPosition||s.config.node.label.textPosition,t.tagColor=i.tagColor||s.config.node.tagColor,t.padding=i.padding||s.config.node.padding,i.icon&&(o=i.icon,t.icon=o,t.setImage(null==(n=s.iconImageCache[o])?void 0:n.image),t.imageOffsetX=0|i.imageOffsetX,t.imageOffsetY=0|i.imageOffsetY),i.image&&(t.imageUrl=i.image,t.setImage(i.image,function(){s.refreshView()}))):(t.fillColor=e.color||e.fillColor||this.defaultNodeColor,t.shape=e.shape||s.config.node.shape||"circle",t.size=e.size||s.config.node.size||40),"rect"==t.shape&&(t.width=e.width||s.config.node.width||t.size||40,t.height=e.height||s.config.node.height||t.size||40),t.imageUrl=e.image,t.setImage(e.image,function(){s.refreshView()}),e.style&&(e.style.icon&&(o=e.style.icon,t.icon=o,t.setImage(null==(r=s.iconImageCache[o])?void 0:r.image),t.imageOffsetX=0|e.style.imageOffsetX,t.imageOffsetY=0|e.style.imageOffsetY),e.style.image&&(t.imageUrl=e.style.image,t.setImage(t.imageUrl,function(){s.refreshView()}),delete e.style.image),t=Object.assign(t,e.style)),null!=s.defindPaintFuncCache.nodePaintFunc&&(t.definedPaintFunc=s.defindPaintFuncCache.nodePaintFunc),null!=s.defindPaintFuncCache.nodeInBoundFunc&&(t.isInBound=s.defindPaintFuncCache.nodeInBoundFunc),s.refreshView()},I.prototype.resetNodeAttributes=function(t,e){var n;null!=t&&null!=e&&(n=this,Object.assign(t,e),t.setImage(e.image,function(){n.refreshView()}),n.refreshView())},I.prototype.registNodeTemplates=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];t instanceof Array&&(e=this,t.forEach(function(t){e.nodeTemplates[t.name]=t})),h(this.validChar,"_",0,1,this.licenseKey)},I.prototype.newNode=function(t){var e,n=this,i=null;return"custome"==t.nodeType&&(e=n.nodeTemplates[t.shape])?(i=new Mt(e),e=b(b({},t.style),e.mainShape),i.customeShape=t.shape,i.drawFinished=function(){n.refreshView()},t.style=e):i=new kt,i.x=null==t.x?Math.round(Math.random()*this.stage.width):t.x,i.y=null==t.y?Math.round(Math.random()*this.stage.height):t.y,null==t.id&&(t.id=v(12)),n.configNodeAttributes(i,t),i.click(function(t){var e;n.currentNode=this,n.drawLinkFlag&&null!=n.virLink&&(e=n.newEdge(n.virLink.source,this,{color:n.config.link.color}),n.virNode.show&&(n.virNode.show=!1,n.scene.remove(n.virNode)),n.drawLinkFlag=!1,n.virLink&&(n.scene.remove(n.virLink),n.virLink=null),n.drawLineCallback)&&"function"==typeof n.drawLineCallback&&n.drawLineCallback(e),n.highLightNeiber&&(n.restoreHightLight(),n.highLightNeiberNodes(this,.1)),n.config.node.hasOwnProperty("onClick")&&"function"==typeof(e=n.config.node.onClick)&&e(t,this)}),i.dbclick(function(t){var e;this.fixed=!this.fixed,n.config.node.hasOwnProperty("ondblClick")&&"function"==typeof(e=n.config.node.ondblClick)&&e(t,this)}),i.mousedrag(function(t){if(this.fixed=!0,this.px=this.x,this.py=this.y,this.isDragging||1<n.scene.selectedElements.length)return!1;var e;this.isDragging=!0,n.config.node.hasOwnProperty("onMousedrag")&&"function"==typeof(e=n.config.node.onMousedrag)&&e(t,this)}),i.mouseup(function(t){var e;(n.currentNode=this).fixed=!0,this.px=this.x,this.py=this.y,this.isDragging=!1,2==t.button&&(n.hideAllRightMenu(),n.showNodeRightMenu(t,this)),n.config.node.hasOwnProperty("onMouseUp")&&"function"==typeof(e=n.config.node.onMouseUp)&&e(t,this)}),i.mousedown(function(t){var e;(n.currentNode=this).fixed=!0,this.px=this.x,this.py=this.y,n.config.node.hasOwnProperty("onMouseDown")&&"function"==typeof(e=n.config.node.onMouseDown)&&e(t,this)}),i.mouseover(function(t){var e;n.config.node.hasOwnProperty("onMouseOver")&&"function"==typeof(e=n.config.node.onMouseOver)&&e(t,this)}),i.mouseout(function(t){var e;n.config.node.hasOwnProperty("onMouseOut")&&"function"==typeof(e=n.config.node.onMouseOut)&&e(t,this)}),n.scene.add(i),n.nodes.push(i),i},I.prototype.refreshView=function(){this.stage&&(this.stage.needRepaint=!0),h(this.validChar,"_",0,1,this.licenseKey)},I.prototype.highLightNeiberNodes=function(t,e){this.nodes.forEach(function(t){t.t_alpha=t.alpha,t.alpha=e||.1}),t.alpha=t.t_alpha,(t.inLinks||[]).forEach(function(t){t.source.visible&&(t.source.alpha=t.source.t_alpha)}),(t.outLinks||[]).forEach(function(t){t.target.visible&&(t.target.alpha=t.target.t_alpha)}),this.showLinkFlag&&(this.links.forEach(function(t){t.visible=!1}),(t.inLinks||[]).forEach(function(t){t.source.visible&&(t.visible=!0)}),(t.outLinks||[]).forEach(function(t){t.target.visible&&(t.visible=!0)}))},I.prototype.restoreHightLight=function(){this.nodes.forEach(function(t){t.alpha=t.t_alpha||t.alpha}),this.showLinkFlag&&this.links.forEach(function(t){t.source.visible&&t.target.visible&&(t.visible=!0)})},I.prototype.lockNode=function(t){t&&null!=t&&(t.fixed=!0,t.dragable=!1)},I.prototype.unLockNode=function(t){t&&null!=t&&(t.fixed=!1,t.dragable=!0)},I.prototype.showNodeRightMenu=function(t,e){this.config.hasOwnProperty("rightMenu")&&this.config.rightMenu.hasOwnProperty("nodeMenu")&&"function"==typeof this.config.rightMenu.nodeMenu.show&&this.config.rightMenu.nodeMenu.show(t,this,e)},I.prototype.showLinkRightMenu=function(t,e){this.config.hasOwnProperty("rightMenu")&&this.config.rightMenu.hasOwnProperty("linkMenu")&&"function"==typeof this.config.rightMenu.linkMenu.show&&this.config.rightMenu.linkMenu.show(t,this,e)},I.prototype.showGroupRightMenu=function(t,e){this.config.hasOwnProperty("rightMenu")&&this.config.rightMenu.hasOwnProperty("groupMenu")&&"function"==typeof this.config.rightMenu.groupMenu.show&&this.config.rightMenu.groupMenu.show(t,this,e)},I.prototype.showSceneRightMenu=function(t){this.config.hasOwnProperty("rightMenu")&&this.config.rightMenu.hasOwnProperty("sceneMenu")&&"function"==typeof this.config.rightMenu.sceneMenu.show&&this.config.rightMenu.sceneMenu.show(t,this)},I.prototype.configEdgeAttributes=function(t,e){var n,i,r;null!=t&&null!=e&&(n=t,i=e,r=this.config.link,n.id=i.id||n.id,n.type=i.type||"default",n.label=i.label,n.showlabel=i.showlabel||r.label.show,n.lineWidth=Number(i.lineWidth)||r.lineWidth,n.strokeColor=i.color||i.strokeColor||r.color,n.lineType=i.lineType||r.lineType,n.lineDash=i.lineDash||r.lineDash,n.font=i.font||r.label.font,n.fontColor=i.fontColor||r.label.color,n.arrowType=i.arrowType||r.arrowType,n.alpha=i.alpha||r.alpha,n.selectedColor=i.selectedColor||r.selected.color,n.colorType=i.colorType||r.colorType,n.labelBackGround=i.labelBackGround||r.label.background,n.labelBorderWidth=i.labelBorderWidth||r.label.borderWidth,n.labelBorderColor=i.labelBorderColor||r.label.borderColor,n.labelBorderRadius=i.labelBorderRadius||r.label.borderRadius,n.showArrow=i.showArrow||r.showArrow,n.multiControlPercent=i.multiControlPercent||.2,n.parallelType=i.parallelType||"curve",n.background=i.background,n.weight=i.weight?Number(i.weight):1,n.visible=i.visible||!0,n.properties=i.properties||{},this.config.linkClusters&&this.config.linkClusters[t.type]&&(r=this.config.linkClusters[t.type],t.strokeColor=r.color||this.config.link.color,t.lineWidth=r.lineWidth||this.config.link.lineWidth,t.lineType=r.lineType||this.config.link.lineType,t.lineDash=r.lineDash||this.config.link.lineDash,t.selectedColor=r.selectedColor||this.config.link.selected.color,t.font=r.font||this.config.link.label.font,t.fontColor=r.fontColor||this.config.link.label.color,t.showArrow=r.showArrow||this.config.link.showArrow,t.labelBackGround=r.labelBackGround||this.config.link.label.background),e.style&&Object.assign(t,e.style),null!=this.defindPaintFuncCache.linePaintFunc&&(t.definedPaintFunc=this.defindPaintFuncCache.linePaintFunc),null!=this.defindPaintFuncCache.linkInBoundFunc&&(t.isInBound=this.defindPaintFuncCache.linkInBoundFunc),this.refreshView())},I.prototype.resetEdgeAttributes=function(t,e){null!=t&&null!=e&&(Object.assign(t,e),this.refreshView())},I.prototype.newEdge=function(t,e,n){var i;if(null!=t&&null!=e&&null!=n)return i=this,null==n.id&&(n.id=v(15)),t=new wt(t,e,n.label),i.configEdgeAttributes(t,n),t.click(function(t){var e;i.config.link.hasOwnProperty("onClick")&&"function"==typeof(e=i.config.link.onClick)&&e(t,this)}),t.dbclick(function(t){var e;i.config.link.hasOwnProperty("ondblClick")&&"function"==typeof(e=i.config.link.ondblClick)&&e(t,this)}),t.mousedown(function(t){var e;i.config.link.hasOwnProperty("onMouseDown")&&"function"==typeof(e=i.config.link.onMouseDown)&&e(t,this)}),t.mouseup(function(t){var e;i.currentLink=this,2==t.button&&(i.hideAllRightMenu(),i.showLinkRightMenu(t,this)),i.config.link.hasOwnProperty("onMouseUp")&&"function"==typeof(e=i.config.link.onMouseUp)&&e(t,this)}),t.mouseover(function(t){var e;i.config.link.hasOwnProperty("onMouseOver")&&"function"==typeof(e=i.config.link.onMouseOver)&&e(t,this)}),t.mouseout(function(t){var e;i.config.link.hasOwnProperty("onMouseOut")&&"function"==typeof(e=i.config.link.onMouseOut)&&e(t,this)}),i.scene.add(t),i.links.push(t),t},I.prototype.addNodes=function(t){var e,n,i,r;return t instanceof Array&&0!=t.length?(e=this,n=new Map,e.nodes.forEach(function(t){n.set(t.id,t)}),i=[],r=null,t.forEach(function(t){null==n.get(t.id)&&(r=e.newNode(t),i.push(r))}),e.refreshView(),i):[]},I.prototype.addNode=function(t){t=this.addNodes([t]);return 0<t.length?t[0]:null},I.prototype.addEdges=function(t){var e,n,i,r,o,s,a;return t instanceof Array&&0!=t.length?(e=this,n=new Map,e.links.forEach(function(t){t.id||(t.id=v(10)),n.set(t.id,t)}),i=new Map,e.nodes.forEach(function(t){i.set(t.id,t)}),r=[],a=s=o=null,t.forEach(function(t){t.id||(t.id=v(10)),null==n.get(t.id)&&(o=i.get(t.source),s=i.get(t.target),null!=o)&&null!=s&&(a=e.newEdge(o,s,t),r.push(a))}),e.refreshView(),r):[]},I.prototype.addEdge=function(t){t=this.addEdges([t]);return 0<t.length?t[0]:null},I.prototype.getGraphData=function(){return{nodes:this.nodes,links:this.links}},I.prototype.getVisibleData=function(){return{nodes:this.nodes.filter(function(t){return 1==t.visible}),links:this.links.filter(function(t){return 1==t.source.visible&&1==t.target.visible})}},I.prototype.setZoomRange=function(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[.1,10];e instanceof Array&&2==e.length&&(t=Number(e[0])||.1)<(e=Number(e[1])||10)&&(this.scene.scaleRange=[t,e])},I.prototype.getBounds=function(){return this.scene.getElementsBound()},I.prototype.moveCenter=function(t){t&&(this.scene.scale=t<=0?.1:t),this.scene.translateToCenter(),this.refreshView()},I.prototype.moveNodeToCenter=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=this;null!=e&&0<Number(e)?n.createBaseAnimate({targets:n.scene,duration:e,easing:"linear",translateX:-t.x+n.stage.width/2,translateY:-t.y+n.stage.height/2,begin:function(t){n.switchAnimate(!0)}}).finished.then(function(){n.switchAnimate(!1)}):(n.scene.setCenter(t.x,t.y),n.refreshView())},I.prototype.resize=function(){this.stage.resize(),h(this.validChar,"_",0,1,this.licenseKey)},I.prototype.setMouseModel=function(t,e){"drag"==t?this.stage.mode="drag":"select"==t?(this.stage.mode="select",e&&-1!=["rect","lasso","circle"].indexOf(e)&&(this.scene.selectBoxType=e)):this.stage.mode="normal"},I.prototype.saveImage=function(t){null==t&&(t={}),1<arguments.length&&void 0!==arguments[1]&&!arguments[1]||(t=s({width:6e3,height:6e3,type:"png",fileName:"GraphVis图谱图片",background:"#fff",textWatermark:{content:"GraphVis图谱可视化",angle:-30,alpha:.1,fontStyle:"normal",fontSize:60,fontFamliy:"Arial",fontColor:"#666"}},t)),this.stage.saveAsLocalImage(t),h(this.validChar,"_",0,1,this.licenseKey)},I.prototype.getSnapshotImage=function(){return h(this.validChar,"_",0,1,this.licenseKey),this.stage.getSnapshotImage()},I.prototype.serialized=function(){var t=["shape","size","font","fillColor","fontColor","borderWidth","borderColor","selectedBorderColor","selectedBorderWidth","shadowColor","shadowBlur","height","width","textPosition","textOffsetX","textOffsetY","labelBackGround","labelBorderWidth","labelBorderColor","tags","tagColor","x","y","scale"],i=[],r=null,o=(this.nodes.forEach(function(e){r={id:e.id,label:e.label,type:e.type,nodeType:e.nodeType,shape:e.customeShape,properties:e.properties,style:{}};var n;t.forEach(function(t){(n=e[t])&&(r.style[t]=n)}),e.imageUrl&&(r.style.image=e.imageUrl),i.push(r)}),["lineType","lineWidth","font","fontColor","strokeColor","selectedColor","background","labelBackGround","lineDash"]),s=[],a=null,e=(this.links.forEach(function(e){a={id:e.id,label:e.label,type:e.type,source:e.source.id,target:e.target.id,weight:e.weight,properties:e.properties,style:{}};var n;o.forEach(function(t){(n=e[t])&&(a.style[t]=n)}),s.push(a)}),this.clusterGroups.map(function(t){return{id:t.id,shape:t.shape,fillColor:t.fillColor,padding:t.padding,alpha:t.alpha,smoothPath:t.smoothPath,childs:t.childs.map(function(t){return t.id})}}));return h(this.validChar,"_",0,1,this.licenseKey),{nodes:i,links:s,groups:e}},I.prototype.exportJsonFile=function(t){var e=JSON.stringify(this.serialized()),t=(t||"graphdata")+".json",e=new Blob([e],{type:"text/json"}),n=document.createElement("a"),i=new MouseEvent("click");n.download=t,n.href=window.URL.createObjectURL(e),n.dataset.downloadurl=["text/json",n.download,n.href].join(":"),n.dispatchEvent(i)},I.prototype.hideAllLink=function(){this.showLinkFlag=!1,this.links.forEach(function(t){t.visible=!1}),this.refreshView()},I.prototype.showAllLink=function(){this.showLinkFlag=!0,this.links.forEach(function(t){t.source.visible&&t.target.visible&&(t.visible=!0)}),this.refreshView()},I.prototype.onlyShowSelectLink=function(){this.links.forEach(function(t){t.selected?t.visible=!0:t.visible=!1}),this.refreshView()},I.prototype.showAllNode=function(){this.nodes.forEach(function(t){t.alpha=1,t.visible=!0}),this.refreshView()},I.prototype.applyNodeSize=function(e){var n=this,i=new Set,t=(n.nodes.forEach(function(t){t.degree=(t.outLinks||[]).length+(t.inLinks||[]).length,i.add(t.degree)}),Array.from(i).sort()),r=[t[0],t[t.length-1]];n.nodes.forEach(function(t){t.scale=n.numScale(e,r,t.degree)}),this.refreshView()},I.prototype.applyLinkWeight=function(e){var n=this,i=new Set,t=(n.links.forEach(function(t){i.add(t.weight)}),Array.from(i).sort()),r=[t[0],t[t.length-1]];n.links.forEach(function(t){t.lineWidth=Math.round(n.numScale(e,r,t.weight))}),this.refreshView()},I.prototype.numScale=function(t,e,n){n=((n-e[0])*(t[1]-t[0])/(e[1]-e[0])+t[0]).toFixed(1);return isNaN(n)?1:n},I.prototype.selectedAllNodes=function(){var e=this;this.nodes.forEach(function(t){t.selected=!0,e.scene.addToSelected(t)}),this.refreshView()},I.prototype.cancelAllSelected=function(){this.scene.cancleAllSelected(),this.refreshView()},I.prototype.removeFromSelected=function(t){t&&(this.scene.removeFromSelected(t),this.refreshView())},I.prototype.reverseSelectNodes=function(){var e=this;this.nodes.forEach(function(t){t.selected?(t.selected=!1,e.scene.removeFromSelected(t)):(t.selected=!0,e.scene.addToSelected(t))}),this.refreshView()},I.prototype.selectedNeighbers=function(t){t=t||this.currentNode;if(null==t)return!1;var e=t.inLinks||[],t=t.outLinks||[],n=[];e.forEach(function(t){n.push(t.source)}),t.forEach(function(t){n.push(t.target)}),this.addToSelectedElements(n)},I.prototype.onlyShowSelectedNode=function(){this.nodes.forEach(function(t){t.selected||(t.visible=!1)}),this.refreshView()},I.prototype.hideSelectedNode=function(){this.nodes.forEach(function(t){t.selected&&(t.visible=!1)}),this.refreshView()},I.prototype.hideIsolatedNodes=function(){this.nodes.forEach(function(t){0==(t.inLinks||[]).length&&0==(t.outLinks||[]).length&&(t.visible=!1)}),this.refreshView()},I.prototype.deleteNodes=function(t){var e,n,i;t instanceof Array&&0!=t.length&&(e=this,n=[],i=-1,t.forEach(function(t){(t.inLinks||[]).forEach(function(t){n.push(t)}),(t.outLinks||[]).forEach(function(t){n.push(t)}),-1<(i=e.nodes.indexOf(t))&&(e.nodes.splice(i,1),e.scene.remove(t))}),n.forEach(function(t){-1<(i=e.links.indexOf(t))&&(e.links.splice(i,1),e.scene.remove(t))}),this.undoManager.todo("node:remove",t.concat(n)),this.refreshView())},I.prototype.deleteNode=function(t){t&&this.deleteNodes([t])},I.prototype.deleteLinks=function(t){var n;t instanceof Array&&0!=t.length&&(n=this,t.forEach(function(t){var e=n.links.indexOf(t);-1<e&&(n.links.splice(e,1),n.scene.remove(t))}),this.undoManager.todo("link:remove",t),this.refreshView())},I.prototype.deleteLink=function(t){t&&this.deleteLinks([t])},I.prototype.removeCurrentLink=function(){this.deleteLink(this.currentLink),this.currentLink=null},I.prototype.scaleGraph=function(i){var r=0,o=0;this.nodes.forEach(function(t){r+=t.x,o+=t.y}),r/=this.nodes.length,o/=this.nodes.length,r=Math.round(r),o=Math.round(o),this.nodes.forEach(function(t){var e=(t.x-r)*i,n=(t.y-o)*i;t.x=r+e,t.y=o+n}),this.refreshView()},I.prototype.rotateGraph=function(t){var i=Math.sin(-t*Math.PI/180),r=Math.cos(-t*Math.PI/180),o=0,s=0;this.nodes.forEach(function(t){o+=t.cx,s+=t.cy}),o/=this.nodes.length,s/=this.nodes.length,o=Math.round(o),s=Math.round(s),this.nodes.forEach(function(t){var e=t.cx-o,n=t.cy-s;t.cx=o+e*r-n*i,t.cy=s+n*r+e*i}),this.refreshView()},I.prototype.selectedEdge=function(t){t&&(t.selected=!0,this.scene.addToSelected(t),t.target.selected=!0,this.scene.addToSelected(t.target),t.source.selected=!0,this.scene.addToSelected(t.source))},I.prototype.getMouseDownPosition=function(){return{x:this.scene.mouseDownX,y:this.scene.mouseDownY}},I.prototype.covertPagePosition=function(t,e){return 2!=arguments.length?{pageX:0,pageY:0}:this.stage.getPagePosition(t,e)},I.prototype.convertScenePosition=function(t){var e=null;return t.pageX?e=n(t):((e=n(t)).pageX=t.clientX+document.body.scrollLeft-document.body.clientLeft,e.pageY=t.clientY+document.body.scrollTop-document.body.clientTop),{x:e.x,y:e.y};function n(t){var e,n={};for(e in t)"returnValue"!=e&&"keyLocation"!=e&&(n[e]=t[e]);return n}},I.prototype.addNodeForDrag=function(e,n){var i=this;i.stage.removeEventListener("mousemove"),i.stage.mousemove(function(t){t=i.scene.toSceneEvent(t),i.stage.removeEventListener("mousemove"),e.id=null==e.id?v(12):e.id,e.x=t.x,e.y=t.y,t=i.newNode(e);t.fixed=!0,i.refreshView(),n&&"function"==typeof n&&n(t)})},I.prototype.removeSelectNodes=function(){var t=this.nodes.filter(function(t){return t.selected});this.deleteNodes(t)},I.prototype.clearAll=function(){this.scene&&this.scene.clear(),this.nodes=[],this.links=[],this.currentNode=null,this.currentLink=null,this.currentCluster=null,this.currentLayout=null,this.clusterGroups=[],this.drawLinkFlag=!1,this.virLink=null,this.undoManager.clearAll(),this.zoomOriginal(),this.refreshView()},I.prototype.setZoom=function(t){switch(t){case"zoomOut":this.zoomOut();break;case"zoomIn":this.zoomIn();break;case"zoom1":this.zoomOriginal();break;default:this.zoomFit()}},I.prototype.zoomOut=function(){this.stage.zoomOut(),this.refreshView()},I.prototype.zoomIn=function(){this.stage.zoomIn(),this.refreshView()},I.prototype.zoomFit=function(){this.stage.centerAndZoom(),this.refreshView()},I.prototype.zoomOriginal=function(){this.stage.centerAndZoom(),this.scene.scale=1,this.refreshView()},I.prototype.getZoomRatio=function(){return this.scene.scale},I.prototype.destroy=function(){this.clearAll(),this.scene.removeAllEventListener(),this.stage.removeAllEventListener()},I.prototype.beginAddLine=function(t){this.drawLinkFlag=!0,t&&"function"==typeof t&&(this.drawLineCallback=t)},I.prototype.getSelectedNodes=function(){return this.nodes.filter(function(t){return 1==t.selected})},I.prototype.findNodesByAttr=function(e,n){return this.nodes.filter(function(t){return t[e]==n})},I.prototype.findNodeById=function(e){var t=this.nodes.filter(function(t){return t.id==e});return 0<t.length?((t=t[0]).visible=!0,t):null},I.prototype.getNodes=function(){return this.nodes||[]},I.prototype.getEdges=function(){return this.links||[]},I.prototype.getNodeById=function(e){return this.nodes.filter(function(t){return t.id==e})[0]},I.prototype.getEdgeById=function(e){return this.links.filter(function(t){return t.id==e})[0]},I.prototype.switchAnimate=function(t){this.stage.fps=t?50:-50},I.prototype.setStaticMode=function(t){this.stage.staticMode=t},I.prototype.setSmoothWheelMode=function(t){this.stage.smoothWheelMode=Boolean(t)},I.prototype.setShowDetailScale=function(){this.stage.showDetailScale=Number(0<arguments.length&&void 0!==arguments[0]?arguments[0]:.2)||.2,h(this.validChar,"_",0,1,this.licenseKey)},I.prototype.setDragHideLine=function(t){this.stage.openDragHideEffect=Boolean(t),h(this.validChar,"_",0,1,this.licenseKey)},I.prototype.updateThumbnail=function(){this.stage.thumbnail.visible&&this.stage.thumbnail.update()},I.prototype.showThumbnail=function(t){t?this.stage.thumbnail.show():this.stage.thumbnail.destroy()},I.prototype.randomColor=function(){return Math.floor(255*Math.random())+","+Math.floor(200*Math.random())+","+Math.floor(255*Math.random())},I.prototype.buildVisualGraphData=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=new Map,r=(t.forEach(function(t){t.scale=1,t.radius=t.radius||30,t.x=t.x||Math.round(1e3*Math.random()),t.y=t.y||Math.round(1e3*Math.random()),t.cx=t.x,t.cy=t.y,t.selected=t.selected||!1,i.set(t.id,t)}),[]),o=(e.forEach(function(t){var e=i.get(t.source),n=i.get(t.target);e&&(e.outLinks=e.outLinks||[],e.outLinks.push({source:e,target:n})),n&&(n.inLinks=n.inLinks||[],n.inLinks.push({source:e,target:n})),null!=n&&null!=e&&r.push({id:t.id||"".concat(t.source,"-").concat(t.target),source:e,target:n})}),[]);return i.forEach(function(t,e){o.push(t)}),n&&(t=this.getViewCenter(),this.preGroupLayout(o,t)),{nodes:o,links:r}},I.prototype.preResetNodeCoords=function(t){var n,i,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[100,100],r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:80,o=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],t=[].concat(t),s=(t.sort(function(t,e){return(e.inLinks||[]).length+(e.outLinks||[]).length-((t.inLinks||[]).length+(t.outLinks||[]).length)}),Math.PI*(3-Math.sqrt(5))),a=e[0],h=e[1];t.forEach(function(t,e){n=r*Math.sqrt(e+=.5),i=s*e,0==e?(t=a,(t=h).fixed=!0):(t.x=a+n*Math.cos(i),t.y=h+n*Math.sin(i))}),o&&this.moveCenter(this.scene.scaleRange[0])},I.prototype.showLoadProcess=function(){this.stage.showLoading(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Loading",1<arguments.length&&void 0!==arguments[1]?arguments[1]:.1),h(this.validChar,"_",0,1,this.licenseKey)},I.prototype.hideLoadProcess=function(){this.stage.hideLoading()},I.prototype.getViewCenter=function(){return{x:this.stage.width/2-this.scene.translateX,y:this.stage.height/2-this.scene.translateY}},I.prototype.setSceneDragAble=function(){this.scene.dragable=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],h(this.validChar,"_",0,1,this.licenseKey)},I.prototype.excuteLocalLayout=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"fastForce",e=1<arguments.length?arguments[1]:void 0,n=2<arguments.length?arguments[2]:void 0,i=3<arguments.length&&void 0!==arguments[3]&&arguments[3],r=this,o=(h(this.validChar,"_",0,1,this.licenseKey),new Oa(t)),s={nodes:this.nodes,links:this.links},t=(i&&(s=r.getVisibleData()),-1!=["fastForce","kawakai","hierarchical","simulation"].indexOf(t)?(s.nodes.forEach(function(t){t.fixed=!1}),o.addData(s.nodes,this.edgeCut(s.links))):"radialTree"==t?(i=r.miniSpanningTree(),o.addData(s.nodes,i)):o.addData(s.nodes,s.links),r.getViewCenter());(e=e||{}).center=[t.x,t.y],o.resetConfig(e),function t(){cancelAnimationFrame(r.layoutLoopName),o.finished?"function"==typeof n&&n():(o.excute(),r.refreshView(),r.layoutLoopName=requestAnimationFrame(t))}()},I.prototype.stopLayout=function(){cancelAnimationFrame(this.layoutLoopName)},I.prototype.edgeCut=function(t){var e,n,i={},r=[];return t.forEach(function(t){t.source.id!=t.target.id&&(e="".concat(t.source.id,"-").concat(t.target.id),n="".concat(t.target.id,"-").concat(t.source.id),i[e]&&i[n]||(r.push(t),i[e]=!0,i[n]=!0))}),r},I.prototype.excuteWorkerLayout=function(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"fastForce",i=2<arguments.length?arguments[2]:void 0,r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],o=4<arguments.length?arguments[4]:void 0;h(this.validChar,"_",0,1,this.licenseKey),cancelAnimationFrame(this.layoutLoopName),"dagre"!=n&&"radial"!=n?(e=[0,0],e=null!=i&&i.center||this.getViewCenter(),r&&this.preGroupLayout(t.nodes,{x:e.x,y:e.y}),Aa(this,t,e,n,i,o)):this.excuteLocalLayout(n,i,o)},I.prototype.preGroupLayout=function(t,o){var s,e=[],n=[],a=(t.forEach(function(t){t.readFlag=!1,t.degree=(t.inLinks||[]).length+(t.outLinks||[]).length,1<t.degree?n.push(t):0==t.degree&&e.push(t)}),n.sort(function(t,e){return t.degree-e.degree}),2*Math.PI*(3-Math.sqrt(6)));n.forEach(function(i,t){var e=[],n=((i.outLinks||[]).forEach(function(t){t.target.readFlag||e.push(t.target)}),(i.inLinks||[]).forEach(function(t){t.source.readFlag||e.push(t.source)}),t*a),r=0==e.length?50:200;t%2==0&&(r=-r),r=(100*Math.random()+r)*Math.sqrt(.2+t),i.x=o.x+Math.round(Math.random()*r)*Math.cos(n),i.y=o.y+Math.round(Math.random()*r)*Math.sin(n),i.readFlag=!0,s=2*i.radius,e.forEach(function(t,e){var e=e+12,n=s*Math.sqrt(.5+e),e=e*a;t.readFlag=!0,t.x=i.x+n*Math.cos(e),t.y=i.y+n*Math.sin(e)})}),e.forEach(function(t,e){var n=e*a,e=e%2==0?-500:500;t.x=o.x+Math.round(Math.random()*e)*Math.cos(n),t.y=o.y+Math.round(Math.random()*e)*Math.sin(n)})},I.prototype.clusterGroupLayout=function(){var s=this,a=0,h=s.clusterGroups,c=new Map,u=(h.forEach(function(e){var t=e.childs,n={nodes:t,links:s.getConnectLinkOfNodes(t)};s.excuteWorkerLayout(n,"fastForce",null,!1,function(){a++}),t.forEach(function(t){c.set(t.id,e.id)})}),setInterval(function(){var e,n,i,t,r,o;h.length==a&&(clearInterval(u),s.zoomFit(),i=new Map,t=s.clusterGroups.map(function(t,e){return i.set(t.id,t),{id:t.id,x:t.outerCircleCenter.x,y:t.outerCircleCenter.y,cx:t.outerCircleCenter.x,cy:t.outerCircleCenter.y,scale:1,radius:t.outerCircleRadius}}),r=new Set,s.links.forEach(function(t){e=c.get(t.source.id),n=c.get(t.target.id),e!=n&&r.add({source:e,target:n})}),o={nodes:t,links:Array.from(r)},s.excuteWorkerLayout(o,"fastForce",{noverlap:!0,charge:50},!1,function(){o.nodes.forEach(function(t){i.get(t.id).setLocation(t.cx,t.cy)}),s.zoomFit()}))},1e3))},I.prototype.activeAddData=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"fastForce",i=3<arguments.length?arguments[3]:void 0,r=4<arguments.length?arguments[4]:void 0;h(this.validChar,"_",0,1,this.licenseKey),new C(this,i).activeAddData(t,e,n,i,this.nodes.length,r)},I.prototype.findShortestPath=function(t,e){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],t=function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3],r=4<arguments.length?arguments[4]:void 0,t=("string"==typeof e&&(e=Ba(t,e)),"string"==typeof n&&(n=Ba(t,n)),Ia(t,e.id,i,r)),e=t.length,i=t.path;return{length:e[n.id],path:i[n.id]}}(this,t,e,n,"weight"),e=[];return 0<t.length&&(t=t.path,e=this.parsePathFromNodes(t,n)),e},I.prototype.findAllPath=function(t,e){var n,i,r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],t=function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if((e="string"==typeof e?Ba(t,e):e)===(n="string"==typeof n?Ba(t,n):n))return[[e.id]];var r=[e],o=z({},e.id,!0),s=[],a=[],h=i?Da(e,"target"):Da(e);for(s.push(h);0<r.length&&0<s.length;){var c=s[s.length-1];c.length?((c=c.shift())&&(r.push(c),o[c.id]=!0,h=i?Da(c,"target"):Da(c),s.push(h.filter(function(t){return!o[t.id]}))),r[r.length-1]===n&&(c=r.map(function(t){return t.id}),a.push(c),c=r.pop(),o[c.id]=!1,s.pop())):(c=r.pop(),o[c.id]=!1,s.pop())}return a}(this,t,e,r);return 0==t.length?new Array(0):(n=this,i=[],t.forEach(function(t){i.push(n.parsePathFromNodes(t,r))}),i)},I.prototype.findCommonNeighbors=function(){var t,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],r=[];return i.forEach(function(e){var n=(e.outLinks||[]).map(function(t){return t.target})||[];(e.inLinks||[]).forEach(function(t){n.push(t.source)}),i.forEach(function(t){e!=t&&((t.outLinks||[]).forEach(function(t){-1!=n.indexOf(t.target)&&r.push(t.target)}),(t.inLinks||[]).forEach(function(t){-1!=n.indexOf(t.source)&&r.push(t.source)}))})}),function(t){if(Array.isArray(t))return V(t)}(t=new Set(r))||function(){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}()||R(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},I.prototype.parsePathFromNodes=function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=[],i=t.length-1,r=0;r<i;r++)n.push(t[r]+"-"+t[r+1]);return e?this.links.filter(function(t){return-1!=n.indexOf(t.source.id+"-"+t.target.id)}):this.links.filter(function(t){return-1!=n.indexOf(t.source.id+"-"+t.target.id)||-1!=n.indexOf(t.target.id+"-"+t.source.id)})},I.prototype.getConnectedComponents=function(){return Ra(this.nodes,0<arguments.length&&void 0!==arguments[0]&&arguments[0])},I.prototype.detecyCycles=function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=new Set,n=[],i=[],r=(this.links.forEach(function(t){t.source.id!=t.target.id&&(n.push(t.source.id),i.push(t.target.id),e.add(t.source.id),e.add(t.target.id))}),Array.from(e));return(t?Xa:Fa)(r,n,i)},I.prototype.findCycles=function(e){var n=new Set,i=[],r=[],t=(this.links.forEach(function(t){t.source.id!=t.target.id&&(i.push(t.source.id),r.push(t.target.id),n.add(t.source.id),n.add(t.target.id))}),Array.from(n)),t=new Ya(t,i,r).getCycles(),o=(t.forEach(function(t){t.push(t[0])}),0<t.length&&null!=e&&(t=t.filter(function(t){return t.includes(e.id)})),this);return t.map(function(t){return o.parsePathFromNodes(t)})},I.prototype.miniSpanningTree=function(){var t=this.nodes,e=this.links,n=(e.sort(function(t,e){return t.weight-e.weight}),[]),i={index:{},parent:[],count:0};t.forEach(function(t){var e;e=i,t=t.id,void 0===e.index[t]&&(e.count+=1,e.index[t]=e.parent.push(-e.count))});for(var r,o=0;o<e.length&&!(i.count<=1);o++){var s=h(i,e[o].source.id),a=h(i,e[o].target.id);s!==a&&0<s&&0<a&&((r=i).parent[a]=s,--r.count,n.push(e[o]))}return n;function h(t,e){var n=t.index[e];if(void 0===n)return-1;for(;0<=n;)e=n,n=t.parent[n];return e}},I.prototype.kruskal=function(){return function(t,e){var t=0<arguments.length&&void 0!==t?t:[],e=1<arguments.length&&void 0!==e?e:[],i=[],r=new Map,n=[];return t.forEach(function(t){r.set(t.id,new tc(t.id))}),(n=[].concat(e)).sort(function(t,e){return t.weight-e.weight}),n.forEach(function(t){var e=t.source.id,n=t.target.id,e=r.get(e),n=r.get(n);e.find()!==n.find()&&(i.push(t),e.union(n))}),i}(this.nodes,this.links)},I.prototype.hdeLayout=function(){var n,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:100;n=new ic(t=(t=t).filter(function(t){return t.degree=(t.inLinks||[]).length+(t.outLinks||[]).length,1<=t.degree}),e),t.forEach(function(t){var e=n.getNodePosition(t.id);t.x=e[0]*i,t.y=e[1]*i})},I.prototype.community=function(t){return function(t,e,n){var e=1<arguments.length&&void 0!==e?e:[],n=2<arguments.length&&void 0!==n?n:[],i=null;if("chineseWhisper"==t)return function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],o=ih(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:[]);0<o.getChangeRate();)o.step();var s=new Map,a=(t.forEach(function(t){s.set(String(t.id),t)}),new Map);return o.forEachCluster(function(t){for(var e=0;e<t.nodes.length;++e){var n=t.nodes[e],i=o.getClass(n),r=a.get(i);null==r?(r=[s.get(String(n))],a.set(i,r)):r.push(s.get(String(n)))}}),a}(e,n);"louvain"==t?i=new ch(e,n):"newman"==t?i=new rh(e,n):"weakCommpent"==t?i=new oh(e,n):"biCommpent"==t?i=new sh(e,n):"kmeans"==t&&(i=new ah(e));n=new Map;return n=i?i.applay():n}(t,this.nodes,this.links)},I.prototype.centrality=function(){return new Za(this.nodes,this.links)},I.prototype.findNLevelRelations=function(t){var s,a,h,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return null==t||c<1?[t]:(s=[],a={},h=[],null!=t&&(h.push(t),function e(t,n){var i,r,o;1<n?(c==n&&-1==s.indexOf(t)&&s.push(t),i=c-n,r=t.inLinks||[],o=t.outLinks||[],r.forEach(function(t){-1==s.indexOf(t.source)&&(s.push(t.source),null==a[i]&&(a[i]=[]),a[i].push(t.source))}),o.forEach(function(t){-1==s.indexOf(t.target)&&(s.push(t.target),null==a[i]&&(a[i]=[]),a[i].push(t.target))}),null!=a[i]&&a[i].forEach(function(t){e(t,n-1)})):1==n&&(r=t.inLinks||[],o=t.outLinks||[],r.forEach(function(t){-1==s.indexOf(t.source)&&h.push(t.source)}),o.forEach(function(t){-1==s.indexOf(t.target)&&h.push(t.target)}))}(t,c)),h)},I.prototype.addToSelectedElements=function(){var e=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t){t.selected=!0,e.scene.addToSelected(t)}),e.refreshView()},I.prototype.createBaseAnimate=function(){return _(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},I.prototype.createTimelineAnimate=function(){return _.timeline(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},I.prototype.registEventListener=function(t,e,n){null!=t&&null!=e&&null!=n&&(h(this.validChar,"_",0,1,this.licenseKey),e=$h[t][e])&&"function"==typeof n&&(this.config[t][e]=n)},I.prototype.removeEventListener=function(t,e){null!=t&&null!=e&&(e=$h[t][e])&&delete this.config[t][e]},I.prototype.removeAllEventListener=function(t){if(null!=t){var e=this.config[t];if(e)for(var n in e)delete e[n]}},I.prototype.registRightMenu=function(t,e){-1!=["scene","node","link","group"].indexOf(t)&&(h(this.validChar,"_",0,1,this.licenseKey),(e=e||{}).hasOwnProperty("show"))&&"function"==typeof e.show&&e.hasOwnProperty("hide")&&"function"==typeof e.hide&&(this.config.hasOwnProperty("rightMenu")||(this.config.rightMenu={}),this.config.rightMenu["".concat(t,"Menu")]=e)},I.prototype.reConfigNodeCluster=function(e){var n,i;e&&"object"==Ft(e)&&(h(this.validChar,"_",0,1,this.licenseKey),(n=this).config.nodeClusters=e,i=null,n.nodes.forEach(function(t){(i=e[t.type])&&(t.fillColor=i.color||n.config.node.color,t.shape=i.shape||n.config.node.shape,t.size=i.size||n.config.node.size,t.font=i.font||n.config.node.label.font,t.fontColorfontColor=i.fontColor||n.config.node.label.color,t.borderWidth=i.borderWidth||n.config.node.borderWidth,t.borderColor=i.borderColor||n.config.node.borderColor,t.selectedBorderWidth=i.selectedBorderWidth||n.config.node.selected.borderWidth,t.selectedBorderColor=i.selectedBorderColor||n.config.node.selected.borderColor,t.shadowColor=i.shadowColor||n.config.node.selected.shadowColor,t.textPosition=i.textPosition||n.config.node.label.textPosition,t.tagColor=i.tagColor||n.config.node.tagColor,i.image)&&t.setImage(i.image,function(){n.refreshView()})}),n.refreshView())},I.prototype.reConfigLinkCluster=function(e){var n,i;e&&"object"==Ft(e)&&(h(this.validChar,"_",0,1,this.licenseKey),(n=this).config.linkClusters=e,i=null,n.links.forEach(function(t){(i=e[t.type])&&(t.strokeColor=i.color||n.config.link.color,t.lineWidth=i.lineWidth||n.config.link.lineWidth,t.lineType=i.lineType||n.config.link.lineType,t.lineDash=i.lineDash||n.config.link.lineDash,t.selectedColor=i.selectedColor||n.config.link.selected.color,t.font=i.font||n.config.link.label.font,t.fontColor=i.fontColor||n.config.link.label.color,t.showArrow=i.showArrow||n.config.link.showArrow,t.labelBackGround=i.labelBackGround||n.config.link.label.background)}),n.refreshView())},I.prototype.definedNodePaintFunc=function(t){"function"==typeof t&&(h(this.validChar,"_",0,1,this.licenseKey),this.defindPaintFuncCache.nodePaintFunc=t)},I.prototype.definedNodeInBoundFunc=function(t){"function"==typeof t&&(this.defindPaintFuncCache.nodeInBoundFunc=t)},I.prototype.definedLinkPaintFunc=function(t){"function"==typeof t&&(h(this.validChar,"_",0,1,this.licenseKey),this.defindPaintFuncCache.linePaintFunc=t)},I.prototype.definedLinkInBoundFunc=function(t){"function"==typeof t&&(this.defindPaintFuncCache.linkInBoundFunc=t)},I.prototype.registIconFonts=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:200,r=2<arguments.length?arguments[2]:void 0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"#fff",s=this,a=Math.round(i/2);t.forEach(function(t){var e=document.createElement("canvas"),n=e.getContext("2d");e.width=e.height=i,n.textBaseline="middle",n.textAlign="center",n.font="normal ".concat(i,"px ").concat(r),n.fillStyle=t.color||o,n.fillText(t.content,a,a),s.iconImageCache[t.name]=b(b({},t),{},{size:i,image:e})})},I.prototype.mergeNodes=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length?arguments[1]:void 0;if(Array.isArray(t)&&t.length<2)return null;var n=this,i=v(10),r=new Map,o=new Set;t.forEach(function(t){r.set(t.id,t),(t.outLinks||[]).forEach(function(t){return o.add(t)}),(t.inLinks||[]).forEach(function(t){return o.add(t)}),t.visible=!1});for(var s,a,h,c,u=[],l=Array.from(o),d=null,f={},p=0;p<l.length;p++)s=(d=l[p]).source.id,a=d.target.id,d.visible=!1,h="".concat(s,"-").concat(i),c="".concat(i,"-").concat(a),f[h]||f[c]||(null!=r.get(s)?null==r.get(a)&&(f[c]=!0,f["".concat(a,"-").concat(i)]=!0,u.push({id:"virtul-s-"+v(12),source:i,target:a,lineWidth:4,lineDash:[5,8,5],showArrow:!1})):(f[h]=!0,f["".concat(i,"-").concat(s)]=!0,u.push({id:"virtul-t-"+v(12),source:s,target:i,lineWidth:4,lineDash:[5,8,5],showArrow:!1})));var g=this.getNodesCoodinateCenter(t),e=this.addNode({id:i,label:e,image:"data:image/svg+xml;base64,".concat(btoa('<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2322" width="128" height="128" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M736 256m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="#4A8BFE" p-id="2323"></path><path d="M800 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="#3BD5B3" p-id="2324"></path><path d="M528 592m-112 0a112 112 0 1 0 224 0 112 112 0 1 0-224 0Z" fill="#4A8BFE" p-id="2325"></path><path d="M704 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="#3BD5B3" p-id="2326"></path><path d="M864 704m-32 0a32 32 0 1 0 64 0 32 32 0 1 0-64 0Z" fill="#4A8BFE" p-id="2327"></path><path d="M272 784m-80 0a80 80 0 1 0 160 0 80 80 0 1 0-160 0Z" fill="#4A8BFE" p-id="2328"></path><path d="M192 544m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="#3BD5B3" p-id="2329"></path><path d="M368 368m-80 0a80 80 0 1 0 160 0 80 80 0 1 0-160 0Z" fill="#3BD5B3" p-id="2330"></path><path d="M208 240m-48 0a48 48 0 1 0 96 0 48 48 0 1 0-96 0Z" fill="#3BD5B3" p-id="2331"></path><path d="M528 176m-48 0a48 48 0 1 0 96 0 48 48 0 1 0-96 0Z" fill="#4A8BFE" p-id="2332"></path><path d="M496 816m-48 0a48 48 0 1 0 96 0 48 48 0 1 0-96 0Z" fill="#3BD5B3" p-id="2333"></path><path d="M592 368m-48 0a48 48 0 1 0 96 0 48 48 0 1 0-96 0Z" fill="#3BD5B3" p-id="2334"></path></svg>')),shape:"circle",scale:2,color:"250,250,250",borderWidth:2,font:"normal 12px YaHei",textPosition:"Bottom_Center",type:"mergeNode"}),y=(e.cx=g[0],e.cy=g[1],e.orginCoodinate=g,e.containNodes=t,e.containLinks=l,-1);return t.forEach(function(t){-1!=(y=n.nodes.indexOf(t))&&n.nodes.splice(y,1)}),l.forEach(function(t){-1!=(y=n.links.indexOf(t))&&n.links.splice(y,1)}),this.addEdges(u),e},I.prototype.expandNode=function(t){var e,n,i;"mergeNode"==t.type&&(e=t.orginCoodinate,n=[t.cx-e[0],t.cy-e[1]],i=this,t.containNodes.forEach(function(t){t.cx=t.cx+n[0],t.cy=t.cy+n[1],t.visible=!0,i.nodes.push(t)}),t.containLinks.forEach(function(t){t.visible=!0,i.links.push(t)}),this.deleteNode(t))},I.prototype.getNodesCoodinateCenter=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=0,n=0;return t.forEach(function(t){e+=t.cx,n+=t.cy}),e/=t.length,n/=t.length,[Math.round(e),Math.round(n)]},I.prototype.getConnectLinkOfNodes=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=new Map,n=new Set;t.forEach(function(t){e.set(t.id,t),(t.outLinks||[]).forEach(function(t){return n.add(t)}),(t.inLinks||[]).forEach(function(t){return n.add(t)})});var i,r,o=[];return Array.from(n).forEach(function(t){i=t.source.id,r=t.target.id,null!=e.get(i)&&null!=e.get(r)&&o.push(t)}),o},I.prototype.undoAction=function(){this.undoManager.undo(this)},I.prototype.getViewSize=function(){return{width:this.stage.width,height:this.stage.height}},I.prototype.setBackGroundColor=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"#fff";t&&(h(this.validChar,"_",0,1,this.licenseKey),this.stage.setBackGroundColor(t))},I.prototype.setBackGroundImage=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;t&&(h(this.validChar,"_",0,1,this.licenseKey),this.stage.setBackGroundImage(t,e))},I.prototype.newOrgChart=function(){return new T(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length?arguments[1]:void 0)},I.prototype.newXmindChart=function(){return new P(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length?arguments[1]:void 0)},I.prototype.newSankeyChart=function(){return new oc(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length?arguments[1]:void 0)},I.prototype.newRadialTree=function(){return new A(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length?arguments[1]:void 0)},I.prototype.newCompactTree=function(){return new sc(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length?arguments[1]:void 0)},I.prototype.newIndentTree=function(){return new hc(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length?arguments[1]:void 0)},I.prototype.newPackChart=function(){return new ac(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length?arguments[1]:void 0)},I.prototype.newArcLineChart=function(){return new uc(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length?arguments[1]:void 0)},I.prototype.newFlowChart=function(){return new lc(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length?arguments[1]:void 0)},I.prototype.d3CustomTools=function(){return E},I.prototype.getDarge=function(){return m},I.prototype.getHierachyLayout=function(){return _a()},CanvasRenderingContext2D.prototype.DGraphRoundRect=function(t,e,n,i,r){this.roundRect?(this.beginPath(),this.roundRect(t,e,n,i,r<0?0:r)):r?(i<2*(r=n<2*r?n/2:r)&&(r=i/2),this.beginPath(),this.moveTo(t+r,e),this.arcTo(t+n,e,t+n,e+i,r),this.arcTo(t+n,e+i,t,e+i,r),this.arcTo(t,e+i,t,e,r),this.arcTo(t,e,t+n,e,r),this.closePath()):(this.beginPath(),this.rect(t,e,n,i))},CanvasRenderingContext2D.prototype.drawArrowLine=function(t,e,n,i,r){(r=void 0===r?3:r)<3&&(r=3);function o(t,e,n,i){var r=n*Math.cos(i),n=n*Math.sin(i);return{x:r+=t,y:n+=e}}var s=Math.sqrt((i-e)*(i-e)+(n-t)*(n-t)),a=Math.asin(Math.abs(i-e)/s),s=(n<t&&e<i?a=Math.PI-a:n<t&&i<e?a+=Math.PI:t<n&&i<e&&(a=2*Math.PI-a),o(t,e,s-2*r,a)),h=s.x,s=s.y,c=o(h,s,r,a-.5*Math.PI),u=o(h,s,2*r,a-.5*Math.PI),l=o(h,s,r,a+.5*Math.PI),h=o(h,s,2*r,a+.5*Math.PI);this.moveTo(t,e),this.lineTo(c.x,c.y),this.lineTo(u.x,u.y),this.lineTo(n,i),this.lineTo(h.x,h.y),this.lineTo(l.x,l.y),this.closePath()},CanvasRenderingContext2D.prototype.paintCustomArrow=function(t,e,n,i,r){var n=n-t,i=i-e,o=Math.sqrt(n*n+i*i),s=i/o,a=n/o,h=[];h.push(0,0);for(var c=0;c<r.length;c+=2){var u=r[c],l=r[c+1];h.push(u<0?o+u:u,l)}for(h.push(o,0),c=r.length;0<c;c-=2)u=r[c-2],l=r[c-1],h.push(u<0?o+u:u,-l);for(h.push(0,0),c=0;c<h.length;c+=2)u=h[c]*a-h[c+1]*s+t,l=h[c]*s+h[c+1]*a+e,0===c?this.moveTo(u,l):this.lineTo(u,l)},CanvasRenderingContext2D.prototype.drawArrowTail=function(t,e,n,i,r){var o=e-r*Math.cos(i),s=n-r*Math.sin(i),a=e+.8*r*Math.cos(i),h=n+.8*r*Math.sin(i),c=o+r/1.2*Math.cos(i+.3*Math.PI),u=s+r/1.2*Math.sin(i+.3*Math.PI),o=o+r/1.2*Math.cos(i-.3*Math.PI),s=s+r/1.2*Math.sin(i-.3*Math.PI);t.beginPath(),t.moveTo(e,n),t.lineTo(c,u),t.lineTo(a,h),t.lineTo(o,s),t.closePath()},requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(t){setTimeout(t,1e3/60)},cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||function(t){clearTimeout(t)},I});
